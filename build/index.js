(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(t=n.currentScript.src),!t)){var o=n.getElementsByTagName("script");if(o.length)for(var i=o.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=o[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=window.wp.i18n,n=window.wp.components,o=window.wp.element,i=window.wp.primitives,s=window.ReactJSXRuntime,r=(0,s.jsx)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,s.jsx)(i.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})}),l=(0,s.jsx)(i.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)(i.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M6.332 5.748c-1.03-.426-2.06.607-1.632 1.636l1.702 3.93 7.481.575c.123.01.123.19 0 .2l-7.483.575-1.7 3.909c-.429 1.029.602 2.062 1.632 1.636l12.265-5.076c1.03-.426 1.03-1.884 0-2.31L6.332 5.748Z"})}),a=e.p+"images/ai-bubble.790b588f.png";class u{}function c(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){const e=t[n];return null!=e?String(e):""}throw new Error(`Key '${n}' not found in valueMap.`)})}function p(e,t,n){for(let o=0;o<t.length-1;o++){const i=t[o];if(i.endsWith("[]")){const s=i.slice(0,-2);if(!(s in e)){if(!Array.isArray(n))throw new Error(`Value must be a list given an array path ${i}`);e[s]=Array.from({length:n.length},()=>({}))}if(Array.isArray(e[s])){const i=e[s];if(Array.isArray(n))for(let e=0;e<i.length;e++)p(i[e],t.slice(o+1),n[e]);else for(const e of i)p(e,t.slice(o+1),n)}return}if(i.endsWith("[0]")){const s=i.slice(0,-3);return s in e||(e[s]=[{}]),void p(e[s][0],t.slice(o+1),n)}e[i]&&"object"==typeof e[i]||(e[i]={}),e=e[i]}const o=t[t.length-1],i=e[o];if(void 0!==i){if(!n||"object"==typeof n&&0===Object.keys(n).length)return;if(n===i)return;if("object"!=typeof i||"object"!=typeof n||null===i||null===n)throw new Error(`Cannot set value for an existing key. Key: ${o}`);Object.assign(i,n)}else e[o]=n}function d(e,t){try{if(1===t.length&&"_self"===t[0])return e;for(let n=0;n<t.length;n++){if("object"!=typeof e||null===e)return;const o=t[n];if(o.endsWith("[]")){const i=o.slice(0,-2);if(i in e){const o=e[i];if(!Array.isArray(o))return;return o.map(e=>d(e,t.slice(n+1)))}return}e=e[o]}return e}catch(e){if(e instanceof TypeError)return;throw e}}var f,h,g,m,y,v,C,T,E,A,_,b,S,I,O,w,x,k,R,P,N,M,D,U,q,L,G,j,F,B,V,J,H,$,z,Y,W,K,Z,X,Q,ee,te;!function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"}(f||(f={})),function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"}(h||(h={})),function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"}(g||(g={})),function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"}(m||(m={})),function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"}(y||(y={})),function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"}(v||(v={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(C||(C={})),function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"}(T||(T={})),function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"}(E||(E={})),function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"}(A||(A={})),function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"}(_||(_={})),function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"}(b||(b={})),function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"}(S||(S={})),function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"}(I||(I={})),function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY"}(O||(O={})),function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"}(w||(w={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"}(x||(x={})),function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"}(k||(k={})),function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"}(R||(R={})),function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"}(P||(P={})),function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"}(N||(N={})),function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"}(M||(M={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(D||(D={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"}(U||(U={})),function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"}(q||(q={})),function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"}(L||(L={})),function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"}(G||(G={})),function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"}(j||(j={})),function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"}(F||(F={})),function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"}(B||(B={})),function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"}(V||(V={})),function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"}(J||(J={})),function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"}(H||(H={})),function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"}($||($={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"}(z||(z={})),function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"}(Y||(Y={})),function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"}(W||(W={})),function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"}(K||(K={})),function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"}(Z||(Z={})),function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"}(X||(X={})),function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"}(Q||(Q={})),function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"}(ee||(ee={}));class ne{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class oe{get text(){var e,t,n,o,i,s,r,l;if(0===(null===(o=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let a="",u=!1;const c=[];for(const e of null!==(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)&&void 0!==l?l:[]){for(const[t,n]of Object.entries(e))"text"===t||"thought"===t||null===n&&void 0===n||c.push(t);if("string"==typeof e.text){if("boolean"==typeof e.thought&&e.thought)continue;u=!0,a+=e.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?a:void 0}get data(){var e,t,n,o,i,s,r,l;if(0===(null===(o=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let a="";const u=[];for(const e of null!==(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)&&void 0!==l?l:[]){for(const[t,n]of Object.entries(e))"inlineData"===t||null===n&&void 0===n||u.push(t);e.inlineData&&"string"==typeof e.inlineData.data&&(a+=atob(e.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}get functionCalls(){var e,t,n,o,i,s,r,l;if(0===(null===(o=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const a=null===(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)||void 0===l?void 0:l.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);return 0!==(null==a?void 0:a.length)?a:void 0}get executableCode(){var e,t,n,o,i,s,r,l,a;if(0===(null===(o=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const u=null===(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)||void 0===l?void 0:l.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);return 0!==(null==u?void 0:u.length)?null===(a=null==u?void 0:u[0])||void 0===a?void 0:a.code:void 0}get codeExecutionResult(){var e,t,n,o,i,s,r,l,a;if(0===(null===(o=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const u=null===(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)||void 0===l?void 0:l.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);return 0!==(null==u?void 0:u.length)?null===(a=null==u?void 0:u[0])||void 0===a?void 0:a.output:void 0}}class ie{}class se{}class re{}class le{}class ae{}class ue{}class ce{}class pe{}class de{}class fe{}class he{}class ge{}class me{}class ye{}class ve{}class Ce{get text(){var e,t,n;let o="",i=!1;const s=[];for(const r of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(r))"text"!==e&&"thought"!==e&&null!==t&&s.push(e);if("string"==typeof r.text){if("boolean"==typeof r.thought&&r.thought)continue;i=!0,o+=r.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?o:void 0}get data(){var e,t,n;let o="";const i=[];for(const s of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(s))"inlineData"!==e&&null!==t&&i.push(e);s.inlineData&&"string"==typeof s.inlineData.data&&(o+=atob(s.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class Te{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}function Ee(e,t){if(!t||"string"!=typeof t)throw new Error("model is required and must be a string");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}return`publishers/google/models/${t}`}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function Ae(e,t){const n=Ee(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function _e(e){return Array.isArray(e)?e.map(e=>be(e)):[be(e)]}function be(e){if("object"==typeof e&&null!==e)return e;throw new Error("Could not parse input as Blob. Unsupported blob type: "+typeof e)}function Se(e){const t=be(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Ie(e){const t=be(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Oe(e){if(null==e)throw new Error("PartUnion is required");if("object"==typeof e)return e;if("string"==typeof e)return{text:e};throw new Error("Unsupported part type: "+typeof e)}function we(e){if(null==e||Array.isArray(e)&&0===e.length)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>Oe(e)):[Oe(e)]}function xe(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function ke(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function Re(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function Pe(e){if(null==e)throw new Error("ContentUnion is required");return xe(e)?e:{role:"user",parts:we(e)}}function Ne(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const t=Pe(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){const e=Pe(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>Pe(e)):[Pe(t)]}function Me(e){if(null==e||Array.isArray(e)&&0===e.length)throw new Error("contents are required");if(!Array.isArray(e)){if(ke(e)||Re(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Pe(e)]}const t=[],n=[],o=xe(e[0]);for(const i of e){const e=xe(i);if(e!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(i);else{if(ke(i)||Re(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return o||t.push({role:"user",parts:we(n)}),t}function De(e){const t={},n=["items"],o=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;null!=s&&2==s.length&&("null"===s[0].type?(t.nullable=!0,e=s[1]):"null"===s[1].type&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(e=>"null"!==e);if(1===n.length)t.type=Object.values(g).includes(n[0].toUpperCase())?n[0].toUpperCase():g.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const e of n)t.anyOf.push({type:Object.values(g).includes(e.toUpperCase())?e.toUpperCase():g.TYPE_UNSPECIFIED})}}(e.type,t);for(const[s,r]of Object.entries(e))if(null!=r)if("type"==s){if("null"===r)throw new Error("type: null can not be the only possible type for the field.");if(r instanceof Array)continue;t.type=Object.values(g).includes(r.toUpperCase())?r.toUpperCase():g.TYPE_UNSPECIFIED}else if(n.includes(s))t[s]=De(r);else if(o.includes(s)){const e=[];for(const n of r)"null"!=n.type?e.push(De(n)):t.nullable=!0;t[s]=e}else if(i.includes(s)){const e={};for(const[t,n]of Object.entries(r))e[t]=De(n);t[s]=e}else{if("additionalProperties"===s)continue;t[s]=r}return t}function Ue(e){return De(e)}function qe(e){if("object"==typeof e)return e;if("string"==typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error("Unsupported speechConfig type: "+typeof e)}function Le(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function Ge(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=De(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=De(t.response));return e}function je(e){if(null==e)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function Fe(e,t){if("string"!=typeof t)throw new Error("name must be a string");return function(e,t,n,o=1){const i=!t.startsWith(`${n}/`)&&t.split("/").length===o;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:i?`${n}/${t}`:t}(e,t,"cachedContents")}function Be(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Ve(e){if("string"!=typeof e)throw new Error("fromImageBytes must be a string");return e}function Je(e){var t;let n;var o;if(null!=(o=e)&&"object"==typeof o&&"name"in o&&(n=e.name),!(function(e){return null!=e&&"object"==typeof e&&"uri"in e}(e)&&(n=e.uri,void 0===n)||function(e){return null!=e&&"object"==typeof e&&"video"in e}(e)&&(n=null===(t=e.video)||void 0===t?void 0:t.uri,void 0===n))){if("string"==typeof e&&(n=e),void 0===n)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const e=n.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw new Error(`Could not extract file name from URI ${n}`);n=e[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function He(e,t){let n;return n=e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels",n}function $e(e){for(const t of["models","tunedModels","publisherModels"])if(ze(e,t))return e[t];return[]}function ze(e,t){return null!==e&&"object"==typeof e&&t in e}function Ye(e,t={}){const n=e,o={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return t.behavior&&(o.behavior=t.behavior),{functionDeclarations:[o]}}function We(e,t){if("string"!=typeof t&&!Array.isArray(t)){if(e&&e.isVertexAI()){if(t.gcsUri&&t.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!t.gcsUri&&!t.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(t.inlinedRequests&&t.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!t.inlinedRequests&&!t.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return t}if(Array.isArray(t))return{inlinedRequests:t};if("string"==typeof t){if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:[t]};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};if(t.startsWith("files/"))return{fileName:t}}throw new Error(`Unsupported source: ${t}`)}function Ke(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function Ze(e){return"BATCH_STATE_UNSPECIFIED"===e?"JOB_STATE_UNSPECIFIED":"BATCH_STATE_PENDING"===e?"JOB_STATE_PENDING":"BATCH_STATE_SUCCEEDED"===e?"JOB_STATE_SUCCEEDED":"BATCH_STATE_FAILED"===e?"JOB_STATE_FAILED":"BATCH_STATE_CANCELLED"===e?"JOB_STATE_CANCELLED":e}function Xe(e){const t={},n=d(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["videoMetadata"]);null!=n&&p(t,["videoMetadata"],function(e){const t={},n=d(e,["fps"]);null!=n&&p(t,["fps"],n);const o=d(e,["endOffset"]);null!=o&&p(t,["endOffset"],o);const i=d(e,["startOffset"]);return null!=i&&p(t,["startOffset"],i),t}(n));const o=d(e,["thought"]);null!=o&&p(t,["thought"],o);const i=d(e,["inlineData"]);null!=i&&p(t,["inlineData"],function(e){const t={};if(void 0!==d(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["data"]);null!=n&&p(t,["data"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(i));const s=d(e,["fileData"]);null!=s&&p(t,["fileData"],function(e){const t={};if(void 0!==d(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["fileUri"]);null!=n&&p(t,["fileUri"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(s));const r=d(e,["thoughtSignature"]);null!=r&&p(t,["thoughtSignature"],r);const l=d(e,["codeExecutionResult"]);null!=l&&p(t,["codeExecutionResult"],l);const a=d(e,["executableCode"]);null!=a&&p(t,["executableCode"],a);const u=d(e,["functionCall"]);null!=u&&p(t,["functionCall"],u);const c=d(e,["functionResponse"]);null!=c&&p(t,["functionResponse"],c);const f=d(e,["text"]);return null!=f&&p(t,["text"],f),t}(e))),p(t,["parts"],e)}const o=d(e,["role"]);return null!=o&&p(t,["role"],o),t}function Qe(e){const t={},n=d(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["behavior"]);null!=n&&p(t,["behavior"],n);const o=d(e,["description"]);null!=o&&p(t,["description"],o);const i=d(e,["name"]);null!=i&&p(t,["name"],i);const s=d(e,["parameters"]);null!=s&&p(t,["parameters"],s);const r=d(e,["parametersJsonSchema"]);null!=r&&p(t,["parametersJsonSchema"],r);const l=d(e,["response"]);null!=l&&p(t,["response"],l);const a=d(e,["responseJsonSchema"]);return null!=a&&p(t,["responseJsonSchema"],a),t}(e))),p(t,["functionDeclarations"],e)}if(void 0!==d(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=d(e,["googleSearch"]);null!=o&&p(t,["googleSearch"],function(e){const t={},n=d(e,["timeRangeFilter"]);return null!=n&&p(t,["timeRangeFilter"],function(e){const t={},n=d(e,["startTime"]);null!=n&&p(t,["startTime"],n);const o=d(e,["endTime"]);return null!=o&&p(t,["endTime"],o),t}(n)),t}(o));const i=d(e,["googleSearchRetrieval"]);if(null!=i&&p(t,["googleSearchRetrieval"],function(e){const t={},n=d(e,["dynamicRetrievalConfig"]);return null!=n&&p(t,["dynamicRetrievalConfig"],function(e){const t={},n=d(e,["mode"]);null!=n&&p(t,["mode"],n);const o=d(e,["dynamicThreshold"]);return null!=o&&p(t,["dynamicThreshold"],o),t}(n)),t}(i)),void 0!==d(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==d(e,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=d(e,["urlContext"])&&p(t,["urlContext"],{});const s=d(e,["codeExecution"]);null!=s&&p(t,["codeExecution"],s);const r=d(e,["computerUse"]);return null!=r&&p(t,["computerUse"],r),t}function et(e){const t={},n=d(e,["functionCallingConfig"]);null!=n&&p(t,["functionCallingConfig"],function(e){const t={},n=d(e,["mode"]);null!=n&&p(t,["mode"],n);const o=d(e,["allowedFunctionNames"]);return null!=o&&p(t,["allowedFunctionNames"],o),t}(n));const o=d(e,["retrievalConfig"]);return null!=o&&p(t,["retrievalConfig"],function(e){const t={},n=d(e,["latLng"]);null!=n&&p(t,["latLng"],function(e){const t={},n=d(e,["latitude"]);null!=n&&p(t,["latitude"],n);const o=d(e,["longitude"]);return null!=o&&p(t,["longitude"],o),t}(n));const o=d(e,["languageCode"]);return null!=o&&p(t,["languageCode"],o),t}(o)),t}function tt(e){const t={},n=d(e,["prebuiltVoiceConfig"]);return null!=n&&p(t,["prebuiltVoiceConfig"],function(e){const t={},n=d(e,["voiceName"]);return null!=n&&p(t,["voiceName"],n),t}(n)),t}function nt(e,t,n){const o={},i=d(t,["systemInstruction"]);void 0!==n&&null!=i&&p(n,["systemInstruction"],Xe(Pe(i)));const s=d(t,["temperature"]);null!=s&&p(o,["temperature"],s);const r=d(t,["topP"]);null!=r&&p(o,["topP"],r);const l=d(t,["topK"]);null!=l&&p(o,["topK"],l);const a=d(t,["candidateCount"]);null!=a&&p(o,["candidateCount"],a);const u=d(t,["maxOutputTokens"]);null!=u&&p(o,["maxOutputTokens"],u);const c=d(t,["stopSequences"]);null!=c&&p(o,["stopSequences"],c);const f=d(t,["responseLogprobs"]);null!=f&&p(o,["responseLogprobs"],f);const h=d(t,["logprobs"]);null!=h&&p(o,["logprobs"],h);const g=d(t,["presencePenalty"]);null!=g&&p(o,["presencePenalty"],g);const m=d(t,["frequencyPenalty"]);null!=m&&p(o,["frequencyPenalty"],m);const y=d(t,["seed"]);null!=y&&p(o,["seed"],y);const v=d(t,["responseMimeType"]);null!=v&&p(o,["responseMimeType"],v);const C=d(t,["responseSchema"]);null!=C&&p(o,["responseSchema"],function(e){const t={},n=d(e,["anyOf"]);null!=n&&p(t,["anyOf"],n);const o=d(e,["default"]);null!=o&&p(t,["default"],o);const i=d(e,["description"]);null!=i&&p(t,["description"],i);const s=d(e,["enum"]);null!=s&&p(t,["enum"],s);const r=d(e,["example"]);null!=r&&p(t,["example"],r);const l=d(e,["format"]);null!=l&&p(t,["format"],l);const a=d(e,["items"]);null!=a&&p(t,["items"],a);const u=d(e,["maxItems"]);null!=u&&p(t,["maxItems"],u);const c=d(e,["maxLength"]);null!=c&&p(t,["maxLength"],c);const f=d(e,["maxProperties"]);null!=f&&p(t,["maxProperties"],f);const h=d(e,["maximum"]);null!=h&&p(t,["maximum"],h);const g=d(e,["minItems"]);null!=g&&p(t,["minItems"],g);const m=d(e,["minLength"]);null!=m&&p(t,["minLength"],m);const y=d(e,["minProperties"]);null!=y&&p(t,["minProperties"],y);const v=d(e,["minimum"]);null!=v&&p(t,["minimum"],v);const C=d(e,["nullable"]);null!=C&&p(t,["nullable"],C);const T=d(e,["pattern"]);null!=T&&p(t,["pattern"],T);const E=d(e,["properties"]);null!=E&&p(t,["properties"],E);const A=d(e,["propertyOrdering"]);null!=A&&p(t,["propertyOrdering"],A);const _=d(e,["required"]);null!=_&&p(t,["required"],_);const b=d(e,["title"]);null!=b&&p(t,["title"],b);const S=d(e,["type"]);return null!=S&&p(t,["type"],S),t}(Ue(C)));const T=d(t,["responseJsonSchema"]);if(null!=T&&p(o,["responseJsonSchema"],T),void 0!==d(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==d(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const E=d(t,["safetySettings"]);if(void 0!==n&&null!=E){let e=E;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==d(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const n=d(e,["category"]);null!=n&&p(t,["category"],n);const o=d(e,["threshold"]);return null!=o&&p(t,["threshold"],o),t}(e))),p(n,["safetySettings"],e)}const A=d(t,["tools"]);if(void 0!==n&&null!=A){let e=je(A);Array.isArray(e)&&(e=e.map(e=>Qe(Ge(e)))),p(n,["tools"],e)}const _=d(t,["toolConfig"]);if(void 0!==n&&null!=_&&p(n,["toolConfig"],et(_)),void 0!==d(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const b=d(t,["cachedContent"]);void 0!==n&&null!=b&&p(n,["cachedContent"],Fe(e,b));const S=d(t,["responseModalities"]);null!=S&&p(o,["responseModalities"],S);const I=d(t,["mediaResolution"]);null!=I&&p(o,["mediaResolution"],I);const O=d(t,["speechConfig"]);if(null!=O&&p(o,["speechConfig"],function(e){const t={},n=d(e,["voiceConfig"]);null!=n&&p(t,["voiceConfig"],tt(n));const o=d(e,["multiSpeakerVoiceConfig"]);null!=o&&p(t,["multiSpeakerVoiceConfig"],function(e){const t={},n=d(e,["speakerVoiceConfigs"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["speaker"]);null!=n&&p(t,["speaker"],n);const o=d(e,["voiceConfig"]);return null!=o&&p(t,["voiceConfig"],tt(o)),t}(e))),p(t,["speakerVoiceConfigs"],e)}return t}(o));const i=d(e,["languageCode"]);return null!=i&&p(t,["languageCode"],i),t}(qe(O))),void 0!==d(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const w=d(t,["thinkingConfig"]);return null!=w&&p(o,["thinkingConfig"],function(e){const t={},n=d(e,["includeThoughts"]);null!=n&&p(t,["includeThoughts"],n);const o=d(e,["thinkingBudget"]);return null!=o&&p(t,["thinkingBudget"],o),t}(w)),o}function ot(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["src"]);null!=i&&p(n,["batch","inputConfig"],function(e,t){const n={};if(void 0!==d(t,["format"]))throw new Error("format parameter is not supported in Gemini API.");if(void 0!==d(t,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==d(t,["bigqueryUri"]))throw new Error("bigqueryUri parameter is not supported in Gemini API.");const o=d(t,["fileName"]);null!=o&&p(n,["fileName"],o);const i=d(t,["inlinedRequests"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["request","model"],Ee(e,o));const i=d(t,["contents"]);if(null!=i){let e=Me(i);Array.isArray(e)&&(e=e.map(e=>Xe(e))),p(n,["request","contents"],e)}const s=d(t,["config"]);return null!=s&&p(n,["request","generationConfig"],nt(e,s,n)),n}(e,t))),p(n,["requests","requests"],t)}return n}(e,We(e,i)));const s=d(t,["config"]);return null!=s&&p(n,["config"],function(e,t){const n=d(e,["displayName"]);if(void 0!==t&&null!=n&&p(t,["batch","displayName"],n),void 0!==d(e,["dest"]))throw new Error("dest parameter is not supported in Gemini API.");return{}}(s,n)),n}function it(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["model"],Ee(e,o));const i=d(t,["src"]);null!=i&&p(n,["inputConfig"],function(e){const t={},n=d(e,["format"]);null!=n&&p(t,["instancesFormat"],n);const o=d(e,["gcsUri"]);null!=o&&p(t,["gcsSource","uris"],o);const i=d(e,["bigqueryUri"]);if(null!=i&&p(t,["bigquerySource","inputUri"],i),void 0!==d(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==d(e,["inlinedRequests"]))throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(We(e,i)));const s=d(t,["config"]);return null!=s&&p(n,["config"],function(e,t){const n=d(e,["displayName"]);void 0!==t&&null!=n&&p(t,["displayName"],n);const o=d(e,["dest"]);return void 0!==t&&null!=o&&p(t,["outputConfig"],function(e){const t={},n=d(e,["format"]);null!=n&&p(t,["predictionsFormat"],n);const o=d(e,["gcsUri"]);null!=o&&p(t,["gcsDestination","outputUriPrefix"],o);const i=d(e,["bigqueryUri"]);if(null!=i&&p(t,["bigqueryDestination","outputUri"],i),void 0!==d(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==d(e,["inlinedResponses"]))throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return t}(function(e){const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}(o))),{}}(s,n)),n}function st(e){const t={},n=d(e,["content"]);null!=n&&p(t,["content"],function(e){const t={},n=d(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["videoMetadata"]);null!=n&&p(t,["videoMetadata"],function(e){const t={},n=d(e,["fps"]);null!=n&&p(t,["fps"],n);const o=d(e,["endOffset"]);null!=o&&p(t,["endOffset"],o);const i=d(e,["startOffset"]);return null!=i&&p(t,["startOffset"],i),t}(n));const o=d(e,["thought"]);null!=o&&p(t,["thought"],o);const i=d(e,["inlineData"]);null!=i&&p(t,["inlineData"],function(e){const t={},n=d(e,["data"]);null!=n&&p(t,["data"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(i));const s=d(e,["fileData"]);null!=s&&p(t,["fileData"],function(e){const t={},n=d(e,["fileUri"]);null!=n&&p(t,["fileUri"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(s));const r=d(e,["thoughtSignature"]);null!=r&&p(t,["thoughtSignature"],r);const l=d(e,["codeExecutionResult"]);null!=l&&p(t,["codeExecutionResult"],l);const a=d(e,["executableCode"]);null!=a&&p(t,["executableCode"],a);const u=d(e,["functionCall"]);null!=u&&p(t,["functionCall"],u);const c=d(e,["functionResponse"]);null!=c&&p(t,["functionResponse"],c);const f=d(e,["text"]);return null!=f&&p(t,["text"],f),t}(e))),p(t,["parts"],e)}const o=d(e,["role"]);return null!=o&&p(t,["role"],o),t}(n));const o=d(e,["citationMetadata"]);null!=o&&p(t,["citationMetadata"],function(e){const t={},n=d(e,["citationSources"]);return null!=n&&p(t,["citations"],n),t}(o));const i=d(e,["tokenCount"]);null!=i&&p(t,["tokenCount"],i);const s=d(e,["finishReason"]);null!=s&&p(t,["finishReason"],s);const r=d(e,["urlContextMetadata"]);null!=r&&p(t,["urlContextMetadata"],function(e){const t={},n=d(e,["urlMetadata"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["retrievedUrl"]);null!=n&&p(t,["retrievedUrl"],n);const o=d(e,["urlRetrievalStatus"]);return null!=o&&p(t,["urlRetrievalStatus"],o),t}(e))),p(t,["urlMetadata"],e)}return t}(r));const l=d(e,["avgLogprobs"]);null!=l&&p(t,["avgLogprobs"],l);const a=d(e,["groundingMetadata"]);null!=a&&p(t,["groundingMetadata"],a);const u=d(e,["index"]);null!=u&&p(t,["index"],u);const c=d(e,["logprobsResult"]);null!=c&&p(t,["logprobsResult"],c);const f=d(e,["safetyRatings"]);return null!=f&&p(t,["safetyRatings"],f),t}function rt(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["metadata","displayName"]);null!=o&&p(t,["displayName"],o);const i=d(e,["metadata","state"]);null!=i&&p(t,["state"],Ze(i));const s=d(e,["metadata","createTime"]);null!=s&&p(t,["createTime"],s);const r=d(e,["metadata","endTime"]);null!=r&&p(t,["endTime"],r);const l=d(e,["metadata","updateTime"]);null!=l&&p(t,["updateTime"],l);const a=d(e,["metadata","model"]);null!=a&&p(t,["model"],a);const u=d(e,["metadata","output"]);return null!=u&&p(t,["dest"],function(e){const t={},n=d(e,["responsesFile"]);null!=n&&p(t,["fileName"],n);const o=d(e,["inlinedResponses","inlinedResponses"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["response"]);return null!=n&&p(t,["response"],function(e){const t={},n=d(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>st(e))),p(t,["candidates"],e)}const o=d(e,["modelVersion"]);null!=o&&p(t,["modelVersion"],o);const i=d(e,["promptFeedback"]);null!=i&&p(t,["promptFeedback"],i);const s=d(e,["usageMetadata"]);return null!=s&&p(t,["usageMetadata"],s),t}(n)),null!=d(e,["error"])&&p(t,["error"],{}),t}(e))),p(t,["inlinedResponses"],e)}return t}(u)),t}function lt(e){const t={},n=d(e,["details"]);null!=n&&p(t,["details"],n);const o=d(e,["code"]);null!=o&&p(t,["code"],o);const i=d(e,["message"]);return null!=i&&p(t,["message"],i),t}function at(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["displayName"]);null!=o&&p(t,["displayName"],o);const i=d(e,["state"]);null!=i&&p(t,["state"],Ze(i));const s=d(e,["error"]);null!=s&&p(t,["error"],lt(s));const r=d(e,["createTime"]);null!=r&&p(t,["createTime"],r);const l=d(e,["startTime"]);null!=l&&p(t,["startTime"],l);const a=d(e,["endTime"]);null!=a&&p(t,["endTime"],a);const u=d(e,["updateTime"]);null!=u&&p(t,["updateTime"],u);const c=d(e,["model"]);null!=c&&p(t,["model"],c);const f=d(e,["inputConfig"]);null!=f&&p(t,["src"],function(e){const t={},n=d(e,["instancesFormat"]);null!=n&&p(t,["format"],n);const o=d(e,["gcsSource","uris"]);null!=o&&p(t,["gcsUri"],o);const i=d(e,["bigquerySource","inputUri"]);return null!=i&&p(t,["bigqueryUri"],i),t}(f));const h=d(e,["outputConfig"]);return null!=h&&p(t,["dest"],function(e){const t={},n=d(e,["predictionsFormat"]);null!=n&&p(t,["format"],n);const o=d(e,["gcsDestination","outputUriPrefix"]);null!=o&&p(t,["gcsUri"],o);const i=d(e,["bigqueryDestination","outputUri"]);return null!=i&&p(t,["bigqueryUri"],i),t}(h)),t}!function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"}(te||(te={}));class ut{constructor(e,t,n,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,o)}init(e,t,n){var o,i;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let s={config:{}};s=n?"object"==typeof n?Object.assign({},n):n:{config:{}},s.config&&(s.config.pageToken=t.nextPageToken),this.paramsInternal=s,this.pageInternalSize=null!==(i=null===(o=s.config)||void 0===o?void 0:o.pageSize)&&void 0!==i?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return void 0!==(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)}}class ct extends u{constructor(e){super(),this.apiClient=e,this.create=async e=>{if(this.apiClient.isVertexAI()){const t=Date.now().toString();if(Array.isArray(e.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(e.config=e.config||{},void 0===e.config.displayName&&(e.config.displayName="genaiBatchJob_${timestampStr}"),void 0===e.config.dest&&"string"==typeof e.src)if(e.src.startsWith("gs://")&&e.src.endsWith(".jsonl"))e.config.dest=`${e.src.slice(0,-6)}/dest`;else{if(!e.src.startsWith("bq://"))throw new Error("Unsupported source:"+e.src);e.config.dest=`${e.src}_dest_${t}`}}return await this.createInternal(e)},this.list=async(e={})=>new ut(te.PAGED_ITEM_BATCH_JOBS,e=>this.listInternal(e),await this.listInternal(e),e)}async createInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=it(this.apiClient,e);return r=c("batchPredictionJobs",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>at(e))}{const t=ot(this.apiClient,e);return r=c("{model}:batchGenerateContent",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>rt(e))}}async get(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["name"]);null!=o&&p(n,["_url","name"],Ke(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);return r=c("batchPredictionJobs/{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>at(e))}{const t=function(e,t){const n={},o=d(t,["name"]);null!=o&&p(n,["_url","name"],Ke(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);return r=c("batches/{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>rt(e))}}async cancel(e){var t,n,o,i;let s="",r={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["name"]);null!=o&&p(n,["_url","name"],Ke(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);s=c("batchPredictionJobs/{name}:cancel",o._url),r=o._query,delete o.config,delete o._url,delete o._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}else{const t=function(e,t){const n={},o=d(t,["name"]);null!=o&&p(n,["_url","name"],Ke(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);s=c("batches/{name}:cancel",t._url),r=t._query,delete t.config,delete t._url,delete t._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal})}}async listInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=d(e,["config"]);return null!=n&&p(t,["config"],function(e,t){const n=d(e,["pageSize"]);void 0!==t&&null!=n&&p(t,["_query","pageSize"],n);const o=d(e,["pageToken"]);void 0!==t&&null!=o&&p(t,["_query","pageToken"],o);const i=d(e,["filter"]);return void 0!==t&&null!=i&&p(t,["_query","filter"],i),{}}(n,t)),t}(e);return r=c("batchPredictionJobs",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=d(e,["nextPageToken"]);null!=n&&p(t,["nextPageToken"],n);const o=d(e,["batchPredictionJobs"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>at(e))),p(t,["batchJobs"],e)}return t}(e),n=new ve;return Object.assign(n,t),n})}{const t=function(e){const t={},n=d(e,["config"]);return null!=n&&p(t,["config"],function(e,t){const n=d(e,["pageSize"]);void 0!==t&&null!=n&&p(t,["_query","pageSize"],n);const o=d(e,["pageToken"]);if(void 0!==t&&null!=o&&p(t,["_query","pageToken"],o),void 0!==d(e,["filter"]))throw new Error("filter parameter is not supported in Gemini API.");return{}}(n,t)),t}(e);return r=c("batches",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=d(e,["nextPageToken"]);null!=n&&p(t,["nextPageToken"],n);const o=d(e,["operations"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>rt(e))),p(t,["batchJobs"],e)}return t}(e),n=new ve;return Object.assign(n,t),n})}}async delete(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["name"]);null!=o&&p(n,["_url","name"],Ke(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);return r=c("batchPredictionJobs/{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>function(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["done"]);null!=o&&p(t,["done"],o);const i=d(e,["error"]);return null!=i&&p(t,["error"],lt(i)),t}(e))}{const t=function(e,t){const n={},o=d(t,["name"]);null!=o&&p(n,["_url","name"],Ke(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);return r=c("batches/{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>function(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["done"]);return null!=o&&p(t,["done"],o),null!=d(e,["error"])&&p(t,["error"],{}),t}(e))}}}function pt(e){const t={},n=d(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["videoMetadata"]);null!=n&&p(t,["videoMetadata"],function(e){const t={},n=d(e,["fps"]);null!=n&&p(t,["fps"],n);const o=d(e,["endOffset"]);null!=o&&p(t,["endOffset"],o);const i=d(e,["startOffset"]);return null!=i&&p(t,["startOffset"],i),t}(n));const o=d(e,["thought"]);null!=o&&p(t,["thought"],o);const i=d(e,["inlineData"]);null!=i&&p(t,["inlineData"],function(e){const t={};if(void 0!==d(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["data"]);null!=n&&p(t,["data"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(i));const s=d(e,["fileData"]);null!=s&&p(t,["fileData"],function(e){const t={};if(void 0!==d(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["fileUri"]);null!=n&&p(t,["fileUri"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(s));const r=d(e,["thoughtSignature"]);null!=r&&p(t,["thoughtSignature"],r);const l=d(e,["codeExecutionResult"]);null!=l&&p(t,["codeExecutionResult"],l);const a=d(e,["executableCode"]);null!=a&&p(t,["executableCode"],a);const u=d(e,["functionCall"]);null!=u&&p(t,["functionCall"],u);const c=d(e,["functionResponse"]);null!=c&&p(t,["functionResponse"],c);const f=d(e,["text"]);return null!=f&&p(t,["text"],f),t}(e))),p(t,["parts"],e)}const o=d(e,["role"]);return null!=o&&p(t,["role"],o),t}function dt(e){const t={},n=d(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["behavior"]);null!=n&&p(t,["behavior"],n);const o=d(e,["description"]);null!=o&&p(t,["description"],o);const i=d(e,["name"]);null!=i&&p(t,["name"],i);const s=d(e,["parameters"]);null!=s&&p(t,["parameters"],s);const r=d(e,["parametersJsonSchema"]);null!=r&&p(t,["parametersJsonSchema"],r);const l=d(e,["response"]);null!=l&&p(t,["response"],l);const a=d(e,["responseJsonSchema"]);return null!=a&&p(t,["responseJsonSchema"],a),t}(e))),p(t,["functionDeclarations"],e)}if(void 0!==d(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=d(e,["googleSearch"]);null!=o&&p(t,["googleSearch"],function(e){const t={},n=d(e,["timeRangeFilter"]);return null!=n&&p(t,["timeRangeFilter"],function(e){const t={},n=d(e,["startTime"]);null!=n&&p(t,["startTime"],n);const o=d(e,["endTime"]);return null!=o&&p(t,["endTime"],o),t}(n)),t}(o));const i=d(e,["googleSearchRetrieval"]);if(null!=i&&p(t,["googleSearchRetrieval"],function(e){const t={},n=d(e,["dynamicRetrievalConfig"]);return null!=n&&p(t,["dynamicRetrievalConfig"],function(e){const t={},n=d(e,["mode"]);null!=n&&p(t,["mode"],n);const o=d(e,["dynamicThreshold"]);return null!=o&&p(t,["dynamicThreshold"],o),t}(n)),t}(i)),void 0!==d(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==d(e,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=d(e,["urlContext"])&&p(t,["urlContext"],{});const s=d(e,["codeExecution"]);null!=s&&p(t,["codeExecution"],s);const r=d(e,["computerUse"]);return null!=r&&p(t,["computerUse"],r),t}function ft(e){const t={},n=d(e,["functionCallingConfig"]);null!=n&&p(t,["functionCallingConfig"],function(e){const t={},n=d(e,["mode"]);null!=n&&p(t,["mode"],n);const o=d(e,["allowedFunctionNames"]);return null!=o&&p(t,["allowedFunctionNames"],o),t}(n));const o=d(e,["retrievalConfig"]);return null!=o&&p(t,["retrievalConfig"],function(e){const t={},n=d(e,["latLng"]);null!=n&&p(t,["latLng"],function(e){const t={},n=d(e,["latitude"]);null!=n&&p(t,["latitude"],n);const o=d(e,["longitude"]);return null!=o&&p(t,["longitude"],o),t}(n));const o=d(e,["languageCode"]);return null!=o&&p(t,["languageCode"],o),t}(o)),t}function ht(e){const t={},n=d(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["videoMetadata"]);null!=n&&p(t,["videoMetadata"],function(e){const t={},n=d(e,["fps"]);null!=n&&p(t,["fps"],n);const o=d(e,["endOffset"]);null!=o&&p(t,["endOffset"],o);const i=d(e,["startOffset"]);return null!=i&&p(t,["startOffset"],i),t}(n));const o=d(e,["thought"]);null!=o&&p(t,["thought"],o);const i=d(e,["inlineData"]);null!=i&&p(t,["inlineData"],function(e){const t={},n=d(e,["displayName"]);null!=n&&p(t,["displayName"],n);const o=d(e,["data"]);null!=o&&p(t,["data"],o);const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(i));const s=d(e,["fileData"]);null!=s&&p(t,["fileData"],function(e){const t={},n=d(e,["displayName"]);null!=n&&p(t,["displayName"],n);const o=d(e,["fileUri"]);null!=o&&p(t,["fileUri"],o);const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(s));const r=d(e,["thoughtSignature"]);null!=r&&p(t,["thoughtSignature"],r);const l=d(e,["codeExecutionResult"]);null!=l&&p(t,["codeExecutionResult"],l);const a=d(e,["executableCode"]);null!=a&&p(t,["executableCode"],a);const u=d(e,["functionCall"]);null!=u&&p(t,["functionCall"],u);const c=d(e,["functionResponse"]);null!=c&&p(t,["functionResponse"],c);const f=d(e,["text"]);return null!=f&&p(t,["text"],f),t}(e))),p(t,["parts"],e)}const o=d(e,["role"]);return null!=o&&p(t,["role"],o),t}function gt(e){const t={},n=d(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==d(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(e,["description"]);null!=n&&p(t,["description"],n);const o=d(e,["name"]);null!=o&&p(t,["name"],o);const i=d(e,["parameters"]);null!=i&&p(t,["parameters"],i);const s=d(e,["parametersJsonSchema"]);null!=s&&p(t,["parametersJsonSchema"],s);const r=d(e,["response"]);null!=r&&p(t,["response"],r);const l=d(e,["responseJsonSchema"]);return null!=l&&p(t,["responseJsonSchema"],l),t}(e))),p(t,["functionDeclarations"],e)}const o=d(e,["retrieval"]);null!=o&&p(t,["retrieval"],o);const i=d(e,["googleSearch"]);null!=i&&p(t,["googleSearch"],function(e){const t={},n=d(e,["timeRangeFilter"]);return null!=n&&p(t,["timeRangeFilter"],function(e){const t={},n=d(e,["startTime"]);null!=n&&p(t,["startTime"],n);const o=d(e,["endTime"]);return null!=o&&p(t,["endTime"],o),t}(n)),t}(i));const s=d(e,["googleSearchRetrieval"]);null!=s&&p(t,["googleSearchRetrieval"],function(e){const t={},n=d(e,["dynamicRetrievalConfig"]);return null!=n&&p(t,["dynamicRetrievalConfig"],function(e){const t={},n=d(e,["mode"]);null!=n&&p(t,["mode"],n);const o=d(e,["dynamicThreshold"]);return null!=o&&p(t,["dynamicThreshold"],o),t}(n)),t}(s)),null!=d(e,["enterpriseWebSearch"])&&p(t,["enterpriseWebSearch"],{});const r=d(e,["googleMaps"]);null!=r&&p(t,["googleMaps"],function(e){const t={},n=d(e,["authConfig"]);return null!=n&&p(t,["authConfig"],function(e){const t={},n=d(e,["apiKeyConfig"]);null!=n&&p(t,["apiKeyConfig"],function(e){const t={},n=d(e,["apiKeyString"]);return null!=n&&p(t,["apiKeyString"],n),t}(n));const o=d(e,["authType"]);null!=o&&p(t,["authType"],o);const i=d(e,["googleServiceAccountConfig"]);null!=i&&p(t,["googleServiceAccountConfig"],i);const s=d(e,["httpBasicAuthConfig"]);null!=s&&p(t,["httpBasicAuthConfig"],s);const r=d(e,["oauthConfig"]);null!=r&&p(t,["oauthConfig"],r);const l=d(e,["oidcConfig"]);return null!=l&&p(t,["oidcConfig"],l),t}(n)),t}(r)),null!=d(e,["urlContext"])&&p(t,["urlContext"],{});const l=d(e,["codeExecution"]);null!=l&&p(t,["codeExecution"],l);const a=d(e,["computerUse"]);return null!=a&&p(t,["computerUse"],a),t}function mt(e){const t={},n=d(e,["functionCallingConfig"]);null!=n&&p(t,["functionCallingConfig"],function(e){const t={},n=d(e,["mode"]);null!=n&&p(t,["mode"],n);const o=d(e,["allowedFunctionNames"]);return null!=o&&p(t,["allowedFunctionNames"],o),t}(n));const o=d(e,["retrievalConfig"]);return null!=o&&p(t,["retrievalConfig"],function(e){const t={},n=d(e,["latLng"]);null!=n&&p(t,["latLng"],function(e){const t={},n=d(e,["latitude"]);null!=n&&p(t,["latitude"],n);const o=d(e,["longitude"]);return null!=o&&p(t,["longitude"],o),t}(n));const o=d(e,["languageCode"]);return null!=o&&p(t,["languageCode"],o),t}(o)),t}function yt(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["displayName"]);null!=o&&p(t,["displayName"],o);const i=d(e,["model"]);null!=i&&p(t,["model"],i);const s=d(e,["createTime"]);null!=s&&p(t,["createTime"],s);const r=d(e,["updateTime"]);null!=r&&p(t,["updateTime"],r);const l=d(e,["expireTime"]);null!=l&&p(t,["expireTime"],l);const a=d(e,["usageMetadata"]);return null!=a&&p(t,["usageMetadata"],a),t}function vt(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["displayName"]);null!=o&&p(t,["displayName"],o);const i=d(e,["model"]);null!=i&&p(t,["model"],i);const s=d(e,["createTime"]);null!=s&&p(t,["createTime"],s);const r=d(e,["updateTime"]);null!=r&&p(t,["updateTime"],r);const l=d(e,["expireTime"]);null!=l&&p(t,["expireTime"],l);const a=d(e,["usageMetadata"]);return null!=a&&p(t,["usageMetadata"],a),t}class Ct extends u{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new ut(te.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e)}async create(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["model"],Ae(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],function(e,t){const n=d(e,["ttl"]);void 0!==t&&null!=n&&p(t,["ttl"],n);const o=d(e,["expireTime"]);void 0!==t&&null!=o&&p(t,["expireTime"],o);const i=d(e,["displayName"]);void 0!==t&&null!=i&&p(t,["displayName"],i);const s=d(e,["contents"]);if(void 0!==t&&null!=s){let e=Me(s);Array.isArray(e)&&(e=e.map(e=>ht(e))),p(t,["contents"],e)}const r=d(e,["systemInstruction"]);void 0!==t&&null!=r&&p(t,["systemInstruction"],ht(Pe(r)));const l=d(e,["tools"]);if(void 0!==t&&null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>gt(e))),p(t,["tools"],e)}const a=d(e,["toolConfig"]);void 0!==t&&null!=a&&p(t,["toolConfig"],mt(a));const u=d(e,["kmsKeyName"]);return void 0!==t&&null!=u&&p(t,["encryption_spec","kmsKeyName"],u),{}}(i,n)),n}(this.apiClient,e);return r=c("cachedContents",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>vt(e))}{const t=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["model"],Ae(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],function(e,t){const n=d(e,["ttl"]);void 0!==t&&null!=n&&p(t,["ttl"],n);const o=d(e,["expireTime"]);void 0!==t&&null!=o&&p(t,["expireTime"],o);const i=d(e,["displayName"]);void 0!==t&&null!=i&&p(t,["displayName"],i);const s=d(e,["contents"]);if(void 0!==t&&null!=s){let e=Me(s);Array.isArray(e)&&(e=e.map(e=>pt(e))),p(t,["contents"],e)}const r=d(e,["systemInstruction"]);void 0!==t&&null!=r&&p(t,["systemInstruction"],pt(Pe(r)));const l=d(e,["tools"]);if(void 0!==t&&null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>dt(e))),p(t,["tools"],e)}const a=d(e,["toolConfig"]);if(void 0!==t&&null!=a&&p(t,["toolConfig"],ft(a)),void 0!==d(e,["kmsKeyName"]))throw new Error("kmsKeyName parameter is not supported in Gemini API.");return{}}(i,n)),n}(this.apiClient,e);return r=c("cachedContents",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>yt(e))}}async get(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["name"]);null!=o&&p(n,["_url","name"],Fe(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);return r=c("{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>vt(e))}{const t=function(e,t){const n={},o=d(t,["name"]);null!=o&&p(n,["_url","name"],Fe(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);return r=c("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>yt(e))}}async delete(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["name"]);null!=o&&p(n,["_url","name"],Fe(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);return r=c("{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(()=>{const e=new fe;return Object.assign(e,{}),e})}{const t=function(e,t){const n={},o=d(t,["name"]);null!=o&&p(n,["_url","name"],Fe(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);return r=c("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(()=>{const e=new fe;return Object.assign(e,{}),e})}}async update(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["name"]);null!=o&&p(n,["_url","name"],Fe(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],function(e,t){const n=d(e,["ttl"]);void 0!==t&&null!=n&&p(t,["ttl"],n);const o=d(e,["expireTime"]);return void 0!==t&&null!=o&&p(t,["expireTime"],o),{}}(i,n)),n}(this.apiClient,e);return r=c("{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>vt(e))}{const t=function(e,t){const n={},o=d(t,["name"]);null!=o&&p(n,["_url","name"],Fe(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],function(e,t){const n=d(e,["ttl"]);void 0!==t&&null!=n&&p(t,["ttl"],n);const o=d(e,["expireTime"]);return void 0!==t&&null!=o&&p(t,["expireTime"],o),{}}(i,n)),n}(this.apiClient,e);return r=c("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>yt(e))}}async listInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=d(e,["config"]);return null!=n&&p(t,["config"],function(e,t){const n=d(e,["pageSize"]);void 0!==t&&null!=n&&p(t,["_query","pageSize"],n);const o=d(e,["pageToken"]);return void 0!==t&&null!=o&&p(t,["_query","pageToken"],o),{}}(n,t)),t}(e);return r=c("cachedContents",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=d(e,["nextPageToken"]);null!=n&&p(t,["nextPageToken"],n);const o=d(e,["cachedContents"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>vt(e))),p(t,["cachedContents"],e)}return t}(e),n=new he;return Object.assign(n,t),n})}{const t=function(e){const t={},n=d(e,["config"]);return null!=n&&p(t,["config"],function(e,t){const n=d(e,["pageSize"]);void 0!==t&&null!=n&&p(t,["_query","pageSize"],n);const o=d(e,["pageToken"]);return void 0!==t&&null!=o&&p(t,["_query","pageToken"],o),{}}(n,t)),t}(e);return r=c("cachedContents",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=d(e,["nextPageToken"]);null!=n&&p(t,["nextPageToken"],n);const o=d(e,["cachedContents"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>yt(e))),p(t,["cachedContents"],e)}return t}(e),n=new he;return Object.assign(n,t),n})}}}function Tt(e){return this instanceof Tt?(this.v=e,this):new Tt(e)}function Et(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,i=n.apply(e,t||[]),s=[];return o=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),r("next"),r("throw"),r("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),o[Symbol.asyncIterator]=function(){return this},o;function r(e,t){i[e]&&(o[e]=function(t){return new Promise(function(n,o){s.push([e,t,n,o])>1||l(e,t)})},t&&(o[e]=t(o[e])))}function l(e,t){try{(n=i[e](t)).value instanceof Tt?Promise.resolve(n.value.v).then(a,u):c(s[0][2],n)}catch(e){c(s[0][3],e)}var n}function a(e){l("next",e)}function u(e){l("throw",e)}function c(e,t){e(t),s.shift(),s.length&&l(s[0][0],s[0][1])}}function At(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise(function(o,i){!function(e,t,n,o){Promise.resolve(o).then(function(t){e({value:t,done:n})},t)}(o,i,(t=e[n](t)).done,t.value)})}}}function _t(e){var t;if(null==e.candidates||0===e.candidates.length)return!1;const n=null===(t=e.candidates[0])||void 0===t?void 0:t.content;return void 0!==n&&bt(n)}function bt(e){if(void 0===e.parts||0===e.parts.length)return!1;for(const t of e.parts){if(void 0===t||0===Object.keys(t).length)return!1;if(!t.thought&&void 0!==t.text&&""===t.text)return!1}return!0}function St(e){if(void 0===e||0===e.length)return[];const t=[],n=e.length;let o=0;for(;o<n;)if("user"===e[o].role)t.push(e[o]),o++;else{const i=[];let s=!0;for(;o<n&&"model"===e[o].role;)i.push(e[o]),s&&!bt(e[o])&&(s=!1),o++;s?t.push(...i):t.pop()}return t}"function"==typeof SuppressedError&&SuppressedError;class It{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new Ot(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Ot{constructor(e,t,n,o={},i=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=o,this.history=i,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length)for(const t of e)if("user"!==t.role&&"model"!==t.role)throw new Error(`Role must be user or model, but got ${t.role}.`)}(i)}async sendMessage(e){var t;await this.sendPromise;const n=Pe(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var e,t,i;const s=await o,r=null===(t=null===(e=s.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content,l=s.automaticFunctionCallingHistory,a=this.getHistory(!0).length;let u=[];null!=l&&(u=null!==(i=l.slice(a))&&void 0!==i?i:[]);const c=r?[r]:[];this.recordHistory(n,c,u)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var t;await this.sendPromise;const n=Pe(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const i=await o;return this.processStreamResponse(i,n)}getHistory(e=!1){const t=e?St(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var n,o;return Et(this,arguments,function*(){var i,s,r,l;const a=[];try{for(var u,c=!0,p=At(e);!(i=(u=yield Tt(p.next())).done);c=!0){l=u.value,c=!1;const e=l;if(_t(e)){const t=null===(o=null===(n=e.candidates)||void 0===n?void 0:n[0])||void 0===o?void 0:o.content;void 0!==t&&a.push(t)}yield yield Tt(e)}}catch(e){s={error:e}}finally{try{c||i||!(r=p.return)||(yield Tt(r.call(p)))}finally{if(s)throw s.error}}this.recordHistory(t,a)})}recordHistory(e,t,n){let o=[];t.length>0&&t.every(e=>void 0!==e.role)?o=t:o.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...St(n)):this.history.push(e),this.history.push(...o)}}class wt extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,wt.prototype)}}function xt(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["displayName"]);null!=o&&p(t,["displayName"],o);const i=d(e,["mimeType"]);null!=i&&p(t,["mimeType"],i);const s=d(e,["sizeBytes"]);null!=s&&p(t,["sizeBytes"],s);const r=d(e,["createTime"]);null!=r&&p(t,["createTime"],r);const l=d(e,["expirationTime"]);null!=l&&p(t,["expirationTime"],l);const a=d(e,["updateTime"]);null!=a&&p(t,["updateTime"],a);const u=d(e,["sha256Hash"]);null!=u&&p(t,["sha256Hash"],u);const c=d(e,["uri"]);null!=c&&p(t,["uri"],c);const f=d(e,["downloadUri"]);null!=f&&p(t,["downloadUri"],f);const h=d(e,["state"]);null!=h&&p(t,["state"],h);const g=d(e,["source"]);null!=g&&p(t,["source"],g);const m=d(e,["videoMetadata"]);null!=m&&p(t,["videoMetadata"],m);const y=d(e,["error"]);return null!=y&&p(t,["error"],function(e){const t={},n=d(e,["details"]);null!=n&&p(t,["details"],n);const o=d(e,["message"]);null!=o&&p(t,["message"],o);const i=d(e,["code"]);return null!=i&&p(t,["code"],i),t}(y)),t}class kt extends u{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new ut(te.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>xt(e))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=d(e,["config"]);return null!=n&&p(t,["config"],function(e,t){const n=d(e,["pageSize"]);void 0!==t&&null!=n&&p(t,["_query","pageSize"],n);const o=d(e,["pageToken"]);return void 0!==t&&null!=o&&p(t,["_query","pageToken"],o),{}}(n,t)),t}(e);return i=c("files",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>{const t=function(e){const t={},n=d(e,["nextPageToken"]);null!=n&&p(t,["nextPageToken"],n);const o=d(e,["files"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>xt(e))),p(t,["files"],e)}return t}(e),n=new ge;return Object.assign(n,t),n})}}async createInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=d(e,["file"]);null!=n&&p(t,["file"],function(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["displayName"]);null!=o&&p(t,["displayName"],o);const i=d(e,["mimeType"]);null!=i&&p(t,["mimeType"],i);const s=d(e,["sizeBytes"]);null!=s&&p(t,["sizeBytes"],s);const r=d(e,["createTime"]);null!=r&&p(t,["createTime"],r);const l=d(e,["expirationTime"]);null!=l&&p(t,["expirationTime"],l);const a=d(e,["updateTime"]);null!=a&&p(t,["updateTime"],a);const u=d(e,["sha256Hash"]);null!=u&&p(t,["sha256Hash"],u);const c=d(e,["uri"]);null!=c&&p(t,["uri"],c);const f=d(e,["downloadUri"]);null!=f&&p(t,["downloadUri"],f);const h=d(e,["state"]);null!=h&&p(t,["state"],h);const g=d(e,["source"]);null!=g&&p(t,["source"],g);const m=d(e,["videoMetadata"]);null!=m&&p(t,["videoMetadata"],m);const y=d(e,["error"]);return null!=y&&p(t,["error"],function(e){const t={},n=d(e,["details"]);null!=n&&p(t,["details"],n);const o=d(e,["message"]);null!=o&&p(t,["message"],o);const i=d(e,["code"]);return null!=i&&p(t,["code"],i),t}(y)),t}(n));const o=d(e,["config"]);return null!=o&&p(t,["config"],o),t}(e);return i=c("upload/v1beta/files",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(()=>{const e=new me;return Object.assign(e,{}),e})}}async get(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=d(e,["name"]);null!=n&&p(t,["_url","file"],Je(n));const o=d(e,["config"]);return null!=o&&p(t,["config"],o),t}(e);return i=c("files/{file}",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>xt(e))}}async delete(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=d(e,["name"]);null!=n&&p(t,["_url","file"],Je(n));const o=d(e,["config"]);return null!=o&&p(t,["config"],o),t}(e);return i=c("files/{file}",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(()=>{const e=new ye;return Object.assign(e,{}),e})}}}function Rt(e){const t={},n=d(e,["prebuiltVoiceConfig"]);return null!=n&&p(t,["prebuiltVoiceConfig"],function(e){const t={},n=d(e,["voiceName"]);return null!=n&&p(t,["voiceName"],n),t}(n)),t}function Pt(e){const t={},n=d(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["behavior"]);null!=n&&p(t,["behavior"],n);const o=d(e,["description"]);null!=o&&p(t,["description"],o);const i=d(e,["name"]);null!=i&&p(t,["name"],i);const s=d(e,["parameters"]);null!=s&&p(t,["parameters"],s);const r=d(e,["parametersJsonSchema"]);null!=r&&p(t,["parametersJsonSchema"],r);const l=d(e,["response"]);null!=l&&p(t,["response"],l);const a=d(e,["responseJsonSchema"]);return null!=a&&p(t,["responseJsonSchema"],a),t}(e))),p(t,["functionDeclarations"],e)}if(void 0!==d(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=d(e,["googleSearch"]);null!=o&&p(t,["googleSearch"],function(e){const t={},n=d(e,["timeRangeFilter"]);return null!=n&&p(t,["timeRangeFilter"],function(e){const t={},n=d(e,["startTime"]);null!=n&&p(t,["startTime"],n);const o=d(e,["endTime"]);return null!=o&&p(t,["endTime"],o),t}(n)),t}(o));const i=d(e,["googleSearchRetrieval"]);if(null!=i&&p(t,["googleSearchRetrieval"],function(e){const t={},n=d(e,["dynamicRetrievalConfig"]);return null!=n&&p(t,["dynamicRetrievalConfig"],function(e){const t={},n=d(e,["mode"]);null!=n&&p(t,["mode"],n);const o=d(e,["dynamicThreshold"]);return null!=o&&p(t,["dynamicThreshold"],o),t}(n)),t}(i)),void 0!==d(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==d(e,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=d(e,["urlContext"])&&p(t,["urlContext"],{});const s=d(e,["codeExecution"]);null!=s&&p(t,["codeExecution"],s);const r=d(e,["computerUse"]);return null!=r&&p(t,["computerUse"],r),t}function Nt(e){const t={},n=d(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==d(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(e,["description"]);null!=n&&p(t,["description"],n);const o=d(e,["name"]);null!=o&&p(t,["name"],o);const i=d(e,["parameters"]);null!=i&&p(t,["parameters"],i);const s=d(e,["parametersJsonSchema"]);null!=s&&p(t,["parametersJsonSchema"],s);const r=d(e,["response"]);null!=r&&p(t,["response"],r);const l=d(e,["responseJsonSchema"]);return null!=l&&p(t,["responseJsonSchema"],l),t}(e))),p(t,["functionDeclarations"],e)}const o=d(e,["retrieval"]);null!=o&&p(t,["retrieval"],o);const i=d(e,["googleSearch"]);null!=i&&p(t,["googleSearch"],function(e){const t={},n=d(e,["timeRangeFilter"]);return null!=n&&p(t,["timeRangeFilter"],function(e){const t={},n=d(e,["startTime"]);null!=n&&p(t,["startTime"],n);const o=d(e,["endTime"]);return null!=o&&p(t,["endTime"],o),t}(n)),t}(i));const s=d(e,["googleSearchRetrieval"]);null!=s&&p(t,["googleSearchRetrieval"],function(e){const t={},n=d(e,["dynamicRetrievalConfig"]);return null!=n&&p(t,["dynamicRetrievalConfig"],function(e){const t={},n=d(e,["mode"]);null!=n&&p(t,["mode"],n);const o=d(e,["dynamicThreshold"]);return null!=o&&p(t,["dynamicThreshold"],o),t}(n)),t}(s)),null!=d(e,["enterpriseWebSearch"])&&p(t,["enterpriseWebSearch"],{});const r=d(e,["googleMaps"]);null!=r&&p(t,["googleMaps"],function(e){const t={},n=d(e,["authConfig"]);return null!=n&&p(t,["authConfig"],function(e){const t={},n=d(e,["apiKeyConfig"]);null!=n&&p(t,["apiKeyConfig"],function(e){const t={},n=d(e,["apiKeyString"]);return null!=n&&p(t,["apiKeyString"],n),t}(n));const o=d(e,["authType"]);null!=o&&p(t,["authType"],o);const i=d(e,["googleServiceAccountConfig"]);null!=i&&p(t,["googleServiceAccountConfig"],i);const s=d(e,["httpBasicAuthConfig"]);null!=s&&p(t,["httpBasicAuthConfig"],s);const r=d(e,["oauthConfig"]);null!=r&&p(t,["oauthConfig"],r);const l=d(e,["oidcConfig"]);return null!=l&&p(t,["oidcConfig"],l),t}(n)),t}(r)),null!=d(e,["urlContext"])&&p(t,["urlContext"],{});const l=d(e,["codeExecution"]);null!=l&&p(t,["codeExecution"],l);const a=d(e,["computerUse"]);return null!=a&&p(t,["computerUse"],a),t}function Mt(e,t){const n=d(e,["generationConfig"]);void 0!==t&&null!=n&&p(t,["setup","generationConfig"],n);const o=d(e,["responseModalities"]);void 0!==t&&null!=o&&p(t,["setup","generationConfig","responseModalities"],o);const i=d(e,["temperature"]);void 0!==t&&null!=i&&p(t,["setup","generationConfig","temperature"],i);const s=d(e,["topP"]);void 0!==t&&null!=s&&p(t,["setup","generationConfig","topP"],s);const r=d(e,["topK"]);void 0!==t&&null!=r&&p(t,["setup","generationConfig","topK"],r);const l=d(e,["maxOutputTokens"]);void 0!==t&&null!=l&&p(t,["setup","generationConfig","maxOutputTokens"],l);const a=d(e,["mediaResolution"]);void 0!==t&&null!=a&&p(t,["setup","generationConfig","mediaResolution"],a);const u=d(e,["seed"]);void 0!==t&&null!=u&&p(t,["setup","generationConfig","seed"],u);const c=d(e,["speechConfig"]);void 0!==t&&null!=c&&p(t,["setup","generationConfig","speechConfig"],function(e){const t={},n=d(e,["voiceConfig"]);null!=n&&p(t,["voiceConfig"],Rt(n));const o=d(e,["multiSpeakerVoiceConfig"]);null!=o&&p(t,["multiSpeakerVoiceConfig"],function(e){const t={},n=d(e,["speakerVoiceConfigs"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["speaker"]);null!=n&&p(t,["speaker"],n);const o=d(e,["voiceConfig"]);return null!=o&&p(t,["voiceConfig"],Rt(o)),t}(e))),p(t,["speakerVoiceConfigs"],e)}return t}(o));const i=d(e,["languageCode"]);return null!=i&&p(t,["languageCode"],i),t}(Le(c)));const f=d(e,["enableAffectiveDialog"]);void 0!==t&&null!=f&&p(t,["setup","generationConfig","enableAffectiveDialog"],f);const h=d(e,["systemInstruction"]);void 0!==t&&null!=h&&p(t,["setup","systemInstruction"],function(e){const t={},n=d(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["videoMetadata"]);null!=n&&p(t,["videoMetadata"],function(e){const t={},n=d(e,["fps"]);null!=n&&p(t,["fps"],n);const o=d(e,["endOffset"]);null!=o&&p(t,["endOffset"],o);const i=d(e,["startOffset"]);return null!=i&&p(t,["startOffset"],i),t}(n));const o=d(e,["thought"]);null!=o&&p(t,["thought"],o);const i=d(e,["inlineData"]);null!=i&&p(t,["inlineData"],function(e){const t={};if(void 0!==d(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["data"]);null!=n&&p(t,["data"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(i));const s=d(e,["fileData"]);null!=s&&p(t,["fileData"],function(e){const t={};if(void 0!==d(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["fileUri"]);null!=n&&p(t,["fileUri"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(s));const r=d(e,["thoughtSignature"]);null!=r&&p(t,["thoughtSignature"],r);const l=d(e,["codeExecutionResult"]);null!=l&&p(t,["codeExecutionResult"],l);const a=d(e,["executableCode"]);null!=a&&p(t,["executableCode"],a);const u=d(e,["functionCall"]);null!=u&&p(t,["functionCall"],u);const c=d(e,["functionResponse"]);null!=c&&p(t,["functionResponse"],c);const f=d(e,["text"]);return null!=f&&p(t,["text"],f),t}(e))),p(t,["parts"],e)}const o=d(e,["role"]);return null!=o&&p(t,["role"],o),t}(Pe(h)));const g=d(e,["tools"]);if(void 0!==t&&null!=g){let e=je(g);Array.isArray(e)&&(e=e.map(e=>Pt(Ge(e)))),p(t,["setup","tools"],e)}const m=d(e,["sessionResumption"]);void 0!==t&&null!=m&&p(t,["setup","sessionResumption"],function(e){const t={},n=d(e,["handle"]);if(null!=n&&p(t,["handle"],n),void 0!==d(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(m));const y=d(e,["inputAudioTranscription"]);void 0!==t&&null!=y&&p(t,["setup","inputAudioTranscription"],{});const v=d(e,["outputAudioTranscription"]);void 0!==t&&null!=v&&p(t,["setup","outputAudioTranscription"],{});const C=d(e,["realtimeInputConfig"]);void 0!==t&&null!=C&&p(t,["setup","realtimeInputConfig"],function(e){const t={},n=d(e,["automaticActivityDetection"]);null!=n&&p(t,["automaticActivityDetection"],function(e){const t={},n=d(e,["disabled"]);null!=n&&p(t,["disabled"],n);const o=d(e,["startOfSpeechSensitivity"]);null!=o&&p(t,["startOfSpeechSensitivity"],o);const i=d(e,["endOfSpeechSensitivity"]);null!=i&&p(t,["endOfSpeechSensitivity"],i);const s=d(e,["prefixPaddingMs"]);null!=s&&p(t,["prefixPaddingMs"],s);const r=d(e,["silenceDurationMs"]);return null!=r&&p(t,["silenceDurationMs"],r),t}(n));const o=d(e,["activityHandling"]);null!=o&&p(t,["activityHandling"],o);const i=d(e,["turnCoverage"]);return null!=i&&p(t,["turnCoverage"],i),t}(C));const T=d(e,["contextWindowCompression"]);void 0!==t&&null!=T&&p(t,["setup","contextWindowCompression"],function(e){const t={},n=d(e,["triggerTokens"]);null!=n&&p(t,["triggerTokens"],n);const o=d(e,["slidingWindow"]);return null!=o&&p(t,["slidingWindow"],function(e){const t={},n=d(e,["targetTokens"]);return null!=n&&p(t,["targetTokens"],n),t}(o)),t}(T));const E=d(e,["proactivity"]);return void 0!==t&&null!=E&&p(t,["setup","proactivity"],function(e){const t={},n=d(e,["proactiveAudio"]);return null!=n&&p(t,["proactiveAudio"],n),t}(E)),{}}function Dt(e,t){const n=d(e,["generationConfig"]);void 0!==t&&null!=n&&p(t,["setup","generationConfig"],n);const o=d(e,["responseModalities"]);void 0!==t&&null!=o&&p(t,["setup","generationConfig","responseModalities"],o);const i=d(e,["temperature"]);void 0!==t&&null!=i&&p(t,["setup","generationConfig","temperature"],i);const s=d(e,["topP"]);void 0!==t&&null!=s&&p(t,["setup","generationConfig","topP"],s);const r=d(e,["topK"]);void 0!==t&&null!=r&&p(t,["setup","generationConfig","topK"],r);const l=d(e,["maxOutputTokens"]);void 0!==t&&null!=l&&p(t,["setup","generationConfig","maxOutputTokens"],l);const a=d(e,["mediaResolution"]);void 0!==t&&null!=a&&p(t,["setup","generationConfig","mediaResolution"],a);const u=d(e,["seed"]);void 0!==t&&null!=u&&p(t,["setup","generationConfig","seed"],u);const c=d(e,["speechConfig"]);void 0!==t&&null!=c&&p(t,["setup","generationConfig","speechConfig"],function(e){const t={},n=d(e,["voiceConfig"]);if(null!=n&&p(t,["voiceConfig"],function(e){const t={},n=d(e,["prebuiltVoiceConfig"]);return null!=n&&p(t,["prebuiltVoiceConfig"],function(e){const t={},n=d(e,["voiceName"]);return null!=n&&p(t,["voiceName"],n),t}(n)),t}(n)),void 0!==d(e,["multiSpeakerVoiceConfig"]))throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const o=d(e,["languageCode"]);return null!=o&&p(t,["languageCode"],o),t}(Le(c)));const f=d(e,["enableAffectiveDialog"]);void 0!==t&&null!=f&&p(t,["setup","generationConfig","enableAffectiveDialog"],f);const h=d(e,["systemInstruction"]);void 0!==t&&null!=h&&p(t,["setup","systemInstruction"],function(e){const t={},n=d(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["videoMetadata"]);null!=n&&p(t,["videoMetadata"],function(e){const t={},n=d(e,["fps"]);null!=n&&p(t,["fps"],n);const o=d(e,["endOffset"]);null!=o&&p(t,["endOffset"],o);const i=d(e,["startOffset"]);return null!=i&&p(t,["startOffset"],i),t}(n));const o=d(e,["thought"]);null!=o&&p(t,["thought"],o);const i=d(e,["inlineData"]);null!=i&&p(t,["inlineData"],function(e){const t={},n=d(e,["displayName"]);null!=n&&p(t,["displayName"],n);const o=d(e,["data"]);null!=o&&p(t,["data"],o);const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(i));const s=d(e,["fileData"]);null!=s&&p(t,["fileData"],function(e){const t={},n=d(e,["displayName"]);null!=n&&p(t,["displayName"],n);const o=d(e,["fileUri"]);null!=o&&p(t,["fileUri"],o);const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(s));const r=d(e,["thoughtSignature"]);null!=r&&p(t,["thoughtSignature"],r);const l=d(e,["codeExecutionResult"]);null!=l&&p(t,["codeExecutionResult"],l);const a=d(e,["executableCode"]);null!=a&&p(t,["executableCode"],a);const u=d(e,["functionCall"]);null!=u&&p(t,["functionCall"],u);const c=d(e,["functionResponse"]);null!=c&&p(t,["functionResponse"],c);const f=d(e,["text"]);return null!=f&&p(t,["text"],f),t}(e))),p(t,["parts"],e)}const o=d(e,["role"]);return null!=o&&p(t,["role"],o),t}(Pe(h)));const g=d(e,["tools"]);if(void 0!==t&&null!=g){let e=je(g);Array.isArray(e)&&(e=e.map(e=>Nt(Ge(e)))),p(t,["setup","tools"],e)}const m=d(e,["sessionResumption"]);void 0!==t&&null!=m&&p(t,["setup","sessionResumption"],function(e){const t={},n=d(e,["handle"]);null!=n&&p(t,["handle"],n);const o=d(e,["transparent"]);return null!=o&&p(t,["transparent"],o),t}(m));const y=d(e,["inputAudioTranscription"]);void 0!==t&&null!=y&&p(t,["setup","inputAudioTranscription"],{});const v=d(e,["outputAudioTranscription"]);void 0!==t&&null!=v&&p(t,["setup","outputAudioTranscription"],{});const C=d(e,["realtimeInputConfig"]);void 0!==t&&null!=C&&p(t,["setup","realtimeInputConfig"],function(e){const t={},n=d(e,["automaticActivityDetection"]);null!=n&&p(t,["automaticActivityDetection"],function(e){const t={},n=d(e,["disabled"]);null!=n&&p(t,["disabled"],n);const o=d(e,["startOfSpeechSensitivity"]);null!=o&&p(t,["startOfSpeechSensitivity"],o);const i=d(e,["endOfSpeechSensitivity"]);null!=i&&p(t,["endOfSpeechSensitivity"],i);const s=d(e,["prefixPaddingMs"]);null!=s&&p(t,["prefixPaddingMs"],s);const r=d(e,["silenceDurationMs"]);return null!=r&&p(t,["silenceDurationMs"],r),t}(n));const o=d(e,["activityHandling"]);null!=o&&p(t,["activityHandling"],o);const i=d(e,["turnCoverage"]);return null!=i&&p(t,["turnCoverage"],i),t}(C));const T=d(e,["contextWindowCompression"]);void 0!==t&&null!=T&&p(t,["setup","contextWindowCompression"],function(e){const t={},n=d(e,["triggerTokens"]);null!=n&&p(t,["triggerTokens"],n);const o=d(e,["slidingWindow"]);return null!=o&&p(t,["slidingWindow"],function(e){const t={},n=d(e,["targetTokens"]);return null!=n&&p(t,["targetTokens"],n),t}(o)),t}(T));const E=d(e,["proactivity"]);return void 0!==t&&null!=E&&p(t,["setup","proactivity"],function(e){const t={},n=d(e,["proactiveAudio"]);return null!=n&&p(t,["proactiveAudio"],n),t}(E)),{}}function Ut(e){const t={},n=d(e,["media"]);null!=n&&p(t,["mediaChunks"],_e(n));const o=d(e,["audio"]);null!=o&&p(t,["audio"],Ie(o));const i=d(e,["audioStreamEnd"]);null!=i&&p(t,["audioStreamEnd"],i);const s=d(e,["video"]);null!=s&&p(t,["video"],Se(s));const r=d(e,["text"]);return null!=r&&p(t,["text"],r),null!=d(e,["activityStart"])&&p(t,["activityStart"],{}),null!=d(e,["activityEnd"])&&p(t,["activityEnd"],{}),t}function qt(e){const t={},n=d(e,["media"]);null!=n&&p(t,["mediaChunks"],_e(n));const o=d(e,["audio"]);null!=o&&p(t,["audio"],Ie(o));const i=d(e,["audioStreamEnd"]);null!=i&&p(t,["audioStreamEnd"],i);const s=d(e,["video"]);null!=s&&p(t,["video"],Se(s));const r=d(e,["text"]);return null!=r&&p(t,["text"],r),null!=d(e,["activityStart"])&&p(t,["activityStart"],{}),null!=d(e,["activityEnd"])&&p(t,["activityEnd"],{}),t}function Lt(e){const t={},n=d(e,["text"]);null!=n&&p(t,["text"],n);const o=d(e,["weight"]);return null!=o&&p(t,["weight"],o),t}function Gt(e){const t={},n=d(e,["temperature"]);null!=n&&p(t,["temperature"],n);const o=d(e,["topK"]);null!=o&&p(t,["topK"],o);const i=d(e,["seed"]);null!=i&&p(t,["seed"],i);const s=d(e,["guidance"]);null!=s&&p(t,["guidance"],s);const r=d(e,["bpm"]);null!=r&&p(t,["bpm"],r);const l=d(e,["density"]);null!=l&&p(t,["density"],l);const a=d(e,["brightness"]);null!=a&&p(t,["brightness"],a);const u=d(e,["scale"]);null!=u&&p(t,["scale"],u);const c=d(e,["muteBass"]);null!=c&&p(t,["muteBass"],c);const f=d(e,["muteDrums"]);null!=f&&p(t,["muteDrums"],f);const h=d(e,["onlyBassAndDrums"]);return null!=h&&p(t,["onlyBassAndDrums"],h),t}function jt(e){const t={},n=d(e,["model"]);return null!=n&&p(t,["model"],n),t}function Ft(e){const t={},n=d(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Lt(e))),p(t,["weightedPrompts"],e)}return t}function Bt(e){const t={},n=d(e,["setup"]);null!=n&&p(t,["setup"],jt(n));const o=d(e,["clientContent"]);null!=o&&p(t,["clientContent"],Ft(o));const i=d(e,["musicGenerationConfig"]);null!=i&&p(t,["musicGenerationConfig"],Gt(i));const s=d(e,["playbackControl"]);return null!=s&&p(t,["playbackControl"],s),t}function Vt(e){const t={},n=d(e,["text"]);null!=n&&p(t,["text"],n);const o=d(e,["finished"]);return null!=o&&p(t,["finished"],o),t}function Jt(e){const t={},n=d(e,["text"]);null!=n&&p(t,["text"],n);const o=d(e,["finished"]);return null!=o&&p(t,["finished"],o),t}function Ht(e){const t={},n=d(e,["modelTurn"]);null!=n&&p(t,["modelTurn"],function(e){const t={},n=d(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["videoMetadata"]);null!=n&&p(t,["videoMetadata"],function(e){const t={},n=d(e,["fps"]);null!=n&&p(t,["fps"],n);const o=d(e,["endOffset"]);null!=o&&p(t,["endOffset"],o);const i=d(e,["startOffset"]);return null!=i&&p(t,["startOffset"],i),t}(n));const o=d(e,["thought"]);null!=o&&p(t,["thought"],o);const i=d(e,["inlineData"]);null!=i&&p(t,["inlineData"],function(e){const t={},n=d(e,["data"]);null!=n&&p(t,["data"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(i));const s=d(e,["fileData"]);null!=s&&p(t,["fileData"],function(e){const t={},n=d(e,["fileUri"]);null!=n&&p(t,["fileUri"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(s));const r=d(e,["thoughtSignature"]);null!=r&&p(t,["thoughtSignature"],r);const l=d(e,["codeExecutionResult"]);null!=l&&p(t,["codeExecutionResult"],l);const a=d(e,["executableCode"]);null!=a&&p(t,["executableCode"],a);const u=d(e,["functionCall"]);null!=u&&p(t,["functionCall"],u);const c=d(e,["functionResponse"]);null!=c&&p(t,["functionResponse"],c);const f=d(e,["text"]);return null!=f&&p(t,["text"],f),t}(e))),p(t,["parts"],e)}const o=d(e,["role"]);return null!=o&&p(t,["role"],o),t}(n));const o=d(e,["turnComplete"]);null!=o&&p(t,["turnComplete"],o);const i=d(e,["interrupted"]);null!=i&&p(t,["interrupted"],i);const s=d(e,["groundingMetadata"]);null!=s&&p(t,["groundingMetadata"],s);const r=d(e,["generationComplete"]);null!=r&&p(t,["generationComplete"],r);const l=d(e,["inputTranscription"]);null!=l&&p(t,["inputTranscription"],Vt(l));const a=d(e,["outputTranscription"]);null!=a&&p(t,["outputTranscription"],Vt(a));const u=d(e,["urlContextMetadata"]);return null!=u&&p(t,["urlContextMetadata"],function(e){const t={},n=d(e,["urlMetadata"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["retrievedUrl"]);null!=n&&p(t,["retrievedUrl"],n);const o=d(e,["urlRetrievalStatus"]);return null!=o&&p(t,["urlRetrievalStatus"],o),t}(e))),p(t,["urlMetadata"],e)}return t}(u)),t}function $t(e){const t={},n=d(e,["modelTurn"]);null!=n&&p(t,["modelTurn"],function(e){const t={},n=d(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["videoMetadata"]);null!=n&&p(t,["videoMetadata"],function(e){const t={},n=d(e,["fps"]);null!=n&&p(t,["fps"],n);const o=d(e,["endOffset"]);null!=o&&p(t,["endOffset"],o);const i=d(e,["startOffset"]);return null!=i&&p(t,["startOffset"],i),t}(n));const o=d(e,["thought"]);null!=o&&p(t,["thought"],o);const i=d(e,["inlineData"]);null!=i&&p(t,["inlineData"],function(e){const t={},n=d(e,["displayName"]);null!=n&&p(t,["displayName"],n);const o=d(e,["data"]);null!=o&&p(t,["data"],o);const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(i));const s=d(e,["fileData"]);null!=s&&p(t,["fileData"],function(e){const t={},n=d(e,["displayName"]);null!=n&&p(t,["displayName"],n);const o=d(e,["fileUri"]);null!=o&&p(t,["fileUri"],o);const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(s));const r=d(e,["thoughtSignature"]);null!=r&&p(t,["thoughtSignature"],r);const l=d(e,["codeExecutionResult"]);null!=l&&p(t,["codeExecutionResult"],l);const a=d(e,["executableCode"]);null!=a&&p(t,["executableCode"],a);const u=d(e,["functionCall"]);null!=u&&p(t,["functionCall"],u);const c=d(e,["functionResponse"]);null!=c&&p(t,["functionResponse"],c);const f=d(e,["text"]);return null!=f&&p(t,["text"],f),t}(e))),p(t,["parts"],e)}const o=d(e,["role"]);return null!=o&&p(t,["role"],o),t}(n));const o=d(e,["turnComplete"]);null!=o&&p(t,["turnComplete"],o);const i=d(e,["interrupted"]);null!=i&&p(t,["interrupted"],i);const s=d(e,["groundingMetadata"]);null!=s&&p(t,["groundingMetadata"],s);const r=d(e,["generationComplete"]);null!=r&&p(t,["generationComplete"],r);const l=d(e,["inputTranscription"]);null!=l&&p(t,["inputTranscription"],Jt(l));const a=d(e,["outputTranscription"]);return null!=a&&p(t,["outputTranscription"],Jt(a)),t}function zt(e){const t={},n=d(e,["modality"]);null!=n&&p(t,["modality"],n);const o=d(e,["tokenCount"]);return null!=o&&p(t,["tokenCount"],o),t}function Yt(e){const t={},n=d(e,["modality"]);null!=n&&p(t,["modality"],n);const o=d(e,["tokenCount"]);return null!=o&&p(t,["tokenCount"],o),t}function Wt(e){const t={};null!=d(e,["setupComplete"])&&p(t,["setupComplete"],{});const n=d(e,["serverContent"]);null!=n&&p(t,["serverContent"],Ht(n));const o=d(e,["toolCall"]);null!=o&&p(t,["toolCall"],function(e){const t={},n=d(e,["functionCalls"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["id"]);null!=n&&p(t,["id"],n);const o=d(e,["args"]);null!=o&&p(t,["args"],o);const i=d(e,["name"]);return null!=i&&p(t,["name"],i),t}(e))),p(t,["functionCalls"],e)}return t}(o));const i=d(e,["toolCallCancellation"]);null!=i&&p(t,["toolCallCancellation"],function(e){const t={},n=d(e,["ids"]);return null!=n&&p(t,["ids"],n),t}(i));const s=d(e,["usageMetadata"]);null!=s&&p(t,["usageMetadata"],function(e){const t={},n=d(e,["promptTokenCount"]);null!=n&&p(t,["promptTokenCount"],n);const o=d(e,["cachedContentTokenCount"]);null!=o&&p(t,["cachedContentTokenCount"],o);const i=d(e,["responseTokenCount"]);null!=i&&p(t,["responseTokenCount"],i);const s=d(e,["toolUsePromptTokenCount"]);null!=s&&p(t,["toolUsePromptTokenCount"],s);const r=d(e,["thoughtsTokenCount"]);null!=r&&p(t,["thoughtsTokenCount"],r);const l=d(e,["totalTokenCount"]);null!=l&&p(t,["totalTokenCount"],l);const a=d(e,["promptTokensDetails"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>zt(e))),p(t,["promptTokensDetails"],e)}const u=d(e,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>zt(e))),p(t,["cacheTokensDetails"],e)}const c=d(e,["responseTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>zt(e))),p(t,["responseTokensDetails"],e)}const f=d(e,["toolUsePromptTokensDetails"]);if(null!=f){let e=f;Array.isArray(e)&&(e=e.map(e=>zt(e))),p(t,["toolUsePromptTokensDetails"],e)}return t}(s));const r=d(e,["goAway"]);null!=r&&p(t,["goAway"],function(e){const t={},n=d(e,["timeLeft"]);return null!=n&&p(t,["timeLeft"],n),t}(r));const l=d(e,["sessionResumptionUpdate"]);return null!=l&&p(t,["sessionResumptionUpdate"],function(e){const t={},n=d(e,["newHandle"]);null!=n&&p(t,["newHandle"],n);const o=d(e,["resumable"]);null!=o&&p(t,["resumable"],o);const i=d(e,["lastConsumedClientMessageIndex"]);return null!=i&&p(t,["lastConsumedClientMessageIndex"],i),t}(l)),t}function Kt(e){const t={},n=d(e,["setupComplete"]);null!=n&&p(t,["setupComplete"],function(e){const t={},n=d(e,["sessionId"]);return null!=n&&p(t,["sessionId"],n),t}(n));const o=d(e,["serverContent"]);null!=o&&p(t,["serverContent"],$t(o));const i=d(e,["toolCall"]);null!=i&&p(t,["toolCall"],function(e){const t={},n=d(e,["functionCalls"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["args"]);null!=n&&p(t,["args"],n);const o=d(e,["name"]);return null!=o&&p(t,["name"],o),t}(e))),p(t,["functionCalls"],e)}return t}(i));const s=d(e,["toolCallCancellation"]);null!=s&&p(t,["toolCallCancellation"],function(e){const t={},n=d(e,["ids"]);return null!=n&&p(t,["ids"],n),t}(s));const r=d(e,["usageMetadata"]);null!=r&&p(t,["usageMetadata"],function(e){const t={},n=d(e,["promptTokenCount"]);null!=n&&p(t,["promptTokenCount"],n);const o=d(e,["cachedContentTokenCount"]);null!=o&&p(t,["cachedContentTokenCount"],o);const i=d(e,["candidatesTokenCount"]);null!=i&&p(t,["responseTokenCount"],i);const s=d(e,["toolUsePromptTokenCount"]);null!=s&&p(t,["toolUsePromptTokenCount"],s);const r=d(e,["thoughtsTokenCount"]);null!=r&&p(t,["thoughtsTokenCount"],r);const l=d(e,["totalTokenCount"]);null!=l&&p(t,["totalTokenCount"],l);const a=d(e,["promptTokensDetails"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>Yt(e))),p(t,["promptTokensDetails"],e)}const u=d(e,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>Yt(e))),p(t,["cacheTokensDetails"],e)}const c=d(e,["candidatesTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>Yt(e))),p(t,["responseTokensDetails"],e)}const f=d(e,["toolUsePromptTokensDetails"]);if(null!=f){let e=f;Array.isArray(e)&&(e=e.map(e=>Yt(e))),p(t,["toolUsePromptTokensDetails"],e)}const h=d(e,["trafficType"]);return null!=h&&p(t,["trafficType"],h),t}(r));const l=d(e,["goAway"]);null!=l&&p(t,["goAway"],function(e){const t={},n=d(e,["timeLeft"]);return null!=n&&p(t,["timeLeft"],n),t}(l));const a=d(e,["sessionResumptionUpdate"]);return null!=a&&p(t,["sessionResumptionUpdate"],function(e){const t={},n=d(e,["newHandle"]);null!=n&&p(t,["newHandle"],n);const o=d(e,["resumable"]);null!=o&&p(t,["resumable"],o);const i=d(e,["lastConsumedClientMessageIndex"]);return null!=i&&p(t,["lastConsumedClientMessageIndex"],i),t}(a)),t}function Zt(e){const t={},n=d(e,["clientContent"]);null!=n&&p(t,["clientContent"],function(e){const t={},n=d(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["text"]);null!=n&&p(t,["text"],n);const o=d(e,["weight"]);return null!=o&&p(t,["weight"],o),t}(e))),p(t,["weightedPrompts"],e)}return t}(n));const o=d(e,["musicGenerationConfig"]);return null!=o&&p(t,["musicGenerationConfig"],function(e){const t={},n=d(e,["temperature"]);null!=n&&p(t,["temperature"],n);const o=d(e,["topK"]);null!=o&&p(t,["topK"],o);const i=d(e,["seed"]);null!=i&&p(t,["seed"],i);const s=d(e,["guidance"]);null!=s&&p(t,["guidance"],s);const r=d(e,["bpm"]);null!=r&&p(t,["bpm"],r);const l=d(e,["density"]);null!=l&&p(t,["density"],l);const a=d(e,["brightness"]);null!=a&&p(t,["brightness"],a);const u=d(e,["scale"]);null!=u&&p(t,["scale"],u);const c=d(e,["muteBass"]);null!=c&&p(t,["muteBass"],c);const f=d(e,["muteDrums"]);null!=f&&p(t,["muteDrums"],f);const h=d(e,["onlyBassAndDrums"]);return null!=h&&p(t,["onlyBassAndDrums"],h),t}(o)),t}function Xt(e){const t={};null!=d(e,["setupComplete"])&&p(t,["setupComplete"],{});const n=d(e,["serverContent"]);null!=n&&p(t,["serverContent"],function(e){const t={},n=d(e,["audioChunks"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["data"]);null!=n&&p(t,["data"],n);const o=d(e,["mimeType"]);null!=o&&p(t,["mimeType"],o);const i=d(e,["sourceMetadata"]);return null!=i&&p(t,["sourceMetadata"],Zt(i)),t}(e))),p(t,["audioChunks"],e)}return t}(n));const o=d(e,["filteredPrompt"]);return null!=o&&p(t,["filteredPrompt"],function(e){const t={},n=d(e,["text"]);null!=n&&p(t,["text"],n);const o=d(e,["filteredReason"]);return null!=o&&p(t,["filteredReason"],o),t}(o)),t}function Qt(e){const t={},n=d(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["videoMetadata"]);null!=n&&p(t,["videoMetadata"],function(e){const t={},n=d(e,["fps"]);null!=n&&p(t,["fps"],n);const o=d(e,["endOffset"]);null!=o&&p(t,["endOffset"],o);const i=d(e,["startOffset"]);return null!=i&&p(t,["startOffset"],i),t}(n));const o=d(e,["thought"]);null!=o&&p(t,["thought"],o);const i=d(e,["inlineData"]);null!=i&&p(t,["inlineData"],function(e){const t={};if(void 0!==d(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["data"]);null!=n&&p(t,["data"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(i));const s=d(e,["fileData"]);null!=s&&p(t,["fileData"],function(e){const t={};if(void 0!==d(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["fileUri"]);null!=n&&p(t,["fileUri"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(s));const r=d(e,["thoughtSignature"]);null!=r&&p(t,["thoughtSignature"],r);const l=d(e,["codeExecutionResult"]);null!=l&&p(t,["codeExecutionResult"],l);const a=d(e,["executableCode"]);null!=a&&p(t,["executableCode"],a);const u=d(e,["functionCall"]);null!=u&&p(t,["functionCall"],u);const c=d(e,["functionResponse"]);null!=c&&p(t,["functionResponse"],c);const f=d(e,["text"]);return null!=f&&p(t,["text"],f),t}(e))),p(t,["parts"],e)}const o=d(e,["role"]);return null!=o&&p(t,["role"],o),t}function en(e){const t={},n=d(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["behavior"]);null!=n&&p(t,["behavior"],n);const o=d(e,["description"]);null!=o&&p(t,["description"],o);const i=d(e,["name"]);null!=i&&p(t,["name"],i);const s=d(e,["parameters"]);null!=s&&p(t,["parameters"],s);const r=d(e,["parametersJsonSchema"]);null!=r&&p(t,["parametersJsonSchema"],r);const l=d(e,["response"]);null!=l&&p(t,["response"],l);const a=d(e,["responseJsonSchema"]);return null!=a&&p(t,["responseJsonSchema"],a),t}(e))),p(t,["functionDeclarations"],e)}if(void 0!==d(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=d(e,["googleSearch"]);null!=o&&p(t,["googleSearch"],function(e){const t={},n=d(e,["timeRangeFilter"]);return null!=n&&p(t,["timeRangeFilter"],function(e){const t={},n=d(e,["startTime"]);null!=n&&p(t,["startTime"],n);const o=d(e,["endTime"]);return null!=o&&p(t,["endTime"],o),t}(n)),t}(o));const i=d(e,["googleSearchRetrieval"]);if(null!=i&&p(t,["googleSearchRetrieval"],function(e){const t={},n=d(e,["dynamicRetrievalConfig"]);return null!=n&&p(t,["dynamicRetrievalConfig"],function(e){const t={},n=d(e,["mode"]);null!=n&&p(t,["mode"],n);const o=d(e,["dynamicThreshold"]);return null!=o&&p(t,["dynamicThreshold"],o),t}(n)),t}(i)),void 0!==d(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==d(e,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=d(e,["urlContext"])&&p(t,["urlContext"],{});const s=d(e,["codeExecution"]);null!=s&&p(t,["codeExecution"],s);const r=d(e,["computerUse"]);return null!=r&&p(t,["computerUse"],r),t}function tn(e){const t={},n=d(e,["functionCallingConfig"]);null!=n&&p(t,["functionCallingConfig"],function(e){const t={},n=d(e,["mode"]);null!=n&&p(t,["mode"],n);const o=d(e,["allowedFunctionNames"]);return null!=o&&p(t,["allowedFunctionNames"],o),t}(n));const o=d(e,["retrievalConfig"]);return null!=o&&p(t,["retrievalConfig"],function(e){const t={},n=d(e,["latLng"]);null!=n&&p(t,["latLng"],function(e){const t={},n=d(e,["latitude"]);null!=n&&p(t,["latitude"],n);const o=d(e,["longitude"]);return null!=o&&p(t,["longitude"],o),t}(n));const o=d(e,["languageCode"]);return null!=o&&p(t,["languageCode"],o),t}(o)),t}function nn(e){const t={},n=d(e,["prebuiltVoiceConfig"]);return null!=n&&p(t,["prebuiltVoiceConfig"],function(e){const t={},n=d(e,["voiceName"]);return null!=n&&p(t,["voiceName"],n),t}(n)),t}function on(e,t,n){const o={},i=d(t,["systemInstruction"]);void 0!==n&&null!=i&&p(n,["systemInstruction"],Qt(Pe(i)));const s=d(t,["temperature"]);null!=s&&p(o,["temperature"],s);const r=d(t,["topP"]);null!=r&&p(o,["topP"],r);const l=d(t,["topK"]);null!=l&&p(o,["topK"],l);const a=d(t,["candidateCount"]);null!=a&&p(o,["candidateCount"],a);const u=d(t,["maxOutputTokens"]);null!=u&&p(o,["maxOutputTokens"],u);const c=d(t,["stopSequences"]);null!=c&&p(o,["stopSequences"],c);const f=d(t,["responseLogprobs"]);null!=f&&p(o,["responseLogprobs"],f);const h=d(t,["logprobs"]);null!=h&&p(o,["logprobs"],h);const g=d(t,["presencePenalty"]);null!=g&&p(o,["presencePenalty"],g);const m=d(t,["frequencyPenalty"]);null!=m&&p(o,["frequencyPenalty"],m);const y=d(t,["seed"]);null!=y&&p(o,["seed"],y);const v=d(t,["responseMimeType"]);null!=v&&p(o,["responseMimeType"],v);const C=d(t,["responseSchema"]);null!=C&&p(o,["responseSchema"],function(e){const t={},n=d(e,["anyOf"]);null!=n&&p(t,["anyOf"],n);const o=d(e,["default"]);null!=o&&p(t,["default"],o);const i=d(e,["description"]);null!=i&&p(t,["description"],i);const s=d(e,["enum"]);null!=s&&p(t,["enum"],s);const r=d(e,["example"]);null!=r&&p(t,["example"],r);const l=d(e,["format"]);null!=l&&p(t,["format"],l);const a=d(e,["items"]);null!=a&&p(t,["items"],a);const u=d(e,["maxItems"]);null!=u&&p(t,["maxItems"],u);const c=d(e,["maxLength"]);null!=c&&p(t,["maxLength"],c);const f=d(e,["maxProperties"]);null!=f&&p(t,["maxProperties"],f);const h=d(e,["maximum"]);null!=h&&p(t,["maximum"],h);const g=d(e,["minItems"]);null!=g&&p(t,["minItems"],g);const m=d(e,["minLength"]);null!=m&&p(t,["minLength"],m);const y=d(e,["minProperties"]);null!=y&&p(t,["minProperties"],y);const v=d(e,["minimum"]);null!=v&&p(t,["minimum"],v);const C=d(e,["nullable"]);null!=C&&p(t,["nullable"],C);const T=d(e,["pattern"]);null!=T&&p(t,["pattern"],T);const E=d(e,["properties"]);null!=E&&p(t,["properties"],E);const A=d(e,["propertyOrdering"]);null!=A&&p(t,["propertyOrdering"],A);const _=d(e,["required"]);null!=_&&p(t,["required"],_);const b=d(e,["title"]);null!=b&&p(t,["title"],b);const S=d(e,["type"]);return null!=S&&p(t,["type"],S),t}(Ue(C)));const T=d(t,["responseJsonSchema"]);if(null!=T&&p(o,["responseJsonSchema"],T),void 0!==d(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==d(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const E=d(t,["safetySettings"]);if(void 0!==n&&null!=E){let e=E;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==d(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const n=d(e,["category"]);null!=n&&p(t,["category"],n);const o=d(e,["threshold"]);return null!=o&&p(t,["threshold"],o),t}(e))),p(n,["safetySettings"],e)}const A=d(t,["tools"]);if(void 0!==n&&null!=A){let e=je(A);Array.isArray(e)&&(e=e.map(e=>en(Ge(e)))),p(n,["tools"],e)}const _=d(t,["toolConfig"]);if(void 0!==n&&null!=_&&p(n,["toolConfig"],tn(_)),void 0!==d(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const b=d(t,["cachedContent"]);void 0!==n&&null!=b&&p(n,["cachedContent"],Fe(e,b));const S=d(t,["responseModalities"]);null!=S&&p(o,["responseModalities"],S);const I=d(t,["mediaResolution"]);null!=I&&p(o,["mediaResolution"],I);const O=d(t,["speechConfig"]);if(null!=O&&p(o,["speechConfig"],function(e){const t={},n=d(e,["voiceConfig"]);null!=n&&p(t,["voiceConfig"],nn(n));const o=d(e,["multiSpeakerVoiceConfig"]);null!=o&&p(t,["multiSpeakerVoiceConfig"],function(e){const t={},n=d(e,["speakerVoiceConfigs"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["speaker"]);null!=n&&p(t,["speaker"],n);const o=d(e,["voiceConfig"]);return null!=o&&p(t,["voiceConfig"],nn(o)),t}(e))),p(t,["speakerVoiceConfigs"],e)}return t}(o));const i=d(e,["languageCode"]);return null!=i&&p(t,["languageCode"],i),t}(qe(O))),void 0!==d(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const w=d(t,["thinkingConfig"]);return null!=w&&p(o,["thinkingConfig"],function(e){const t={},n=d(e,["includeThoughts"]);null!=n&&p(t,["includeThoughts"],n);const o=d(e,["thinkingBudget"]);return null!=o&&p(t,["thinkingBudget"],o),t}(w)),o}function sn(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["contents"]);if(null!=i){let e=Me(i);Array.isArray(e)&&(e=e.map(e=>Qt(e))),p(n,["contents"],e)}const s=d(t,["config"]);return null!=s&&p(n,["generationConfig"],on(e,s,n)),n}function rn(e){const t={},n=d(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["videoMetadata"]);null!=n&&p(t,["videoMetadata"],function(e){const t={},n=d(e,["fps"]);null!=n&&p(t,["fps"],n);const o=d(e,["endOffset"]);null!=o&&p(t,["endOffset"],o);const i=d(e,["startOffset"]);return null!=i&&p(t,["startOffset"],i),t}(n));const o=d(e,["thought"]);null!=o&&p(t,["thought"],o);const i=d(e,["inlineData"]);null!=i&&p(t,["inlineData"],function(e){const t={},n=d(e,["displayName"]);null!=n&&p(t,["displayName"],n);const o=d(e,["data"]);null!=o&&p(t,["data"],o);const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(i));const s=d(e,["fileData"]);null!=s&&p(t,["fileData"],function(e){const t={},n=d(e,["displayName"]);null!=n&&p(t,["displayName"],n);const o=d(e,["fileUri"]);null!=o&&p(t,["fileUri"],o);const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(s));const r=d(e,["thoughtSignature"]);null!=r&&p(t,["thoughtSignature"],r);const l=d(e,["codeExecutionResult"]);null!=l&&p(t,["codeExecutionResult"],l);const a=d(e,["executableCode"]);null!=a&&p(t,["executableCode"],a);const u=d(e,["functionCall"]);null!=u&&p(t,["functionCall"],u);const c=d(e,["functionResponse"]);null!=c&&p(t,["functionResponse"],c);const f=d(e,["text"]);return null!=f&&p(t,["text"],f),t}(e))),p(t,["parts"],e)}const o=d(e,["role"]);return null!=o&&p(t,["role"],o),t}function ln(e){const t={},n=d(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==d(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=d(e,["description"]);null!=n&&p(t,["description"],n);const o=d(e,["name"]);null!=o&&p(t,["name"],o);const i=d(e,["parameters"]);null!=i&&p(t,["parameters"],i);const s=d(e,["parametersJsonSchema"]);null!=s&&p(t,["parametersJsonSchema"],s);const r=d(e,["response"]);null!=r&&p(t,["response"],r);const l=d(e,["responseJsonSchema"]);return null!=l&&p(t,["responseJsonSchema"],l),t}(e))),p(t,["functionDeclarations"],e)}const o=d(e,["retrieval"]);null!=o&&p(t,["retrieval"],o);const i=d(e,["googleSearch"]);null!=i&&p(t,["googleSearch"],function(e){const t={},n=d(e,["timeRangeFilter"]);return null!=n&&p(t,["timeRangeFilter"],function(e){const t={},n=d(e,["startTime"]);null!=n&&p(t,["startTime"],n);const o=d(e,["endTime"]);return null!=o&&p(t,["endTime"],o),t}(n)),t}(i));const s=d(e,["googleSearchRetrieval"]);null!=s&&p(t,["googleSearchRetrieval"],function(e){const t={},n=d(e,["dynamicRetrievalConfig"]);return null!=n&&p(t,["dynamicRetrievalConfig"],function(e){const t={},n=d(e,["mode"]);null!=n&&p(t,["mode"],n);const o=d(e,["dynamicThreshold"]);return null!=o&&p(t,["dynamicThreshold"],o),t}(n)),t}(s)),null!=d(e,["enterpriseWebSearch"])&&p(t,["enterpriseWebSearch"],{});const r=d(e,["googleMaps"]);null!=r&&p(t,["googleMaps"],function(e){const t={},n=d(e,["authConfig"]);return null!=n&&p(t,["authConfig"],function(e){const t={},n=d(e,["apiKeyConfig"]);null!=n&&p(t,["apiKeyConfig"],function(e){const t={},n=d(e,["apiKeyString"]);return null!=n&&p(t,["apiKeyString"],n),t}(n));const o=d(e,["authType"]);null!=o&&p(t,["authType"],o);const i=d(e,["googleServiceAccountConfig"]);null!=i&&p(t,["googleServiceAccountConfig"],i);const s=d(e,["httpBasicAuthConfig"]);null!=s&&p(t,["httpBasicAuthConfig"],s);const r=d(e,["oauthConfig"]);null!=r&&p(t,["oauthConfig"],r);const l=d(e,["oidcConfig"]);return null!=l&&p(t,["oidcConfig"],l),t}(n)),t}(r)),null!=d(e,["urlContext"])&&p(t,["urlContext"],{});const l=d(e,["codeExecution"]);null!=l&&p(t,["codeExecution"],l);const a=d(e,["computerUse"]);return null!=a&&p(t,["computerUse"],a),t}function an(e){const t={},n=d(e,["functionCallingConfig"]);null!=n&&p(t,["functionCallingConfig"],function(e){const t={},n=d(e,["mode"]);null!=n&&p(t,["mode"],n);const o=d(e,["allowedFunctionNames"]);return null!=o&&p(t,["allowedFunctionNames"],o),t}(n));const o=d(e,["retrievalConfig"]);return null!=o&&p(t,["retrievalConfig"],function(e){const t={},n=d(e,["latLng"]);null!=n&&p(t,["latLng"],function(e){const t={},n=d(e,["latitude"]);null!=n&&p(t,["latitude"],n);const o=d(e,["longitude"]);return null!=o&&p(t,["longitude"],o),t}(n));const o=d(e,["languageCode"]);return null!=o&&p(t,["languageCode"],o),t}(o)),t}function un(e,t,n){const o={},i=d(t,["systemInstruction"]);void 0!==n&&null!=i&&p(n,["systemInstruction"],rn(Pe(i)));const s=d(t,["temperature"]);null!=s&&p(o,["temperature"],s);const r=d(t,["topP"]);null!=r&&p(o,["topP"],r);const l=d(t,["topK"]);null!=l&&p(o,["topK"],l);const a=d(t,["candidateCount"]);null!=a&&p(o,["candidateCount"],a);const u=d(t,["maxOutputTokens"]);null!=u&&p(o,["maxOutputTokens"],u);const c=d(t,["stopSequences"]);null!=c&&p(o,["stopSequences"],c);const f=d(t,["responseLogprobs"]);null!=f&&p(o,["responseLogprobs"],f);const h=d(t,["logprobs"]);null!=h&&p(o,["logprobs"],h);const g=d(t,["presencePenalty"]);null!=g&&p(o,["presencePenalty"],g);const m=d(t,["frequencyPenalty"]);null!=m&&p(o,["frequencyPenalty"],m);const y=d(t,["seed"]);null!=y&&p(o,["seed"],y);const v=d(t,["responseMimeType"]);null!=v&&p(o,["responseMimeType"],v);const C=d(t,["responseSchema"]);null!=C&&p(o,["responseSchema"],function(e){const t={},n=d(e,["anyOf"]);null!=n&&p(t,["anyOf"],n);const o=d(e,["default"]);null!=o&&p(t,["default"],o);const i=d(e,["description"]);null!=i&&p(t,["description"],i);const s=d(e,["enum"]);null!=s&&p(t,["enum"],s);const r=d(e,["example"]);null!=r&&p(t,["example"],r);const l=d(e,["format"]);null!=l&&p(t,["format"],l);const a=d(e,["items"]);null!=a&&p(t,["items"],a);const u=d(e,["maxItems"]);null!=u&&p(t,["maxItems"],u);const c=d(e,["maxLength"]);null!=c&&p(t,["maxLength"],c);const f=d(e,["maxProperties"]);null!=f&&p(t,["maxProperties"],f);const h=d(e,["maximum"]);null!=h&&p(t,["maximum"],h);const g=d(e,["minItems"]);null!=g&&p(t,["minItems"],g);const m=d(e,["minLength"]);null!=m&&p(t,["minLength"],m);const y=d(e,["minProperties"]);null!=y&&p(t,["minProperties"],y);const v=d(e,["minimum"]);null!=v&&p(t,["minimum"],v);const C=d(e,["nullable"]);null!=C&&p(t,["nullable"],C);const T=d(e,["pattern"]);null!=T&&p(t,["pattern"],T);const E=d(e,["properties"]);null!=E&&p(t,["properties"],E);const A=d(e,["propertyOrdering"]);null!=A&&p(t,["propertyOrdering"],A);const _=d(e,["required"]);null!=_&&p(t,["required"],_);const b=d(e,["title"]);null!=b&&p(t,["title"],b);const S=d(e,["type"]);return null!=S&&p(t,["type"],S),t}(Ue(C)));const T=d(t,["responseJsonSchema"]);null!=T&&p(o,["responseJsonSchema"],T);const E=d(t,["routingConfig"]);null!=E&&p(o,["routingConfig"],E);const A=d(t,["modelSelectionConfig"]);null!=A&&p(o,["modelConfig"],function(e){const t={},n=d(e,["featureSelectionPreference"]);return null!=n&&p(t,["featureSelectionPreference"],n),t}(A));const _=d(t,["safetySettings"]);if(void 0!==n&&null!=_){let e=_;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["method"]);null!=n&&p(t,["method"],n);const o=d(e,["category"]);null!=o&&p(t,["category"],o);const i=d(e,["threshold"]);return null!=i&&p(t,["threshold"],i),t}(e))),p(n,["safetySettings"],e)}const b=d(t,["tools"]);if(void 0!==n&&null!=b){let e=je(b);Array.isArray(e)&&(e=e.map(e=>ln(Ge(e)))),p(n,["tools"],e)}const S=d(t,["toolConfig"]);void 0!==n&&null!=S&&p(n,["toolConfig"],an(S));const I=d(t,["labels"]);void 0!==n&&null!=I&&p(n,["labels"],I);const O=d(t,["cachedContent"]);void 0!==n&&null!=O&&p(n,["cachedContent"],Fe(e,O));const w=d(t,["responseModalities"]);null!=w&&p(o,["responseModalities"],w);const x=d(t,["mediaResolution"]);null!=x&&p(o,["mediaResolution"],x);const k=d(t,["speechConfig"]);null!=k&&p(o,["speechConfig"],function(e){const t={},n=d(e,["voiceConfig"]);if(null!=n&&p(t,["voiceConfig"],function(e){const t={},n=d(e,["prebuiltVoiceConfig"]);return null!=n&&p(t,["prebuiltVoiceConfig"],function(e){const t={},n=d(e,["voiceName"]);return null!=n&&p(t,["voiceName"],n),t}(n)),t}(n)),void 0!==d(e,["multiSpeakerVoiceConfig"]))throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const o=d(e,["languageCode"]);return null!=o&&p(t,["languageCode"],o),t}(qe(k)));const R=d(t,["audioTimestamp"]);null!=R&&p(o,["audioTimestamp"],R);const P=d(t,["thinkingConfig"]);return null!=P&&p(o,["thinkingConfig"],function(e){const t={},n=d(e,["includeThoughts"]);null!=n&&p(t,["includeThoughts"],n);const o=d(e,["thinkingBudget"]);return null!=o&&p(t,["thinkingBudget"],o),t}(P)),o}function cn(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["contents"]);if(null!=i){let e=Me(i);Array.isArray(e)&&(e=e.map(e=>rn(e))),p(n,["contents"],e)}const s=d(t,["config"]);return null!=s&&p(n,["generationConfig"],un(e,s,n)),n}function pn(e){const t={},n=d(e,["gcsUri"]);null!=n&&p(t,["gcsUri"],n);const o=d(e,["imageBytes"]);null!=o&&p(t,["bytesBase64Encoded"],Ve(o));const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}function dn(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["prompt"]);null!=i&&p(n,["instances[0]","prompt"],i);const s=d(t,["referenceImages"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["referenceImage"]);null!=n&&p(t,["referenceImage"],pn(n));const o=d(e,["referenceId"]);null!=o&&p(t,["referenceId"],o);const i=d(e,["referenceType"]);null!=i&&p(t,["referenceType"],i);const s=d(e,["maskImageConfig"]);null!=s&&p(t,["maskImageConfig"],function(e){const t={},n=d(e,["maskMode"]);null!=n&&p(t,["maskMode"],n);const o=d(e,["segmentationClasses"]);null!=o&&p(t,["maskClasses"],o);const i=d(e,["maskDilation"]);return null!=i&&p(t,["dilation"],i),t}(s));const r=d(e,["controlImageConfig"]);null!=r&&p(t,["controlImageConfig"],function(e){const t={},n=d(e,["controlType"]);null!=n&&p(t,["controlType"],n);const o=d(e,["enableControlImageComputation"]);return null!=o&&p(t,["computeControl"],o),t}(r));const l=d(e,["styleImageConfig"]);null!=l&&p(t,["styleImageConfig"],function(e){const t={},n=d(e,["styleDescription"]);return null!=n&&p(t,["styleDescription"],n),t}(l));const a=d(e,["subjectImageConfig"]);return null!=a&&p(t,["subjectImageConfig"],function(e){const t={},n=d(e,["subjectType"]);null!=n&&p(t,["subjectType"],n);const o=d(e,["subjectDescription"]);return null!=o&&p(t,["subjectDescription"],o),t}(a)),t}(e))),p(n,["instances[0]","referenceImages"],e)}const r=d(t,["config"]);return null!=r&&p(n,["config"],function(e,t){const n=d(e,["outputGcsUri"]);void 0!==t&&null!=n&&p(t,["parameters","storageUri"],n);const o=d(e,["negativePrompt"]);void 0!==t&&null!=o&&p(t,["parameters","negativePrompt"],o);const i=d(e,["numberOfImages"]);void 0!==t&&null!=i&&p(t,["parameters","sampleCount"],i);const s=d(e,["aspectRatio"]);void 0!==t&&null!=s&&p(t,["parameters","aspectRatio"],s);const r=d(e,["guidanceScale"]);void 0!==t&&null!=r&&p(t,["parameters","guidanceScale"],r);const l=d(e,["seed"]);void 0!==t&&null!=l&&p(t,["parameters","seed"],l);const a=d(e,["safetyFilterLevel"]);void 0!==t&&null!=a&&p(t,["parameters","safetySetting"],a);const u=d(e,["personGeneration"]);void 0!==t&&null!=u&&p(t,["parameters","personGeneration"],u);const c=d(e,["includeSafetyAttributes"]);void 0!==t&&null!=c&&p(t,["parameters","includeSafetyAttributes"],c);const f=d(e,["includeRaiReason"]);void 0!==t&&null!=f&&p(t,["parameters","includeRaiReason"],f);const h=d(e,["language"]);void 0!==t&&null!=h&&p(t,["parameters","language"],h);const g=d(e,["outputMimeType"]);void 0!==t&&null!=g&&p(t,["parameters","outputOptions","mimeType"],g);const m=d(e,["outputCompressionQuality"]);void 0!==t&&null!=m&&p(t,["parameters","outputOptions","compressionQuality"],m);const y=d(e,["editMode"]);void 0!==t&&null!=y&&p(t,["parameters","editMode"],y);const v=d(e,["baseSteps"]);return void 0!==t&&null!=v&&p(t,["parameters","editConfig","baseSteps"],v),{}}(r,n)),n}function fn(e){const t={},n=d(e,["content"]);null!=n&&p(t,["content"],function(e){const t={},n=d(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["videoMetadata"]);null!=n&&p(t,["videoMetadata"],function(e){const t={},n=d(e,["fps"]);null!=n&&p(t,["fps"],n);const o=d(e,["endOffset"]);null!=o&&p(t,["endOffset"],o);const i=d(e,["startOffset"]);return null!=i&&p(t,["startOffset"],i),t}(n));const o=d(e,["thought"]);null!=o&&p(t,["thought"],o);const i=d(e,["inlineData"]);null!=i&&p(t,["inlineData"],function(e){const t={},n=d(e,["data"]);null!=n&&p(t,["data"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(i));const s=d(e,["fileData"]);null!=s&&p(t,["fileData"],function(e){const t={},n=d(e,["fileUri"]);null!=n&&p(t,["fileUri"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(s));const r=d(e,["thoughtSignature"]);null!=r&&p(t,["thoughtSignature"],r);const l=d(e,["codeExecutionResult"]);null!=l&&p(t,["codeExecutionResult"],l);const a=d(e,["executableCode"]);null!=a&&p(t,["executableCode"],a);const u=d(e,["functionCall"]);null!=u&&p(t,["functionCall"],u);const c=d(e,["functionResponse"]);null!=c&&p(t,["functionResponse"],c);const f=d(e,["text"]);return null!=f&&p(t,["text"],f),t}(e))),p(t,["parts"],e)}const o=d(e,["role"]);return null!=o&&p(t,["role"],o),t}(n));const o=d(e,["citationMetadata"]);null!=o&&p(t,["citationMetadata"],function(e){const t={},n=d(e,["citationSources"]);return null!=n&&p(t,["citations"],n),t}(o));const i=d(e,["tokenCount"]);null!=i&&p(t,["tokenCount"],i);const s=d(e,["finishReason"]);null!=s&&p(t,["finishReason"],s);const r=d(e,["urlContextMetadata"]);null!=r&&p(t,["urlContextMetadata"],function(e){const t={},n=d(e,["urlMetadata"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["retrievedUrl"]);null!=n&&p(t,["retrievedUrl"],n);const o=d(e,["urlRetrievalStatus"]);return null!=o&&p(t,["urlRetrievalStatus"],o),t}(e))),p(t,["urlMetadata"],e)}return t}(r));const l=d(e,["avgLogprobs"]);null!=l&&p(t,["avgLogprobs"],l);const a=d(e,["groundingMetadata"]);null!=a&&p(t,["groundingMetadata"],a);const u=d(e,["index"]);null!=u&&p(t,["index"],u);const c=d(e,["logprobsResult"]);null!=c&&p(t,["logprobsResult"],c);const f=d(e,["safetyRatings"]);return null!=f&&p(t,["safetyRatings"],f),t}function hn(e){const t={},n=d(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>fn(e))),p(t,["candidates"],e)}const o=d(e,["modelVersion"]);null!=o&&p(t,["modelVersion"],o);const i=d(e,["promptFeedback"]);null!=i&&p(t,["promptFeedback"],i);const s=d(e,["usageMetadata"]);return null!=s&&p(t,["usageMetadata"],s),t}function gn(e){const t={},n=d(e,["safetyAttributes","categories"]);null!=n&&p(t,["categories"],n);const o=d(e,["safetyAttributes","scores"]);null!=o&&p(t,["scores"],o);const i=d(e,["contentType"]);return null!=i&&p(t,["contentType"],i),t}function mn(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["displayName"]);null!=o&&p(t,["displayName"],o);const i=d(e,["description"]);null!=i&&p(t,["description"],i);const s=d(e,["version"]);null!=s&&p(t,["version"],s);const r=d(e,["_self"]);null!=r&&p(t,["tunedModelInfo"],function(e){const t={},n=d(e,["baseModel"]);null!=n&&p(t,["baseModel"],n);const o=d(e,["createTime"]);null!=o&&p(t,["createTime"],o);const i=d(e,["updateTime"]);return null!=i&&p(t,["updateTime"],i),t}(r));const l=d(e,["inputTokenLimit"]);null!=l&&p(t,["inputTokenLimit"],l);const a=d(e,["outputTokenLimit"]);null!=a&&p(t,["outputTokenLimit"],a);const u=d(e,["supportedGenerationMethods"]);return null!=u&&p(t,["supportedActions"],u),t}function yn(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["metadata"]);null!=o&&p(t,["metadata"],o);const i=d(e,["done"]);null!=i&&p(t,["done"],i);const s=d(e,["error"]);null!=s&&p(t,["error"],s);const r=d(e,["response","generateVideoResponse"]);return null!=r&&p(t,["response"],function(e){const t={},n=d(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["_self"]);return null!=n&&p(t,["video"],function(e){const t={},n=d(e,["video","uri"]);null!=n&&p(t,["uri"],n);const o=d(e,["video","encodedVideo"]);null!=o&&p(t,["videoBytes"],Ve(o));const i=d(e,["encoding"]);return null!=i&&p(t,["mimeType"],i),t}(n)),t}(e))),p(t,["generatedVideos"],e)}const o=d(e,["raiMediaFilteredCount"]);null!=o&&p(t,["raiMediaFilteredCount"],o);const i=d(e,["raiMediaFilteredReasons"]);return null!=i&&p(t,["raiMediaFilteredReasons"],i),t}(r)),t}function vn(e){const t={},n=d(e,["content"]);null!=n&&p(t,["content"],function(e){const t={},n=d(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["videoMetadata"]);null!=n&&p(t,["videoMetadata"],function(e){const t={},n=d(e,["fps"]);null!=n&&p(t,["fps"],n);const o=d(e,["endOffset"]);null!=o&&p(t,["endOffset"],o);const i=d(e,["startOffset"]);return null!=i&&p(t,["startOffset"],i),t}(n));const o=d(e,["thought"]);null!=o&&p(t,["thought"],o);const i=d(e,["inlineData"]);null!=i&&p(t,["inlineData"],function(e){const t={},n=d(e,["displayName"]);null!=n&&p(t,["displayName"],n);const o=d(e,["data"]);null!=o&&p(t,["data"],o);const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(i));const s=d(e,["fileData"]);null!=s&&p(t,["fileData"],function(e){const t={},n=d(e,["displayName"]);null!=n&&p(t,["displayName"],n);const o=d(e,["fileUri"]);null!=o&&p(t,["fileUri"],o);const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(s));const r=d(e,["thoughtSignature"]);null!=r&&p(t,["thoughtSignature"],r);const l=d(e,["codeExecutionResult"]);null!=l&&p(t,["codeExecutionResult"],l);const a=d(e,["executableCode"]);null!=a&&p(t,["executableCode"],a);const u=d(e,["functionCall"]);null!=u&&p(t,["functionCall"],u);const c=d(e,["functionResponse"]);null!=c&&p(t,["functionResponse"],c);const f=d(e,["text"]);return null!=f&&p(t,["text"],f),t}(e))),p(t,["parts"],e)}const o=d(e,["role"]);return null!=o&&p(t,["role"],o),t}(n));const o=d(e,["citationMetadata"]);null!=o&&p(t,["citationMetadata"],function(e){const t={},n=d(e,["citations"]);return null!=n&&p(t,["citations"],n),t}(o));const i=d(e,["finishMessage"]);null!=i&&p(t,["finishMessage"],i);const s=d(e,["finishReason"]);null!=s&&p(t,["finishReason"],s);const r=d(e,["urlContextMetadata"]);null!=r&&p(t,["urlContextMetadata"],function(e){const t={},n=d(e,["urlMetadata"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["retrievedUrl"]);null!=n&&p(t,["retrievedUrl"],n);const o=d(e,["urlRetrievalStatus"]);return null!=o&&p(t,["urlRetrievalStatus"],o),t}(e))),p(t,["urlMetadata"],e)}return t}(r));const l=d(e,["avgLogprobs"]);null!=l&&p(t,["avgLogprobs"],l);const a=d(e,["groundingMetadata"]);null!=a&&p(t,["groundingMetadata"],a);const u=d(e,["index"]);null!=u&&p(t,["index"],u);const c=d(e,["logprobsResult"]);null!=c&&p(t,["logprobsResult"],c);const f=d(e,["safetyRatings"]);return null!=f&&p(t,["safetyRatings"],f),t}function Cn(e){const t={},n=d(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>vn(e))),p(t,["candidates"],e)}const o=d(e,["createTime"]);null!=o&&p(t,["createTime"],o);const i=d(e,["responseId"]);null!=i&&p(t,["responseId"],i);const s=d(e,["modelVersion"]);null!=s&&p(t,["modelVersion"],s);const r=d(e,["promptFeedback"]);null!=r&&p(t,["promptFeedback"],r);const l=d(e,["usageMetadata"]);return null!=l&&p(t,["usageMetadata"],l),t}function Tn(e){const t={},n=d(e,["predictions[]","embeddings"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["values"]);null!=n&&p(t,["values"],n);const o=d(e,["statistics"]);return null!=o&&p(t,["statistics"],function(e){const t={},n=d(e,["truncated"]);null!=n&&p(t,["truncated"],n);const o=d(e,["token_count"]);return null!=o&&p(t,["tokenCount"],o),t}(o)),t}(e))),p(t,["embeddings"],e)}const o=d(e,["metadata"]);return null!=o&&p(t,["metadata"],function(e){const t={},n=d(e,["billableCharacterCount"]);return null!=n&&p(t,["billableCharacterCount"],n),t}(o)),t}function En(e){const t={},n=d(e,["safetyAttributes","categories"]);null!=n&&p(t,["categories"],n);const o=d(e,["safetyAttributes","scores"]);null!=o&&p(t,["scores"],o);const i=d(e,["contentType"]);return null!=i&&p(t,["contentType"],i),t}function An(e){const t={},n=d(e,["_self"]);null!=n&&p(t,["image"],function(e){const t={},n=d(e,["gcsUri"]);null!=n&&p(t,["gcsUri"],n);const o=d(e,["bytesBase64Encoded"]);null!=o&&p(t,["imageBytes"],Ve(o));const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(n));const o=d(e,["raiFilteredReason"]);null!=o&&p(t,["raiFilteredReason"],o);const i=d(e,["_self"]);null!=i&&p(t,["safetyAttributes"],En(i));const s=d(e,["prompt"]);return null!=s&&p(t,["enhancedPrompt"],s),t}function bn(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["displayName"]);null!=o&&p(t,["displayName"],o);const i=d(e,["description"]);null!=i&&p(t,["description"],i);const s=d(e,["versionId"]);null!=s&&p(t,["version"],s);const r=d(e,["deployedModels"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["endpoint"]);null!=n&&p(t,["name"],n);const o=d(e,["deployedModelId"]);return null!=o&&p(t,["deployedModelId"],o),t}(e))),p(t,["endpoints"],e)}const l=d(e,["labels"]);null!=l&&p(t,["labels"],l);const a=d(e,["_self"]);null!=a&&p(t,["tunedModelInfo"],function(e){const t={},n=d(e,["labels","google-vertex-llm-tuning-base-model-id"]);null!=n&&p(t,["baseModel"],n);const o=d(e,["createTime"]);null!=o&&p(t,["createTime"],o);const i=d(e,["updateTime"]);return null!=i&&p(t,["updateTime"],i),t}(a));const u=d(e,["defaultCheckpointId"]);null!=u&&p(t,["defaultCheckpointId"],u);const c=d(e,["checkpoints"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["checkpointId"]);null!=n&&p(t,["checkpointId"],n);const o=d(e,["epoch"]);null!=o&&p(t,["epoch"],o);const i=d(e,["step"]);return null!=i&&p(t,["step"],i),t}(e))),p(t,["checkpoints"],e)}return t}function Sn(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["metadata"]);null!=o&&p(t,["metadata"],o);const i=d(e,["done"]);null!=i&&p(t,["done"],i);const s=d(e,["error"]);null!=s&&p(t,["error"],s);const r=d(e,["response"]);return null!=r&&p(t,["response"],function(e){const t={},n=d(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["_self"]);return null!=n&&p(t,["video"],function(e){const t={},n=d(e,["gcsUri"]);null!=n&&p(t,["uri"],n);const o=d(e,["bytesBase64Encoded"]);null!=o&&p(t,["videoBytes"],Ve(o));const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(n)),t}(e))),p(t,["generatedVideos"],e)}const o=d(e,["raiMediaFilteredCount"]);null!=o&&p(t,["raiMediaFilteredCount"],o);const i=d(e,["raiMediaFilteredReasons"]);return null!=i&&p(t,["raiMediaFilteredReasons"],i),t}(r)),t}const In="x-goog-api-client",On=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class wn{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=null!==(n=this.clientOptions.apiVersion)&&void 0!==n?n:"v1beta",o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:(this.clientOptions.project=void 0,this.clientOptions.location=void 0)}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw new Error("HTTP options are not correctly set.");const t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol="http:"==t.protocol?"ws":"wss",t.toString()}setBaseUrl(e){if(!this.clientOptions.httpOptions)throw new Error("HTTP options are not correctly set.");this.clientOptions.httpOptions.baseUrl=e}constructUrl(e,t,n){const o=[this.getRequestUrlInternal(t)];return n&&o.push(this.getBaseResourcePath()),""!==e&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[t,n]of Object.entries(e.queryParams))o.searchParams.append(t,String(n));let i={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,t,e.abortSignal),this.unaryApiCall(o,i,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[e,o]of Object.entries(t))"object"==typeof o?n[e]=Object.assign(Object.assign({},n[e]),o):void 0!==o&&(n[e]=o);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,n);o.searchParams.has("alt")&&"sse"===o.searchParams.get("alt")||o.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,t,e.abortSignal),this.streamApiCall(o,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n){if(t&&t.timeout||n){const o=new AbortController,i=o.signal;if(t.timeout&&(null==t?void 0:t.timeout)>0){const e=setTimeout(()=>o.abort(),t.timeout);e&&"function"==typeof e.unref&&e.unref()}n&&n.addEventListener("abort",()=>{o.abort()}),e.signal=i}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob)return void console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let n={};if("string"==typeof e.body&&e.body.length>0)try{const t=JSON.parse(e.body);if("object"!=typeof t||null===t||Array.isArray(t))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");n=t}catch(e){return void console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.")}const o=function e(t,n){const o=Object.assign({},t);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t],s=o[t];i&&"object"==typeof i&&!Array.isArray(i)&&s&&"object"==typeof s&&!Array.isArray(s)?o[t]=e(s,i):(s&&i&&typeof s!=typeof i&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${t}". Original type: ${typeof s}, New type: ${typeof i}. Overwriting.`),o[t]=i)}return o}(n,t);e.body=JSON.stringify(o)}(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await xn(e),new ne(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await xn(e),this.processStreamResponse(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}processStreamResponse(e){var t;return Et(this,arguments,function*(){const n=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!n)throw new Error("Response body is empty");try{let t="";for(;;){const{done:i,value:s}=yield Tt(n.read());if(i){if(t.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const r=o.decode(s,{stream:!0});try{const e=JSON.parse(r);if("error"in e){const t=JSON.parse(JSON.stringify(e.error)),n=t.status,o=t.code,i=`got status: ${n}. ${JSON.stringify(e)}`;if(o>=400&&o<600)throw new wt({message:i,status:o})}}catch(e){if("ApiError"===e.name)throw e}t+=r;let l=t.match(On);for(;l;){const n=l[1];try{const o=new Response(n,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield Tt(new ne(o)),t=t.slice(l[0].length),l=t.match(On)}catch(e){throw new Error(`exception parsing stream chunk ${n}. ${e}`)}}}}finally{n.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw new Error(`exception ${e} sending request`)})}getDefaultHeaders(){const e={},t="google-genai-sdk/1.9.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[In]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[n,o]of Object.entries(e.headers))t.append(n,o);e.timeout&&e.timeout>0&&t.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var n;const o={};null!=t&&(o.mimeType=t.mimeType,o.name=t.name,o.displayName=t.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const i=this.clientOptions.uploader,s=await i.stat(e);o.sizeBytes=String(s.size);const r=null!==(n=null==t?void 0:t.mimeType)&&void 0!==n?n:s.type;if(void 0===r||""===r)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=r;const l=await this.fetchUploadUrl(o,t);return i.upload(e,l,this)}async downloadFile(e){const t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t){var n;let o={};o=(null==t?void 0:t.httpOptions)?t.httpOptions:{apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const i={file:e},s=await this.request({path:c("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:o});if(!s||!(null==s?void 0:s.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const r=null===(n=null==s?void 0:s.headers)||void 0===n?void 0:n["x-goog-upload-url"];if(void 0===r)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return r}}async function xn(e){var t;if(void 0===e)throw new Error("response is undefined");if(!e.ok){const n=e.status;let o;o=(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}};const i=JSON.stringify(o);if(n>=400&&n<600)throw new wt({message:i,status:n});throw new Error(i)}}function kn(e){for(const t of e){if(Pn(t))return!0;if("object"==typeof t&&"inputSchema"in t)return!0}return!1}function Rn(e){var t;const n=null!==(t=e[In])&&void 0!==t?t:"";e[In]=(n+" mcp_used/unknown").trimStart()}function Pn(e){return null!==e&&"object"==typeof e&&e instanceof Mn}function Nn(e,t=100){return Et(this,arguments,function*(){let n,o=0;for(;o<t;){const t=yield Tt(e.listTools({cursor:n}));for(const e of t.tools)yield yield Tt(e),o++;if(!t.nextCursor)break;n=t.nextCursor}})}class Mn{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Mn(e,t)}async initialize(){var e,t,n,o;if(this.mcpTools.length>0)return;const i={},s=[];for(const u of this.mcpClients)try{for(var r,l=!0,a=(t=void 0,At(Nn(u)));!(e=(r=await a.next()).done);l=!0){o=r.value,l=!1;const e=o;s.push(e);const t=e.name;if(i[t])throw new Error(`Duplicate function name ${t} found in MCP tools. Please ensure function names are unique.`);i[t]=u}}catch(e){t={error:e}}finally{try{l||e||!(n=a.return)||await n.call(a)}finally{if(t)throw t.error}}this.mcpTools=s,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),function(e,t={}){const n=[],o=new Set;for(const i of e){const e=i.name;if(o.has(e))throw new Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);o.add(e);const s=Ye(i,t);s.functionDeclarations&&n.push(...s.functionDeclarations)}return{functionDeclarations:n}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const e=this.functionNameToMcpClient[n.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const i=await e.callTool({name:n.name,arguments:n.args},void 0,o);t.push({functionResponse:{name:n.name,response:i.isError?{error:i}:i}})}return t}}class Dn{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),s=function(e){const t=new Headers;for(const[n,o]of Object.entries(e))t.append(n,o);return t}(this.apiClient.getDefaultHeaders()),r=`${o}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${this.apiClient.getApiKey()}`;let l=()=>{};const a=new Promise(e=>{l=e}),u=e.callbacks,c=(this.apiClient,{onopen:function(){l({})},onmessage:e=>{!async function(e,t,n){const o=new Te;let i;i=n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data);const s=Xt(i);Object.assign(o,s),t(o)}(0,u.onmessage,e)},onerror:null!==(t=null==u?void 0:u.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==u?void 0:u.onclose)&&void 0!==n?n:function(e){}}),p=this.webSocketFactory.create(r,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(s),c);p.connect(),await a;const d=Bt({setup:jt({model:Ee(this.apiClient,e.model)})});return p.send(JSON.stringify(d)),new Un(p,this.apiClient)}}class Un{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=Ft(function(e){const t={},n=d(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>Lt(e))),p(t,["weightedPrompts"],e)}return t}(e));this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=Bt(function(e){const t={},n=d(e,["musicGenerationConfig"]);return null!=n&&p(t,["musicGenerationConfig"],Gt(n)),t}(e));this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t=Bt({playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(ee.PLAY)}pause(){this.sendPlaybackControl(ee.PAUSE)}stop(){this.sendPlaybackControl(ee.STOP)}resetContext(){this.sendPlaybackControl(ee.RESET_CONTEXT)}close(){this.conn.close()}}class qn{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new Dn(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,o,i,s,r;const l=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion();let u;const c=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&kn(e.config.tools)&&Rn(c);const f=function(e){const t=new Headers;for(const[n,o]of Object.entries(e))t.append(n,o);return t}(c);if(this.apiClient.isVertexAI())u=`${l}/ws/google.cloud.aiplatform.${a}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(f);else{const e=this.apiClient.getApiKey();let t="BidiGenerateContent",n="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==a&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),t="BidiGenerateContentConstrained",n="access_token"),u=`${l}/ws/google.ai.generativelanguage.${a}.GenerativeService.${t}?${n}=${e}`}let h=()=>{};const g=new Promise(e=>{h=e}),m=e.callbacks,y=this.apiClient,v={onopen:function(){var e;null===(e=null==m?void 0:m.onopen)||void 0===e||e.call(m),h({})},onmessage:e=>{!async function(e,t,n){const o=new Ce;let i;i=n.data instanceof Blob?await n.data.text():n.data instanceof ArrayBuffer?(new TextDecoder).decode(n.data):n.data;const s=JSON.parse(i);if(e.isVertexAI()){const e=Kt(s);Object.assign(o,e)}else{const e=Wt(s);Object.assign(o,e)}t(o)}(y,m.onmessage,e)},onerror:null!==(t=null==m?void 0:m.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==m?void 0:m.onclose)&&void 0!==n?n:function(e){}},C=this.webSocketFactory.create(u,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(f),v);C.connect(),await g;let T=Ee(this.apiClient,e.model);this.apiClient.isVertexAI()&&T.startsWith("publishers/")&&(T=`projects/${this.apiClient.getProject()}/locations/${this.apiClient.getLocation()}/`+T);let E={};this.apiClient.isVertexAI()&&void 0===(null===(o=e.config)||void 0===o?void 0:o.responseModalities)&&(void 0===e.config?e.config={responseModalities:[x.AUDIO]}:e.config.responseModalities=[x.AUDIO]),(null===(i=e.config)||void 0===i?void 0:i.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const A=null!==(r=null===(s=e.config)||void 0===s?void 0:s.tools)&&void 0!==r?r:[],_=[];for(const e of A)if(this.isCallableTool(e)){const t=e;_.push(await t.tool())}else _.push(e);_.length>0&&(e.config.tools=_);const b={model:T,config:e.config,callbacks:e.callbacks};return E=this.apiClient.isVertexAI()?function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["setup","model"],Ee(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],Dt(i,n)),n}(this.apiClient,b):function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["setup","model"],Ee(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],Mt(i,n)),n}(this.apiClient,b),delete E.config,C.send(JSON.stringify(E)),new Gn(C,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}}const Ln={turnComplete:!0};class Gn{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let n=[];try{n=Me(t.turns),n=e.isVertexAI()?n.map(e=>rn(e)):n.map(e=>Qt(e))}catch(e){throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses)throw new Error("functionResponses is required.");if(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses],0===n.length)throw new Error("functionResponses is required.");for(const t of n){if("object"!=typeof t||null===t||!("name"in t)||!("response"in t))throw new Error(`Could not parse function response, type '${typeof t}'.`);if(!e.isVertexAI()&&!("id"in t))throw new Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},Ln),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:qt(e)}:{realtimeInput:Ut(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function jn(e){var t,n,o;if(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.disable)return!0;let i=!1;for(const t of null!==(n=null==e?void 0:e.tools)&&void 0!==n?n:[])if(Fn(t)){i=!0;break}if(!i)return!0;const s=null===(o=null==e?void 0:e.automaticFunctionCalling)||void 0===o?void 0:o.maximumRemoteCalls;return!!(s&&(s<0||!Number.isInteger(s))||0==s)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0)}function Fn(e){return"callTool"in e&&"function"==typeof e.callTool}function Bn(e){var t;return!(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.ignoreCallHistory)}class Vn extends u{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,n,o,i,s;const r=await this.processParamsForMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!function(e){var t,n,o;return null!==(o=null===(n=null===(t=e.config)||void 0===t?void 0:t.tools)||void 0===n?void 0:n.some(e=>Pn(e)))&&void 0!==o&&o}(e)||jn(e.config))return await this.generateContentInternal(r);if(function(e){var t,n,o;return null!==(o=null===(n=null===(t=e.config)||void 0===t?void 0:t.tools)||void 0===n?void 0:n.some(e=>!Pn(e)))&&void 0!==o&&o}(e))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let l,a;const u=Me(r.contents),c=null!==(o=null===(n=null===(t=r.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==o?o:10;let p=0;for(;p<c&&(l=await this.generateContentInternal(r),l.functionCalls&&0!==l.functionCalls.length);){const t=l.candidates[0].content,n=[];for(const t of null!==(s=null===(i=e.config)||void 0===i?void 0:i.tools)&&void 0!==s?s:[])if(Fn(t)){const e=t,o=await e.callTool(l.functionCalls);n.push(...o)}p++,a={role:"user",parts:n},r.contents=Me(r.contents),r.contents.push(t),r.contents.push(a),Bn(r.config)&&(u.push(t),u.push(a))}return Bn(r.config)&&(l.automaticFunctionCallingHistory=u),l},this.generateContentStream=async e=>{if(this.maybeMoveToResponseJsonSchem(e),jn(e.config)){const t=await this.processParamsForMcpUsage(e);return await this.generateContentStreamInternal(t)}return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let n;const o=[];if(null==e?void 0:e.generatedImages)for(const i of e.generatedImages)i&&(null==i?void 0:i.safetyAttributes)&&"Positive Prompt"===(null===(t=null==i?void 0:i.safetyAttributes)||void 0===t?void 0:t.contentType)?n=null==i?void 0:i.safetyAttributes:o.push(i);let i;return i=n?{generatedImages:o,positivePromptSafetyAttributes:n}:{generatedImages:o},i}),this.list=async e=>{var t;const n={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!n.config.queryBase){if(null===(t=n.config)||void 0===t?void 0:t.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");n.config.filter="labels.tune-type:*"}return new ut(te.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(n),n)},this.editImage=async e=>{const t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));const n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsForMcpUsage(e){var t,n,o;const i=null===(t=e.config)||void 0===t?void 0:t.tools;if(!i)return e;const s=await Promise.all(i.map(async e=>{if(Fn(e)){const t=e;return await t.tool()}return e})),r={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(r.config.tools=s,e.config&&e.config.tools&&kn(e.config.tools)){const t=null!==(o=null===(n=e.config.httpOptions)||void 0===n?void 0:n.headers)&&void 0!==o?o:{};let i=Object.assign({},t);0===Object.keys(i).length&&(i=this.apiClient.getDefaultHeaders()),Rn(i),r.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:i})}return r}async initAfcToolsMap(e){var t,n,o;const i=new Map;for(const s of null!==(n=null===(t=e.config)||void 0===t?void 0:t.tools)&&void 0!==n?n:[])if(Fn(s)){const e=s,t=await e.tool();for(const n of null!==(o=t.functionDeclarations)&&void 0!==o?o:[]){if(!n.name)throw new Error("Function declaration name is required.");if(i.has(n.name))throw new Error(`Duplicate tool declaration name: ${n.name}`);i.set(n.name,e)}}return i}async processAfcStream(e){var t,n,o;const i=null!==(o=null===(n=null===(t=e.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==o?o:10;let s=!1,r=0;return function(e,t,n){var o,l;return Et(this,arguments,function*(){for(var a,u,c,p;r<i;){s&&(r++,s=!1);const g=yield Tt(e.processParamsForMcpUsage(n)),m=yield Tt(e.generateContentStreamInternal(g)),y=[],v=[];try{for(var d,f=!0,h=(u=void 0,At(m));!(a=(d=yield Tt(h.next())).done);f=!0){p=d.value,f=!1;const e=p;if(yield yield Tt(e),e.candidates&&(null===(o=e.candidates[0])||void 0===o?void 0:o.content)){v.push(e.candidates[0].content);for(const n of null!==(l=e.candidates[0].content.parts)&&void 0!==l?l:[])if(r<i&&n.functionCall){if(!n.functionCall.name)throw new Error("Function call name was not returned by the model.");if(!t.has(n.functionCall.name))throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${n.functionCall.name}`);{const e=yield Tt(t.get(n.functionCall.name).callTool([n.functionCall]));y.push(...e)}}}}}catch(e){u={error:e}}finally{try{f||a||!(c=h.return)||(yield Tt(c.call(h)))}finally{if(u)throw u.error}}if(!(y.length>0))break;{s=!0;const e=new oe;e.candidates=[{content:{role:"user",parts:y}}],yield yield Tt(e);const t=[];t.push(...v),t.push({role:"user",parts:y});const o=Me(n.contents).concat(t);n.contents=o}}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=cn(this.apiClient,e);return r=c("{model}:generateContent",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=Cn(e),n=new oe;return Object.assign(n,t),n})}{const t=sn(this.apiClient,e);return r=c("{model}:generateContent",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>{const t=hn(e),n=new oe;return Object.assign(n,t),n})}}async generateContentStreamInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=cn(this.apiClient,e);return r=c("{model}:streamGenerateContent?alt=sse",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.requestStream({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}),s.then(function(e){return Et(this,arguments,function*(){var t,n,o,i;try{for(var s,r=!0,l=At(e);!(t=(s=yield Tt(l.next())).done);r=!0){i=s.value,r=!1;const e=i,t=Cn(yield Tt(e.json())),n=new oe;Object.assign(n,t),yield yield Tt(n)}}catch(e){n={error:e}}finally{try{r||t||!(o=l.return)||(yield Tt(o.call(l)))}finally{if(n)throw n.error}}})})}{const t=sn(this.apiClient,e);return r=c("{model}:streamGenerateContent?alt=sse",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.requestStream({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}),s.then(function(e){return Et(this,arguments,function*(){var t,n,o,i;try{for(var s,r=!0,l=At(e);!(t=(s=yield Tt(l.next())).done);r=!0){i=s.value,r=!1;const e=i,t=hn(yield Tt(e.json())),n=new oe;Object.assign(n,t),yield yield Tt(n)}}catch(e){n={error:e}}finally{try{r||t||!(o=l.return)||(yield Tt(o.call(l)))}finally{if(n)throw n.error}}})})}}async embedContent(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["contents"]);null!=i&&p(n,["instances[]","content"],Ne(e,i));const s=d(t,["config"]);return null!=s&&p(n,["config"],function(e,t){const n=d(e,["taskType"]);void 0!==t&&null!=n&&p(t,["instances[]","task_type"],n);const o=d(e,["title"]);void 0!==t&&null!=o&&p(t,["instances[]","title"],o);const i=d(e,["outputDimensionality"]);void 0!==t&&null!=i&&p(t,["parameters","outputDimensionality"],i);const s=d(e,["mimeType"]);void 0!==t&&null!=s&&p(t,["instances[]","mimeType"],s);const r=d(e,["autoTruncate"]);return void 0!==t&&null!=r&&p(t,["parameters","autoTruncate"],r),{}}(s,n)),n}(this.apiClient,e);return r=c("{model}:predict",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=Tn(e),n=new ie;return Object.assign(n,t),n})}{const t=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["contents"]);null!=i&&p(n,["requests[]","content"],Ne(e,i));const s=d(t,["config"]);null!=s&&p(n,["config"],function(e,t){const n=d(e,["taskType"]);void 0!==t&&null!=n&&p(t,["requests[]","taskType"],n);const o=d(e,["title"]);void 0!==t&&null!=o&&p(t,["requests[]","title"],o);const i=d(e,["outputDimensionality"]);if(void 0!==t&&null!=i&&p(t,["requests[]","outputDimensionality"],i),void 0!==d(e,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==d(e,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.");return{}}(s,n));const r=d(t,["model"]);return void 0!==r&&p(n,["requests[]","model"],Ee(e,r)),n}(this.apiClient,e);return r=c("{model}:batchEmbedContents",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=d(e,["embeddings"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["values"]);return null!=n&&p(t,["values"],n),t}(e))),p(t,["embeddings"],e)}return null!=d(e,["metadata"])&&p(t,["metadata"],{}),t}(e),n=new ie;return Object.assign(n,t),n})}}async generateImagesInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["prompt"]);null!=i&&p(n,["instances[0]","prompt"],i);const s=d(t,["config"]);return null!=s&&p(n,["config"],function(e,t){const n=d(e,["outputGcsUri"]);void 0!==t&&null!=n&&p(t,["parameters","storageUri"],n);const o=d(e,["negativePrompt"]);void 0!==t&&null!=o&&p(t,["parameters","negativePrompt"],o);const i=d(e,["numberOfImages"]);void 0!==t&&null!=i&&p(t,["parameters","sampleCount"],i);const s=d(e,["aspectRatio"]);void 0!==t&&null!=s&&p(t,["parameters","aspectRatio"],s);const r=d(e,["guidanceScale"]);void 0!==t&&null!=r&&p(t,["parameters","guidanceScale"],r);const l=d(e,["seed"]);void 0!==t&&null!=l&&p(t,["parameters","seed"],l);const a=d(e,["safetyFilterLevel"]);void 0!==t&&null!=a&&p(t,["parameters","safetySetting"],a);const u=d(e,["personGeneration"]);void 0!==t&&null!=u&&p(t,["parameters","personGeneration"],u);const c=d(e,["includeSafetyAttributes"]);void 0!==t&&null!=c&&p(t,["parameters","includeSafetyAttributes"],c);const f=d(e,["includeRaiReason"]);void 0!==t&&null!=f&&p(t,["parameters","includeRaiReason"],f);const h=d(e,["language"]);void 0!==t&&null!=h&&p(t,["parameters","language"],h);const g=d(e,["outputMimeType"]);void 0!==t&&null!=g&&p(t,["parameters","outputOptions","mimeType"],g);const m=d(e,["outputCompressionQuality"]);void 0!==t&&null!=m&&p(t,["parameters","outputOptions","compressionQuality"],m);const y=d(e,["addWatermark"]);void 0!==t&&null!=y&&p(t,["parameters","addWatermark"],y);const v=d(e,["enhancePrompt"]);return void 0!==t&&null!=v&&p(t,["parameters","enhancePrompt"],v),{}}(s,n)),n}(this.apiClient,e);return r=c("{model}:predict",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=d(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>An(e))),p(t,["generatedImages"],e)}const o=d(e,["positivePromptSafetyAttributes"]);return null!=o&&p(t,["positivePromptSafetyAttributes"],En(o)),t}(e),n=new se;return Object.assign(n,t),n})}{const t=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["prompt"]);null!=i&&p(n,["instances[0]","prompt"],i);const s=d(t,["config"]);return null!=s&&p(n,["config"],function(e,t){if(void 0!==d(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==d(e,["negativePrompt"]))throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=d(e,["numberOfImages"]);void 0!==t&&null!=n&&p(t,["parameters","sampleCount"],n);const o=d(e,["aspectRatio"]);void 0!==t&&null!=o&&p(t,["parameters","aspectRatio"],o);const i=d(e,["guidanceScale"]);if(void 0!==t&&null!=i&&p(t,["parameters","guidanceScale"],i),void 0!==d(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const s=d(e,["safetyFilterLevel"]);void 0!==t&&null!=s&&p(t,["parameters","safetySetting"],s);const r=d(e,["personGeneration"]);void 0!==t&&null!=r&&p(t,["parameters","personGeneration"],r);const l=d(e,["includeSafetyAttributes"]);void 0!==t&&null!=l&&p(t,["parameters","includeSafetyAttributes"],l);const a=d(e,["includeRaiReason"]);void 0!==t&&null!=a&&p(t,["parameters","includeRaiReason"],a);const u=d(e,["language"]);void 0!==t&&null!=u&&p(t,["parameters","language"],u);const c=d(e,["outputMimeType"]);void 0!==t&&null!=c&&p(t,["parameters","outputOptions","mimeType"],c);const f=d(e,["outputCompressionQuality"]);if(void 0!==t&&null!=f&&p(t,["parameters","outputOptions","compressionQuality"],f),void 0!==d(e,["addWatermark"]))throw new Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==d(e,["enhancePrompt"]))throw new Error("enhancePrompt parameter is not supported in Gemini API.");return{}}(s,n)),n}(this.apiClient,e);return r=c("{model}:predict",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=d(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["_self"]);null!=n&&p(t,["image"],function(e){const t={},n=d(e,["bytesBase64Encoded"]);null!=n&&p(t,["imageBytes"],Ve(n));const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(n));const o=d(e,["raiFilteredReason"]);null!=o&&p(t,["raiFilteredReason"],o);const i=d(e,["_self"]);return null!=i&&p(t,["safetyAttributes"],gn(i)),t}(e))),p(t,["generatedImages"],e)}const o=d(e,["positivePromptSafetyAttributes"]);return null!=o&&p(t,["positivePromptSafetyAttributes"],gn(o)),t}(e),n=new se;return Object.assign(n,t),n})}}async editImageInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=dn(this.apiClient,e);return i=c("{model}:predict",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>{const t=function(e){const t={},n=d(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>An(e))),p(t,["generatedImages"],e)}return t}(e),n=new re;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["image"]);null!=i&&p(n,["instances[0]","image"],pn(i));const s=d(t,["upscaleFactor"]);null!=s&&p(n,["parameters","upscaleConfig","upscaleFactor"],s);const r=d(t,["config"]);return null!=r&&p(n,["config"],function(e,t){const n=d(e,["includeRaiReason"]);void 0!==t&&null!=n&&p(t,["parameters","includeRaiReason"],n);const o=d(e,["outputMimeType"]);void 0!==t&&null!=o&&p(t,["parameters","outputOptions","mimeType"],o);const i=d(e,["outputCompressionQuality"]);void 0!==t&&null!=i&&p(t,["parameters","outputOptions","compressionQuality"],i);const s=d(e,["enhanceInputImage"]);void 0!==t&&null!=s&&p(t,["parameters","upscaleConfig","enhanceInputImage"],s);const r=d(e,["imagePreservationFactor"]);void 0!==t&&null!=r&&p(t,["parameters","upscaleConfig","imagePreservationFactor"],r);const l=d(e,["numberOfImages"]);void 0!==t&&null!=l&&p(t,["parameters","sampleCount"],l);const a=d(e,["mode"]);return void 0!==t&&null!=a&&p(t,["parameters","mode"],a),{}}(r,n)),n}(this.apiClient,e);return i=c("{model}:predict",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>{const t=function(e){const t={},n=d(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>An(e))),p(t,["generatedImages"],e)}return t}(e),n=new le;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","name"],Ee(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);return r=c("{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>bn(e))}{const t=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","name"],Ee(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);return r=c("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>mn(e))}}async listInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["config"]);return null!=o&&p(n,["config"],function(e,t,n){const o=d(t,["pageSize"]);void 0!==n&&null!=o&&p(n,["_query","pageSize"],o);const i=d(t,["pageToken"]);void 0!==n&&null!=i&&p(n,["_query","pageToken"],i);const s=d(t,["filter"]);void 0!==n&&null!=s&&p(n,["_query","filter"],s);const r=d(t,["queryBase"]);return void 0!==n&&null!=r&&p(n,["_url","models_url"],He(e,r)),{}}(e,o,n)),n}(this.apiClient,e);return r=c("{models_url}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=d(e,["nextPageToken"]);null!=n&&p(t,["nextPageToken"],n);const o=d(e,["_self"]);if(null!=o){let e=$e(o);Array.isArray(e)&&(e=e.map(e=>bn(e))),p(t,["models"],e)}return t}(e),n=new ae;return Object.assign(n,t),n})}{const t=function(e,t){const n={},o=d(t,["config"]);return null!=o&&p(n,["config"],function(e,t,n){const o=d(t,["pageSize"]);void 0!==n&&null!=o&&p(n,["_query","pageSize"],o);const i=d(t,["pageToken"]);void 0!==n&&null!=i&&p(n,["_query","pageToken"],i);const s=d(t,["filter"]);void 0!==n&&null!=s&&p(n,["_query","filter"],s);const r=d(t,["queryBase"]);return void 0!==n&&null!=r&&p(n,["_url","models_url"],He(e,r)),{}}(e,o,n)),n}(this.apiClient,e);return r=c("{models_url}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=d(e,["nextPageToken"]);null!=n&&p(t,["nextPageToken"],n);const o=d(e,["_self"]);if(null!=o){let e=$e(o);Array.isArray(e)&&(e=e.map(e=>mn(e))),p(t,["models"],e)}return t}(e),n=new ae;return Object.assign(n,t),n})}}async update(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],function(e,t){const n=d(e,["displayName"]);void 0!==t&&null!=n&&p(t,["displayName"],n);const o=d(e,["description"]);void 0!==t&&null!=o&&p(t,["description"],o);const i=d(e,["defaultCheckpointId"]);return void 0!==t&&null!=i&&p(t,["defaultCheckpointId"],i),{}}(i,n)),n}(this.apiClient,e);return r=c("{model}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>bn(e))}{const t=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","name"],Ee(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],function(e,t){const n=d(e,["displayName"]);void 0!==t&&null!=n&&p(t,["displayName"],n);const o=d(e,["description"]);void 0!==t&&null!=o&&p(t,["description"],o);const i=d(e,["defaultCheckpointId"]);return void 0!==t&&null!=i&&p(t,["defaultCheckpointId"],i),{}}(i,n)),n}(this.apiClient,e);return r=c("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>mn(e))}}async delete(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","name"],Ee(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);return r=c("{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(()=>{const e=new ue;return Object.assign(e,{}),e})}{const t=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","name"],Ee(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],i),n}(this.apiClient,e);return r=c("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(()=>{const e=new ue;return Object.assign(e,{}),e})}}async countTokens(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["contents"]);if(null!=i){let e=Me(i);Array.isArray(e)&&(e=e.map(e=>rn(e))),p(n,["contents"],e)}const s=d(t,["config"]);return null!=s&&p(n,["config"],function(e,t){const n=d(e,["systemInstruction"]);void 0!==t&&null!=n&&p(t,["systemInstruction"],rn(Pe(n)));const o=d(e,["tools"]);if(void 0!==t&&null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>ln(e))),p(t,["tools"],e)}const i=d(e,["generationConfig"]);return void 0!==t&&null!=i&&p(t,["generationConfig"],i),{}}(s,n)),n}(this.apiClient,e);return r=c("{model}:countTokens",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=d(e,["totalTokens"]);return null!=n&&p(t,["totalTokens"],n),t}(e),n=new ce;return Object.assign(n,t),n})}{const t=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["contents"]);if(null!=i){let e=Me(i);Array.isArray(e)&&(e=e.map(e=>Qt(e))),p(n,["contents"],e)}const s=d(t,["config"]);return null!=s&&p(n,["config"],function(e){if(void 0!==d(e,["systemInstruction"]))throw new Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==d(e,["tools"]))throw new Error("tools parameter is not supported in Gemini API.");if(void 0!==d(e,["generationConfig"]))throw new Error("generationConfig parameter is not supported in Gemini API.");return{}}(s)),n}(this.apiClient,e);return r=c("{model}:countTokens",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=d(e,["totalTokens"]);null!=n&&p(t,["totalTokens"],n);const o=d(e,["cachedContentTokenCount"]);return null!=o&&p(t,["cachedContentTokenCount"],o),t}(e),n=new ce;return Object.assign(n,t),n})}}async computeTokens(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["contents"]);if(null!=i){let e=Me(i);Array.isArray(e)&&(e=e.map(e=>rn(e))),p(n,["contents"],e)}const s=d(t,["config"]);return null!=s&&p(n,["config"],s),n}(this.apiClient,e);return i=c("{model}:computeTokens",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>{const t=function(e){const t={},n=d(e,["tokensInfo"]);return null!=n&&p(t,["tokensInfo"],n),t}(e),n=new pe;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["prompt"]);null!=i&&p(n,["instances[0]","prompt"],i);const s=d(t,["image"]);null!=s&&p(n,["instances[0]","image"],pn(s));const r=d(t,["video"]);null!=r&&p(n,["instances[0]","video"],function(e){const t={},n=d(e,["uri"]);null!=n&&p(t,["gcsUri"],n);const o=d(e,["videoBytes"]);null!=o&&p(t,["bytesBase64Encoded"],Ve(o));const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(r));const l=d(t,["config"]);return null!=l&&p(n,["config"],function(e,t){const n=d(e,["numberOfVideos"]);void 0!==t&&null!=n&&p(t,["parameters","sampleCount"],n);const o=d(e,["outputGcsUri"]);void 0!==t&&null!=o&&p(t,["parameters","storageUri"],o);const i=d(e,["fps"]);void 0!==t&&null!=i&&p(t,["parameters","fps"],i);const s=d(e,["durationSeconds"]);void 0!==t&&null!=s&&p(t,["parameters","durationSeconds"],s);const r=d(e,["seed"]);void 0!==t&&null!=r&&p(t,["parameters","seed"],r);const l=d(e,["aspectRatio"]);void 0!==t&&null!=l&&p(t,["parameters","aspectRatio"],l);const a=d(e,["resolution"]);void 0!==t&&null!=a&&p(t,["parameters","resolution"],a);const u=d(e,["personGeneration"]);void 0!==t&&null!=u&&p(t,["parameters","personGeneration"],u);const c=d(e,["pubsubTopic"]);void 0!==t&&null!=c&&p(t,["parameters","pubsubTopic"],c);const f=d(e,["negativePrompt"]);void 0!==t&&null!=f&&p(t,["parameters","negativePrompt"],f);const h=d(e,["enhancePrompt"]);void 0!==t&&null!=h&&p(t,["parameters","enhancePrompt"],h);const g=d(e,["generateAudio"]);void 0!==t&&null!=g&&p(t,["parameters","generateAudio"],g);const m=d(e,["lastFrame"]);void 0!==t&&null!=m&&p(t,["instances[0]","lastFrame"],pn(m));const y=d(e,["compressionQuality"]);return void 0!==t&&null!=y&&p(t,["parameters","compressionQuality"],y),{}}(l,n)),n}(this.apiClient,e);return r=c("{model}:predictLongRunning",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>Sn(e))}{const t=function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["_url","model"],Ee(e,o));const i=d(t,["prompt"]);null!=i&&p(n,["instances[0]","prompt"],i);const s=d(t,["image"]);if(null!=s&&p(n,["instances[0]","image"],function(e){const t={};if(void 0!==d(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");const n=d(e,["imageBytes"]);null!=n&&p(t,["bytesBase64Encoded"],Ve(n));const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(s)),void 0!==d(t,["video"]))throw new Error("video parameter is not supported in Gemini API.");const r=d(t,["config"]);return null!=r&&p(n,["config"],function(e,t){const n=d(e,["numberOfVideos"]);if(void 0!==t&&null!=n&&p(t,["parameters","sampleCount"],n),void 0!==d(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==d(e,["fps"]))throw new Error("fps parameter is not supported in Gemini API.");const o=d(e,["durationSeconds"]);if(void 0!==t&&null!=o&&p(t,["parameters","durationSeconds"],o),void 0!==d(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const i=d(e,["aspectRatio"]);if(void 0!==t&&null!=i&&p(t,["parameters","aspectRatio"],i),void 0!==d(e,["resolution"]))throw new Error("resolution parameter is not supported in Gemini API.");const s=d(e,["personGeneration"]);if(void 0!==t&&null!=s&&p(t,["parameters","personGeneration"],s),void 0!==d(e,["pubsubTopic"]))throw new Error("pubsubTopic parameter is not supported in Gemini API.");const r=d(e,["negativePrompt"]);void 0!==t&&null!=r&&p(t,["parameters","negativePrompt"],r);const l=d(e,["enhancePrompt"]);if(void 0!==t&&null!=l&&p(t,["parameters","enhancePrompt"],l),void 0!==d(e,["generateAudio"]))throw new Error("generateAudio parameter is not supported in Gemini API.");if(void 0!==d(e,["lastFrame"]))throw new Error("lastFrame parameter is not supported in Gemini API.");if(void 0!==d(e,["compressionQuality"]))throw new Error("compressionQuality parameter is not supported in Gemini API.");return{}}(r,n)),n}(this.apiClient,e);return r=c("{model}:predictLongRunning",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>yn(e))}}}function Jn(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["metadata"]);null!=o&&p(t,["metadata"],o);const i=d(e,["done"]);null!=i&&p(t,["done"],i);const s=d(e,["error"]);null!=s&&p(t,["error"],s);const r=d(e,["response","generateVideoResponse"]);return null!=r&&p(t,["response"],function(e){const t={},n=d(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["_self"]);return null!=n&&p(t,["video"],function(e){const t={},n=d(e,["video","uri"]);null!=n&&p(t,["uri"],n);const o=d(e,["video","encodedVideo"]);null!=o&&p(t,["videoBytes"],Ve(o));const i=d(e,["encoding"]);return null!=i&&p(t,["mimeType"],i),t}(n)),t}(e))),p(t,["generatedVideos"],e)}const o=d(e,["raiMediaFilteredCount"]);null!=o&&p(t,["raiMediaFilteredCount"],o);const i=d(e,["raiMediaFilteredReasons"]);return null!=i&&p(t,["raiMediaFilteredReasons"],i),t}(r)),t}function Hn(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["metadata"]);null!=o&&p(t,["metadata"],o);const i=d(e,["done"]);null!=i&&p(t,["done"],i);const s=d(e,["error"]);null!=s&&p(t,["error"],s);const r=d(e,["response"]);return null!=r&&p(t,["response"],function(e){const t={},n=d(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["_self"]);return null!=n&&p(t,["video"],function(e){const t={},n=d(e,["gcsUri"]);null!=n&&p(t,["uri"],n);const o=d(e,["bytesBase64Encoded"]);null!=o&&p(t,["videoBytes"],Ve(o));const i=d(e,["mimeType"]);return null!=i&&p(t,["mimeType"],i),t}(n)),t}(e))),p(t,["generatedVideos"],e)}const o=d(e,["raiMediaFilteredCount"]);null!=o&&p(t,["raiMediaFilteredCount"],o);const i=d(e,["raiMediaFilteredReasons"]);return null!=i&&p(t,["raiMediaFilteredReasons"],i),t}(r)),t}class $n extends u{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const e=t.name.split("/operations/")[0];let o;return n&&"httpOptions"in n&&(o=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:e,config:{httpOptions:o}})}return this.getVideosOperationInternal({operationName:t.name,config:n})}async getVideosOperationInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=d(e,["operationName"]);null!=n&&p(t,["_url","operationName"],n);const o=d(e,["config"]);return null!=o&&p(t,["config"],o),t}(e);return r=c("{operationName}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>Hn(e))}{const t=function(e){const t={},n=d(e,["operationName"]);null!=n&&p(t,["_url","operationName"],n);const o=d(e,["config"]);return null!=o&&p(t,["config"],o),t}(e);return r=c("{operationName}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>Jn(e))}}async fetchPredictVideosOperationInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(e){const t={},n=d(e,["operationName"]);null!=n&&p(t,["operationName"],n);const o=d(e,["resourceName"]);null!=o&&p(t,["_url","resourceName"],o);const i=d(e,["config"]);return null!=i&&p(t,["config"],i),t}(e);return i=c("{resourceName}:fetchPredictOperation",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>Hn(e))}throw new Error("This method is only supported by the Vertex AI.")}}function zn(e){const t={},n=d(e,["prebuiltVoiceConfig"]);return null!=n&&p(t,["prebuiltVoiceConfig"],function(e){const t={},n=d(e,["voiceName"]);return null!=n&&p(t,["voiceName"],n),t}(n)),t}function Yn(e){const t={},n=d(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["behavior"]);null!=n&&p(t,["behavior"],n);const o=d(e,["description"]);null!=o&&p(t,["description"],o);const i=d(e,["name"]);null!=i&&p(t,["name"],i);const s=d(e,["parameters"]);null!=s&&p(t,["parameters"],s);const r=d(e,["parametersJsonSchema"]);null!=r&&p(t,["parametersJsonSchema"],r);const l=d(e,["response"]);null!=l&&p(t,["response"],l);const a=d(e,["responseJsonSchema"]);return null!=a&&p(t,["responseJsonSchema"],a),t}(e))),p(t,["functionDeclarations"],e)}if(void 0!==d(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=d(e,["googleSearch"]);null!=o&&p(t,["googleSearch"],function(e){const t={},n=d(e,["timeRangeFilter"]);return null!=n&&p(t,["timeRangeFilter"],function(e){const t={},n=d(e,["startTime"]);null!=n&&p(t,["startTime"],n);const o=d(e,["endTime"]);return null!=o&&p(t,["endTime"],o),t}(n)),t}(o));const i=d(e,["googleSearchRetrieval"]);if(null!=i&&p(t,["googleSearchRetrieval"],function(e){const t={},n=d(e,["dynamicRetrievalConfig"]);return null!=n&&p(t,["dynamicRetrievalConfig"],function(e){const t={},n=d(e,["mode"]);null!=n&&p(t,["mode"],n);const o=d(e,["dynamicThreshold"]);return null!=o&&p(t,["dynamicThreshold"],o),t}(n)),t}(i)),void 0!==d(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==d(e,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");null!=d(e,["urlContext"])&&p(t,["urlContext"],{});const s=d(e,["codeExecution"]);null!=s&&p(t,["codeExecution"],s);const r=d(e,["computerUse"]);return null!=r&&p(t,["computerUse"],r),t}function Wn(e,t){const n=d(e,["generationConfig"]);void 0!==t&&null!=n&&p(t,["setup","generationConfig"],n);const o=d(e,["responseModalities"]);void 0!==t&&null!=o&&p(t,["setup","generationConfig","responseModalities"],o);const i=d(e,["temperature"]);void 0!==t&&null!=i&&p(t,["setup","generationConfig","temperature"],i);const s=d(e,["topP"]);void 0!==t&&null!=s&&p(t,["setup","generationConfig","topP"],s);const r=d(e,["topK"]);void 0!==t&&null!=r&&p(t,["setup","generationConfig","topK"],r);const l=d(e,["maxOutputTokens"]);void 0!==t&&null!=l&&p(t,["setup","generationConfig","maxOutputTokens"],l);const a=d(e,["mediaResolution"]);void 0!==t&&null!=a&&p(t,["setup","generationConfig","mediaResolution"],a);const u=d(e,["seed"]);void 0!==t&&null!=u&&p(t,["setup","generationConfig","seed"],u);const c=d(e,["speechConfig"]);void 0!==t&&null!=c&&p(t,["setup","generationConfig","speechConfig"],function(e){const t={},n=d(e,["voiceConfig"]);null!=n&&p(t,["voiceConfig"],zn(n));const o=d(e,["multiSpeakerVoiceConfig"]);null!=o&&p(t,["multiSpeakerVoiceConfig"],function(e){const t={},n=d(e,["speakerVoiceConfigs"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["speaker"]);null!=n&&p(t,["speaker"],n);const o=d(e,["voiceConfig"]);return null!=o&&p(t,["voiceConfig"],zn(o)),t}(e))),p(t,["speakerVoiceConfigs"],e)}return t}(o));const i=d(e,["languageCode"]);return null!=i&&p(t,["languageCode"],i),t}(Le(c)));const f=d(e,["enableAffectiveDialog"]);void 0!==t&&null!=f&&p(t,["setup","generationConfig","enableAffectiveDialog"],f);const h=d(e,["systemInstruction"]);void 0!==t&&null!=h&&p(t,["setup","systemInstruction"],function(e){const t={},n=d(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["videoMetadata"]);null!=n&&p(t,["videoMetadata"],function(e){const t={},n=d(e,["fps"]);null!=n&&p(t,["fps"],n);const o=d(e,["endOffset"]);null!=o&&p(t,["endOffset"],o);const i=d(e,["startOffset"]);return null!=i&&p(t,["startOffset"],i),t}(n));const o=d(e,["thought"]);null!=o&&p(t,["thought"],o);const i=d(e,["inlineData"]);null!=i&&p(t,["inlineData"],function(e){const t={};if(void 0!==d(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["data"]);null!=n&&p(t,["data"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(i));const s=d(e,["fileData"]);null!=s&&p(t,["fileData"],function(e){const t={};if(void 0!==d(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=d(e,["fileUri"]);null!=n&&p(t,["fileUri"],n);const o=d(e,["mimeType"]);return null!=o&&p(t,["mimeType"],o),t}(s));const r=d(e,["thoughtSignature"]);null!=r&&p(t,["thoughtSignature"],r);const l=d(e,["codeExecutionResult"]);null!=l&&p(t,["codeExecutionResult"],l);const a=d(e,["executableCode"]);null!=a&&p(t,["executableCode"],a);const u=d(e,["functionCall"]);null!=u&&p(t,["functionCall"],u);const c=d(e,["functionResponse"]);null!=c&&p(t,["functionResponse"],c);const f=d(e,["text"]);return null!=f&&p(t,["text"],f),t}(e))),p(t,["parts"],e)}const o=d(e,["role"]);return null!=o&&p(t,["role"],o),t}(Pe(h)));const g=d(e,["tools"]);if(void 0!==t&&null!=g){let e=je(g);Array.isArray(e)&&(e=e.map(e=>Yn(Ge(e)))),p(t,["setup","tools"],e)}const m=d(e,["sessionResumption"]);void 0!==t&&null!=m&&p(t,["setup","sessionResumption"],function(e){const t={},n=d(e,["handle"]);if(null!=n&&p(t,["handle"],n),void 0!==d(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(m));const y=d(e,["inputAudioTranscription"]);void 0!==t&&null!=y&&p(t,["setup","inputAudioTranscription"],{});const v=d(e,["outputAudioTranscription"]);void 0!==t&&null!=v&&p(t,["setup","outputAudioTranscription"],{});const C=d(e,["realtimeInputConfig"]);void 0!==t&&null!=C&&p(t,["setup","realtimeInputConfig"],function(e){const t={},n=d(e,["automaticActivityDetection"]);null!=n&&p(t,["automaticActivityDetection"],function(e){const t={},n=d(e,["disabled"]);null!=n&&p(t,["disabled"],n);const o=d(e,["startOfSpeechSensitivity"]);null!=o&&p(t,["startOfSpeechSensitivity"],o);const i=d(e,["endOfSpeechSensitivity"]);null!=i&&p(t,["endOfSpeechSensitivity"],i);const s=d(e,["prefixPaddingMs"]);null!=s&&p(t,["prefixPaddingMs"],s);const r=d(e,["silenceDurationMs"]);return null!=r&&p(t,["silenceDurationMs"],r),t}(n));const o=d(e,["activityHandling"]);null!=o&&p(t,["activityHandling"],o);const i=d(e,["turnCoverage"]);return null!=i&&p(t,["turnCoverage"],i),t}(C));const T=d(e,["contextWindowCompression"]);void 0!==t&&null!=T&&p(t,["setup","contextWindowCompression"],function(e){const t={},n=d(e,["triggerTokens"]);null!=n&&p(t,["triggerTokens"],n);const o=d(e,["slidingWindow"]);return null!=o&&p(t,["slidingWindow"],function(e){const t={},n=d(e,["targetTokens"]);return null!=n&&p(t,["targetTokens"],n),t}(o)),t}(T));const E=d(e,["proactivity"]);return void 0!==t&&null!=E&&p(t,["setup","proactivity"],function(e){const t={},n=d(e,["proactiveAudio"]);return null!=n&&p(t,["proactiveAudio"],n),t}(E)),{}}class Kn extends u{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const r=function(e,t){const n={},o=d(t,["config"]);return null!=o&&p(n,["config"],function(e,t,n){const o=d(t,["expireTime"]);void 0!==n&&null!=o&&p(n,["expireTime"],o);const i=d(t,["newSessionExpireTime"]);void 0!==n&&null!=i&&p(n,["newSessionExpireTime"],i);const s=d(t,["uses"]);void 0!==n&&null!=s&&p(n,["uses"],s);const r=d(t,["liveConnectConstraints"]);void 0!==n&&null!=r&&p(n,["bidiGenerateContentSetup"],function(e,t){const n={},o=d(t,["model"]);null!=o&&p(n,["setup","model"],Ee(e,o));const i=d(t,["config"]);return null!=i&&p(n,["config"],Wn(i,n)),n}(e,r));const l=d(t,["lockAdditionalFields"]);return void 0!==n&&null!=l&&p(n,["fieldMask"],l),{}}(e,o,n)),n}(this.apiClient,e);i=c("auth_tokens",r._url),s=r._query,delete r.config,delete r._url,delete r._query;const l=function(e,t){let n=null;const o=e.bidiGenerateContentSetup;if("object"==typeof o&&null!==o&&"setup"in o){const t=o.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,n=t):delete e.bidiGenerateContentSetup}else void 0!==o&&delete e.bidiGenerateContentSetup;const i=e.fieldMask;if(n){const o=function(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const o=e[n];if("object"==typeof o&&null!=o&&Object.keys(o).length>0){const e=Object.keys(o).map(e=>`${n}.${e}`);t.push(...e)}else t.push(n)}return t.join(",")}(n);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&0===(null==t?void 0:t.lockAdditionalFields.length))o?e.fieldMask=o:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==i&&Array.isArray(i)&&i.length>0){const t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let n=[];i.length>0&&(n=i.map(e=>t.includes(e)?`generationConfig.${e}`:e));const s=[];o&&s.push(o),n.length>0&&s.push(...n),s.length>0?e.fieldMask=s.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==i&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}(r,e.config);return o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>function(e){const t={},n=d(e,["name"]);return null!=n&&p(t,["name"],n),t}(e))}}}function Zn(e){const t={},n=d(e,["baseModel"]);null!=n&&p(t,["baseModel"],n);const o=d(e,["trainingDataset"]);null!=o&&p(t,["tuningTask","trainingData"],function(e){const t={};if(void 0!==d(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==d(e,["vertexDatasetResource"]))throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=d(e,["examples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["textInput"]);null!=n&&p(t,["textInput"],n);const o=d(e,["output"]);return null!=o&&p(t,["output"],o),t}(e))),p(t,["examples","examples"],e)}return t}(o));const i=d(e,["config"]);return null!=i&&p(t,["config"],function(e,t){const n={};if(void 0!==d(e,["validationDataset"]))throw new Error("validationDataset parameter is not supported in Gemini API.");const o=d(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=o&&p(t,["displayName"],o),void 0!==d(e,["description"]))throw new Error("description parameter is not supported in Gemini API.");const i=d(e,["epochCount"]);void 0!==t&&null!=i&&p(t,["tuningTask","hyperparameters","epochCount"],i);const s=d(e,["learningRateMultiplier"]);if(null!=s&&p(n,["tuningTask","hyperparameters","learningRateMultiplier"],s),void 0!==d(e,["exportLastCheckpointOnly"]))throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==d(e,["adapterSize"]))throw new Error("adapterSize parameter is not supported in Gemini API.");const r=d(e,["batchSize"]);void 0!==t&&null!=r&&p(t,["tuningTask","hyperparameters","batchSize"],r);const l=d(e,["learningRate"]);return void 0!==t&&null!=l&&p(t,["tuningTask","hyperparameters","learningRate"],l),n}(i,t)),t}function Xn(e){const t={},n=d(e,["baseModel"]);null!=n&&p(t,["baseModel"],n);const o=d(e,["trainingDataset"]);null!=o&&p(t,["supervisedTuningSpec","trainingDatasetUri"],function(e,t){const n=d(e,["gcsUri"]);void 0!==t&&null!=n&&p(t,["supervisedTuningSpec","trainingDatasetUri"],n);const o=d(e,["vertexDatasetResource"]);if(void 0!==t&&null!=o&&p(t,["supervisedTuningSpec","trainingDatasetUri"],o),void 0!==d(e,["examples"]))throw new Error("examples parameter is not supported in Vertex AI.");return{}}(o,t));const i=d(e,["config"]);return null!=i&&p(t,["config"],function(e,t){const n={},o=d(e,["validationDataset"]);void 0!==t&&null!=o&&p(t,["supervisedTuningSpec"],function(e,t){const n={},o=d(e,["gcsUri"]);null!=o&&p(n,["validationDatasetUri"],o);const i=d(e,["vertexDatasetResource"]);return void 0!==t&&null!=i&&p(t,["supervisedTuningSpec","trainingDatasetUri"],i),n}(o,n));const i=d(e,["tunedModelDisplayName"]);void 0!==t&&null!=i&&p(t,["tunedModelDisplayName"],i);const s=d(e,["description"]);void 0!==t&&null!=s&&p(t,["description"],s);const r=d(e,["epochCount"]);void 0!==t&&null!=r&&p(t,["supervisedTuningSpec","hyperParameters","epochCount"],r);const l=d(e,["learningRateMultiplier"]);void 0!==t&&null!=l&&p(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],l);const a=d(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=a&&p(t,["supervisedTuningSpec","exportLastCheckpointOnly"],a);const u=d(e,["adapterSize"]);if(void 0!==t&&null!=u&&p(t,["supervisedTuningSpec","hyperParameters","adapterSize"],u),void 0!==d(e,["batchSize"]))throw new Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==d(e,["learningRate"]))throw new Error("learningRate parameter is not supported in Vertex AI.");return n}(i,t)),t}function Qn(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["state"]);null!=o&&p(t,["state"],Be(o));const i=d(e,["createTime"]);null!=i&&p(t,["createTime"],i);const s=d(e,["tuningTask","startTime"]);null!=s&&p(t,["startTime"],s);const r=d(e,["tuningTask","completeTime"]);null!=r&&p(t,["endTime"],r);const l=d(e,["updateTime"]);null!=l&&p(t,["updateTime"],l);const a=d(e,["description"]);null!=a&&p(t,["description"],a);const u=d(e,["baseModel"]);null!=u&&p(t,["baseModel"],u);const c=d(e,["_self"]);null!=c&&p(t,["tunedModel"],function(e){const t={},n=d(e,["name"]);null!=n&&p(t,["model"],n);const o=d(e,["name"]);return null!=o&&p(t,["endpoint"],o),t}(c));const f=d(e,["distillationSpec"]);null!=f&&p(t,["distillationSpec"],f);const h=d(e,["experiment"]);null!=h&&p(t,["experiment"],h);const g=d(e,["labels"]);null!=g&&p(t,["labels"],g);const m=d(e,["pipelineJob"]);null!=m&&p(t,["pipelineJob"],m);const y=d(e,["satisfiesPzi"]);null!=y&&p(t,["satisfiesPzi"],y);const v=d(e,["satisfiesPzs"]);null!=v&&p(t,["satisfiesPzs"],v);const C=d(e,["serviceAccount"]);null!=C&&p(t,["serviceAccount"],C);const T=d(e,["tunedModelDisplayName"]);return null!=T&&p(t,["tunedModelDisplayName"],T),t}function eo(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["state"]);null!=o&&p(t,["state"],Be(o));const i=d(e,["createTime"]);null!=i&&p(t,["createTime"],i);const s=d(e,["startTime"]);null!=s&&p(t,["startTime"],s);const r=d(e,["endTime"]);null!=r&&p(t,["endTime"],r);const l=d(e,["updateTime"]);null!=l&&p(t,["updateTime"],l);const a=d(e,["error"]);null!=a&&p(t,["error"],a);const u=d(e,["description"]);null!=u&&p(t,["description"],u);const c=d(e,["baseModel"]);null!=c&&p(t,["baseModel"],c);const f=d(e,["tunedModel"]);null!=f&&p(t,["tunedModel"],function(e){const t={},n=d(e,["model"]);null!=n&&p(t,["model"],n);const o=d(e,["endpoint"]);null!=o&&p(t,["endpoint"],o);const i=d(e,["checkpoints"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=d(e,["checkpointId"]);null!=n&&p(t,["checkpointId"],n);const o=d(e,["epoch"]);null!=o&&p(t,["epoch"],o);const i=d(e,["step"]);null!=i&&p(t,["step"],i);const s=d(e,["endpoint"]);return null!=s&&p(t,["endpoint"],s),t}(e))),p(t,["checkpoints"],e)}return t}(f));const h=d(e,["supervisedTuningSpec"]);null!=h&&p(t,["supervisedTuningSpec"],h);const g=d(e,["tuningDataStats"]);null!=g&&p(t,["tuningDataStats"],g);const m=d(e,["encryptionSpec"]);null!=m&&p(t,["encryptionSpec"],m);const y=d(e,["partnerModelTuningSpec"]);null!=y&&p(t,["partnerModelTuningSpec"],y);const v=d(e,["distillationSpec"]);null!=v&&p(t,["distillationSpec"],v);const C=d(e,["experiment"]);null!=C&&p(t,["experiment"],C);const T=d(e,["labels"]);null!=T&&p(t,["labels"],T);const E=d(e,["pipelineJob"]);null!=E&&p(t,["pipelineJob"],E);const A=d(e,["satisfiesPzi"]);null!=A&&p(t,["satisfiesPzi"],A);const _=d(e,["satisfiesPzs"]);null!=_&&p(t,["satisfiesPzs"],_);const b=d(e,["serviceAccount"]);null!=b&&p(t,["serviceAccount"],b);const S=d(e,["tunedModelDisplayName"]);return null!=S&&p(t,["tunedModelDisplayName"],S),t}class to extends u{constructor(e){super(),this.apiClient=e,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new ut(te.PAGED_ITEM_TUNING_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.tune=async e=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(e);{const t=await this.tuneMldevInternal(e);let n="";return void 0!==t.metadata&&void 0!==t.metadata.tunedModel?n=t.metadata.tunedModel:void 0!==t.name&&t.name.includes("/operations/")&&(n=t.name.split("/operations/")[0]),{name:n,state:R.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=d(e,["name"]);null!=n&&p(t,["_url","name"],n);const o=d(e,["config"]);return null!=o&&p(t,["config"],o),t}(e);return r=c("{name}",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>eo(e))}{const t=function(e){const t={},n=d(e,["name"]);null!=n&&p(t,["_url","name"],n);const o=d(e,["config"]);return null!=o&&p(t,["config"],o),t}(e);return r=c("{name}",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>Qn(e))}}async listInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=d(e,["config"]);return null!=n&&p(t,["config"],function(e,t){const n=d(e,["pageSize"]);void 0!==t&&null!=n&&p(t,["_query","pageSize"],n);const o=d(e,["pageToken"]);void 0!==t&&null!=o&&p(t,["_query","pageToken"],o);const i=d(e,["filter"]);return void 0!==t&&null!=i&&p(t,["_query","filter"],i),{}}(n,t)),t}(e);return r=c("tuningJobs",o._url),l=o._query,delete o.config,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=d(e,["nextPageToken"]);null!=n&&p(t,["nextPageToken"],n);const o=d(e,["tuningJobs"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>eo(e))),p(t,["tuningJobs"],e)}return t}(e),n=new de;return Object.assign(n,t),n})}{const t=function(e){const t={},n=d(e,["config"]);return null!=n&&p(t,["config"],function(e,t){const n=d(e,["pageSize"]);void 0!==t&&null!=n&&p(t,["_query","pageSize"],n);const o=d(e,["pageToken"]);void 0!==t&&null!=o&&p(t,["_query","pageToken"],o);const i=d(e,["filter"]);return void 0!==t&&null!=i&&p(t,["_query","filter"],i),{}}(n,t)),t}(e);return r=c("tunedModels",t._url),l=t._query,delete t.config,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=d(e,["nextPageToken"]);null!=n&&p(t,["nextPageToken"],n);const o=d(e,["tunedModels"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>Qn(e))),p(t,["tuningJobs"],e)}return t}(e),n=new de;return Object.assign(n,t),n})}}async tuneInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=Xn(e);return i=c("tuningJobs",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>eo(e))}throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=Zn(e);return i=c("tunedModels",r._url),s=r._query,delete r.config,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>function(e){const t={},n=d(e,["name"]);null!=n&&p(t,["name"],n);const o=d(e,["metadata"]);null!=o&&p(t,["metadata"],o);const i=d(e,["done"]);null!=i&&p(t,["done"],i);const s=d(e,["error"]);return null!=s&&p(t,["error"],s),t}(e))}}}class no{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const oo="x-goog-upload-status";function io(e){return new Promise(t=>setTimeout(t,e))}class so{async upload(e,t,n){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e,t,n){var o,i,s;let r=0,l=0,a=new ne(new Response),u="upload";for(r=e.size;l<r;){const s=Math.min(8388608,r-l),c=e.slice(l,l+s);l+s>=r&&(u+=", finalize");let p=0,d=1e3;for(;p<3&&(a=await n.request({path:"",body:c,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(l),"Content-Length":String(s)}}}),!(null===(o=null==a?void 0:a.headers)||void 0===o?void 0:o[oo]));)p++,await io(d),d*=2;if(l+=s,"active"!==(null===(i=null==a?void 0:a.headers)||void 0===i?void 0:i[oo]))break;if(r<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const c=await(null==a?void 0:a.json());if("final"!==(null===(s=null==a?void 0:a.headers)||void 0===s?void 0:s[oo]))throw new Error("Failed to upload file: Upload status is not finalized.");return c.file}(e,t,n)}async stat(e){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e){return{size:e.size,type:e.type}}(e)}}class ro{create(e,t,n){return new lo(e,t,n)}}class lo{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.close()}}const ao="x-goog-api-key";class uo{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(null===e.get(ao)){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(ao,this.apiKey)}}}class co{constructor(e){var t;if(null==e.apiKey)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!==(t=e.vertexai)&&void 0!==t&&t,this.apiKey=e.apiKey;const n=function(e,t,n){var o,i,s;if(!(null===(o=e.httpOptions)||void 0===o?void 0:o.baseUrl)){const o={geminiUrl:void 0,vertexUrl:void 0};return e.vertexai?null!==(i=o.vertexUrl)&&void 0!==i?i:t:null!==(s=o.geminiUrl)&&void 0!==s?s:n}return e.httpOptions.baseUrl}(e,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion;const o=new uo(this.apiKey);this.apiClient=new wn({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:"gl-node/web",uploader:new so,downloader:new no}),this.models=new Vn(this.apiClient),this.live=new qn(this.apiClient,o,new ro),this.batches=new ct(this.apiClient),this.chats=new It(this.models,this.apiClient),this.caches=new Ct(this.apiClient),this.files=new kt(this.apiClient),this.operations=new $n(this.apiClient),this.authTokens=new Kn(this.apiClient),this.tunings=new to(this.apiClient)}}function po(){return(0,s.jsx)("div",{className:"askaiwp-typing-wrapper",children:(0,s.jsxs)("div",{className:"askaiwp-typing-indicator",children:[(0,s.jsx)("span",{}),(0,s.jsx)("span",{}),(0,s.jsx)("span",{})]})})}var fo={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function ho(e){fo=e}var go={exec:()=>null};function mo(e,t=""){let n="string"==typeof e?e:e.source,o={replace:(e,t)=>{let i="string"==typeof t?t:t.source;return i=i.replace(yo.caret,"$1"),n=n.replace(e,i),o},getRegex:()=>new RegExp(n,t)};return o}var yo={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[\t ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},vo=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Co=/(?:[*+-]|\d{1,9}[.)])/,To=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Eo=mo(To).replace(/bull/g,Co).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Ao=mo(To).replace(/bull/g,Co).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),_o=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,bo=/(?!\s*\])(?:\\.|[^\[\]\\])+/,So=mo(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",bo).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Io=mo(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Co).getRegex(),Oo="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",wo=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,xo=mo("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",wo).replace("tag",Oo).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ko=mo(_o).replace("hr",vo).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Oo).getRegex(),Ro={blockquote:mo(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ko).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:So,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:vo,html:xo,lheading:Eo,list:Io,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:ko,table:go,text:/^[^\n]+/},Po=mo("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",vo).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Oo).getRegex(),No={...Ro,lheading:Ao,table:Po,paragraph:mo(_o).replace("hr",vo).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Po).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Oo).getRegex()},Mo={...Ro,html:mo("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",wo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:go,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:mo(_o).replace("hr",vo).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Eo).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Do=/^( {2,}|\\)\n(?!\s*$)/,Uo=/[\p{P}\p{S}]/u,qo=/[\s\p{P}\p{S}]/u,Lo=/[^\s\p{P}\p{S}]/u,Go=mo(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,qo).getRegex(),jo=/(?!~)[\p{P}\p{S}]/u,Fo=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Bo=mo(Fo,"u").replace(/punct/g,Uo).getRegex(),Vo=mo(Fo,"u").replace(/punct/g,jo).getRegex(),Jo="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Ho=mo(Jo,"gu").replace(/notPunctSpace/g,Lo).replace(/punctSpace/g,qo).replace(/punct/g,Uo).getRegex(),$o=mo(Jo,"gu").replace(/notPunctSpace/g,/(?:[^\s\p{P}\p{S}]|~)/u).replace(/punctSpace/g,/(?!~)[\s\p{P}\p{S}]/u).replace(/punct/g,jo).getRegex(),zo=mo("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Lo).replace(/punctSpace/g,qo).replace(/punct/g,Uo).getRegex(),Yo=mo(/\\(punct)/,"gu").replace(/punct/g,Uo).getRegex(),Wo=mo(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Ko=mo(wo).replace("(?:--\x3e|$)","--\x3e").getRegex(),Zo=mo("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Ko).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Xo=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Qo=mo(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Xo).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ei=mo(/^!?\[(label)\]\[(ref)\]/).replace("label",Xo).replace("ref",bo).getRegex(),ti=mo(/^!?\[(ref)\](?:\[\])?/).replace("ref",bo).getRegex(),ni={_backpedal:go,anyPunctuation:Yo,autolink:Wo,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:Do,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:go,emStrongLDelim:Bo,emStrongRDelimAst:Ho,emStrongRDelimUnd:zo,escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,link:Qo,nolink:ti,punctuation:Go,reflink:ei,reflinkSearch:mo("reflink|nolink(?!\\()","g").replace("reflink",ei).replace("nolink",ti).getRegex(),tag:Zo,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:go},oi={...ni,link:mo(/^!?\[(label)\]\((.*?)\)/).replace("label",Xo).getRegex(),reflink:mo(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Xo).getRegex()},ii={...ni,emStrongRDelimAst:$o,emStrongLDelim:Vo,url:mo(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},si={...ii,br:mo(Do).replace("{2,}","*").getRegex(),text:mo(ii.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ri={normal:Ro,gfm:No,pedantic:Mo},li={normal:ni,gfm:ii,breaks:si,pedantic:oi},ai={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ui=e=>ai[e];function ci(e,t){if(t){if(yo.escapeTest.test(e))return e.replace(yo.escapeReplace,ui)}else if(yo.escapeTestNoEncode.test(e))return e.replace(yo.escapeReplaceNoEncode,ui);return e}function pi(e){try{e=encodeURI(e).replace(yo.percentDecode,"%")}catch{return null}return e}function di(e,t){let n=e.replace(yo.findPipe,(e,t,n)=>{let o=!1,i=t;for(;--i>=0&&"\\"===n[i];)o=!o;return o?"|":" |"}).split(yo.splitPipe),o=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;o<n.length;o++)n[o]=n[o].trim().replace(yo.slashPipe,"|");return n}function fi(e,t,n){let o=e.length;if(0===o)return"";let i=0;for(;i<o;){let s=e.charAt(o-i-1);if(s!==t||n){if(s===t||!n)break;i++}else i++}return e.slice(0,o-i)}function hi(e,t,n,o,i){let s=t.href,r=t.title||null,l=e[1].replace(i.other.outputLinkReplace,"$1");o.state.inLink=!0;let a={type:"!"===e[0].charAt(0)?"image":"link",raw:n,href:s,title:r,text:l,tokens:o.inlineTokens(l)};return o.state.inLink=!1,a}var gi=class{options;rules;lexer;constructor(e){this.options=e||fo}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let e=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:fi(e,"\n")}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let e=t[0],n=function(e,t,n){let o=e.match(n.other.indentCodeCompensation);if(null===o)return t;let i=o[1];return t.split("\n").map(e=>{let t=e.match(n.other.beginningSpace);if(null===t)return e;let[o]=t;return o.length>=i.length?e.slice(i.length):e}).join("\n")}(e,t[3]||"",this.rules);return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(this.rules.other.endingHash.test(e)){let t=fi(e,"#");(this.options.pedantic||!t||this.rules.other.endingSpaceChar.test(t))&&(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:fi(t[0],"\n")}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let e=fi(t[0],"\n").split("\n"),n="",o="",i=[];for(;e.length>0;){let t,s=!1,r=[];for(t=0;t<e.length;t++)if(this.rules.other.blockquoteStart.test(e[t]))r.push(e[t]),s=!0;else{if(s)break;r.push(e[t])}e=e.slice(t);let l=r.join("\n"),a=l.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}\n${l}`:l,o=o?`${o}\n${a}`:a;let u=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(a,i,!0),this.lexer.state.top=u,0===e.length)break;let c=i.at(-1);if("code"===c?.type)break;if("blockquote"===c?.type){let t=c,s=t.raw+"\n"+e.join("\n"),r=this.blockquote(s);i[i.length-1]=r,n=n.substring(0,n.length-t.raw.length)+r.raw,o=o.substring(0,o.length-t.text.length)+r.text;break}if("list"===c?.type){let t=c,s=t.raw+"\n"+e.join("\n"),r=this.list(s);i[i.length-1]=r,n=n.substring(0,n.length-c.raw.length)+r.raw,o=o.substring(0,o.length-t.raw.length)+r.raw,e=s.substring(i.at(-1).raw.length).split("\n");continue}}return{type:"blockquote",raw:n,tokens:i,text:o}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),o=n.length>1,i={type:"list",raw:"",ordered:o,start:o?+n.slice(0,-1):"",loose:!1,items:[]};n=o?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=o?n:"[*+-]");let s=this.rules.other.listItemRegex(n),r=!1;for(;e;){let n=!1,o="",l="";if(!(t=s.exec(e))||this.rules.block.hr.test(e))break;o=t[0],e=e.substring(o.length);let a=t[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,e=>" ".repeat(3*e.length)),u=e.split("\n",1)[0],c=!a.trim(),p=0;if(this.options.pedantic?(p=2,l=a.trimStart()):c?p=t[1].length+1:(p=t[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,l=a.slice(p),p+=t[1].length),c&&this.rules.other.blankLine.test(u)&&(o+=u+"\n",e=e.substring(u.length+1),n=!0),!n){let t=this.rules.other.nextBulletRegex(p),n=this.rules.other.hrRegex(p),i=this.rules.other.fencesBeginRegex(p),s=this.rules.other.headingBeginRegex(p),r=this.rules.other.htmlBeginRegex(p);for(;e;){let d,f=e.split("\n",1)[0];if(u=f,this.options.pedantic?(u=u.replace(this.rules.other.listReplaceNesting,"  "),d=u):d=u.replace(this.rules.other.tabCharGlobal,"    "),i.test(u)||s.test(u)||r.test(u)||t.test(u)||n.test(u))break;if(d.search(this.rules.other.nonSpaceChar)>=p||!u.trim())l+="\n"+d.slice(p);else{if(c||a.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||i.test(a)||s.test(a)||n.test(a))break;l+="\n"+u}!c&&!u.trim()&&(c=!0),o+=f+"\n",e=e.substring(f.length+1),a=d.slice(p)}}i.loose||(r?i.loose=!0:this.rules.other.doubleBlankLine.test(o)&&(r=!0));let d,f=null;this.options.gfm&&(f=this.rules.other.listIsTask.exec(l),f&&(d="[ ] "!==f[0],l=l.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:o,task:!!f,checked:d,loose:!1,text:l,tokens:[]}),i.raw+=o}let l=i.items.at(-1);if(!l)return;l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd(),i.raw=i.raw.trimEnd();for(let e=0;e<i.items.length;e++)if(this.lexer.state.top=!1,i.items[e].tokens=this.lexer.blockTokens(i.items[e].text,[]),!i.loose){let t=i.items[e].tokens.filter(e=>"space"===e.type),n=t.length>0&&t.some(e=>this.rules.other.anyLine.test(e.raw));i.loose=n}if(i.loose)for(let e=0;e<i.items.length;e++)i.items[e].loose=!0;return i}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let e=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:n,title:o}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=di(t[1]),o=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],s={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===o.length){for(let e of o)this.rules.other.tableAlignRight.test(e)?s.align.push("right"):this.rules.other.tableAlignCenter.test(e)?s.align.push("center"):this.rules.other.tableAlignLeft.test(e)?s.align.push("left"):s.align.push(null);for(let e=0;e<n.length;e++)s.header.push({text:n[e],tokens:this.lexer.inline(n[e]),header:!0,align:s.align[e]});for(let e of i)s.rows.push(di(e,s.header.length).map((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:s.align[t]})));return s}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let e=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(e)){if(!this.rules.other.endAngleBracket.test(e))return;let t=fi(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{let e=function(e,t){if(-1===e.indexOf(t[1]))return-1;let n=0;for(let o=0;o<e.length;o++)if("\\"===e[o])o++;else if(e[o]===t[0])n++;else if(e[o]===t[1]&&(n--,n<0))return o;return n>0?-2:-1}(t[2],"()");if(-2===e)return;if(e>-1){let n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],o="";if(this.options.pedantic){let e=this.rules.other.pedanticHrefTitle.exec(n);e&&(n=e[1],o=e[3])}else o=t[3]?t[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(n=this.options.pedantic&&!this.rules.other.endAngleBracket.test(e)?n.slice(1):n.slice(1,-1)),hi(t,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let e=t[(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!e){let e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return hi(n,e,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let o=this.rules.inline.emStrongLDelim.exec(e);if(!(!o||o[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!o[1]&&!o[2]||!n||this.rules.inline.punctuation.exec(n))){let n,i,s=[...o[0]].length-1,r=s,l=0,a="*"===o[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(a.lastIndex=0,t=t.slice(-1*e.length+s);null!=(o=a.exec(t));){if(n=o[1]||o[2]||o[3]||o[4]||o[5]||o[6],!n)continue;if(i=[...n].length,o[3]||o[4]){r+=i;continue}if((o[5]||o[6])&&s%3&&!((s+i)%3)){l+=i;continue}if(r-=i,r>0)continue;i=Math.min(i,i+r+l);let t=[...o[0]][0].length,a=e.slice(0,s+o.index+t+i);if(Math.min(s,i)%2){let e=a.slice(1,-1);return{type:"em",raw:a,text:e,tokens:this.lexer.inlineTokens(e)}}let u=a.slice(2,-2);return{type:"strong",raw:a,text:u,tokens:this.lexer.inlineTokens(u)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(this.rules.other.newLineCharGlobal," "),n=this.rules.other.nonSpaceChar.test(e),o=this.rules.other.startingSpaceChar.test(e)&&this.rules.other.endingSpaceChar.test(e);return n&&o&&(e=e.substring(1,e.length-1)),{type:"codespan",raw:t[0],text:e}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let e,n;return"@"===t[2]?(e=t[1],n="mailto:"+e):(e=t[1],n=e),{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,n;if("@"===t[2])e=t[0],n="mailto:"+e;else{let o;do{o=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(o!==t[0]);e=t[0],n="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let e=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:e}}}},mi=class e{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||fo,this.options.tokenizer=this.options.tokenizer||new gi,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:yo,block:ri.normal,inline:li.normal};this.options.pedantic?(t.block=ri.pedantic,t.inline=li.pedantic):this.options.gfm&&(t.block=ri.gfm,this.options.breaks?t.inline=li.breaks:t.inline=li.gfm),this.tokenizer.rules=t}static get rules(){return{block:ri,inline:li}}static lex(t,n){return new e(n).lex(t)}static lexInline(t,n){return new e(n).inlineTokens(t)}lex(e){e=e.replace(yo.carriageReturn,"\n"),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){let t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){for(this.options.pedantic&&(e=e.replace(yo.tabCharGlobal,"    ").replace(yo.spaceLine,""));e;){let o;if(this.options.extensions?.block?.some(n=>!!(o=n.call({lexer:this},e,t))&&(e=e.substring(o.raw.length),t.push(o),!0)))continue;if(o=this.tokenizer.space(e)){e=e.substring(o.raw.length);let n=t.at(-1);1===o.raw.length&&void 0!==n?n.raw+="\n":t.push(o);continue}if(o=this.tokenizer.code(e)){e=e.substring(o.raw.length);let n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+="\n"+o.raw,n.text+="\n"+o.text,this.inlineQueue.at(-1).src=n.text):t.push(o);continue}if(o=this.tokenizer.fences(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.heading(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.hr(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.blockquote(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.list(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.html(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.def(e)){e=e.substring(o.raw.length);let n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+="\n"+o.raw,n.text+="\n"+o.raw,this.inlineQueue.at(-1).src=n.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.lheading(e)){e=e.substring(o.raw.length),t.push(o);continue}let i=e;if(this.options.extensions?.startBlock){let t,n=1/0,o=e.slice(1);this.options.extensions.startBlock.forEach(e=>{t=e.call({lexer:this},o),"number"==typeof t&&t>=0&&(n=Math.min(n,t))}),n<1/0&&n>=0&&(i=e.substring(0,n+1))}if(this.state.top&&(o=this.tokenizer.paragraph(i))){let s=t.at(-1);n&&"paragraph"===s?.type?(s.raw+="\n"+o.raw,s.text+="\n"+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=s.text):t.push(o),n=i.length!==e.length,e=e.substring(o.raw.length);continue}if(o=this.tokenizer.text(e)){e=e.substring(o.raw.length);let n=t.at(-1);"text"===n?.type?(n.raw+="\n"+o.raw,n.text+="\n"+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=n.text):t.push(o);continue}if(e){let t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n=e,o=null;if(this.tokens.links){let e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(o=this.tokenizer.rules.inline.reflinkSearch.exec(n));)e.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(o=this.tokenizer.rules.inline.anyPunctuation.exec(n));)n=n.slice(0,o.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;null!=(o=this.tokenizer.rules.inline.blockSkip.exec(n));)n=n.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let i=!1,s="";for(;e;){let o;if(i||(s=""),i=!1,this.options.extensions?.inline?.some(n=>!!(o=n.call({lexer:this},e,t))&&(e=e.substring(o.raw.length),t.push(o),!0)))continue;if(o=this.tokenizer.escape(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.tag(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.link(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(o.raw.length);let n=t.at(-1);"text"===o.type&&"text"===n?.type?(n.raw+=o.raw,n.text+=o.text):t.push(o);continue}if(o=this.tokenizer.emStrong(e,n,s)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.codespan(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.br(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.del(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.autolink(e)){e=e.substring(o.raw.length),t.push(o);continue}if(!this.state.inLink&&(o=this.tokenizer.url(e))){e=e.substring(o.raw.length),t.push(o);continue}let r=e;if(this.options.extensions?.startInline){let t,n=1/0,o=e.slice(1);this.options.extensions.startInline.forEach(e=>{t=e.call({lexer:this},o),"number"==typeof t&&t>=0&&(n=Math.min(n,t))}),n<1/0&&n>=0&&(r=e.substring(0,n+1))}if(o=this.tokenizer.inlineText(r)){e=e.substring(o.raw.length),"_"!==o.raw.slice(-1)&&(s=o.raw.slice(-1)),i=!0;let n=t.at(-1);"text"===n?.type?(n.raw+=o.raw,n.text+=o.text):t.push(o);continue}if(e){let t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return t}},yi=class{options;parser;constructor(e){this.options=e||fo}space(e){return""}code({text:e,lang:t,escaped:n}){let o=(t||"").match(yo.notSpaceStart)?.[0],i=e.replace(yo.endingNewline,"")+"\n";return o?'<pre><code class="language-'+ci(o)+'">'+(n?i:ci(i,!0))+"</code></pre>\n":"<pre><code>"+(n?i:ci(i,!0))+"</code></pre>\n"}blockquote({tokens:e}){return`<blockquote>\n${this.parser.parse(e)}</blockquote>\n`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return"<hr>\n"}list(e){let t=e.ordered,n=e.start,o="";for(let t=0;t<e.items.length;t++){let n=e.items[t];o+=this.listitem(n)}let i=t?"ol":"ul";return"<"+i+(t&&1!==n?' start="'+n+'"':"")+">\n"+o+"</"+i+">\n"}listitem(e){let t="";if(e.task){let n=this.checkbox({checked:!!e.checked});e.loose?"paragraph"===e.tokens[0]?.type?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&"text"===e.tokens[0].tokens[0].type&&(e.tokens[0].tokens[0].text=n+" "+ci(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>\n`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t="",n="";for(let t=0;t<e.header.length;t++)n+=this.tablecell(e.header[t]);t+=this.tablerow({text:n});let o="";for(let t=0;t<e.rows.length;t++){let i=e.rows[t];n="";for(let e=0;e<i.length;e++)n+=this.tablecell(i[e]);o+=this.tablerow({text:n})}return o&&(o=`<tbody>${o}</tbody>`),"<table>\n<thead>\n"+t+"</thead>\n"+o+"</table>\n"}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${ci(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let o=this.parser.parseInline(n),i=pi(e);if(null===i)return o;let s='<a href="'+(e=i)+'"';return t&&(s+=' title="'+ci(t)+'"'),s+=">"+o+"</a>",s}image({href:e,title:t,text:n,tokens:o}){o&&(n=this.parser.parseInline(o,this.parser.textRenderer));let i=pi(e);if(null===i)return ci(n);let s=`<img src="${e=i}" alt="${n}"`;return t&&(s+=` title="${ci(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:ci(e.text)}},vi=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},Ci=class e{options;renderer;textRenderer;constructor(e){this.options=e||fo,this.options.renderer=this.options.renderer||new yi,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new vi}static parse(t,n){return new e(n).parse(t)}static parseInline(t,n){return new e(n).parseInline(t)}parse(e,t=!0){let n="";for(let o=0;o<e.length;o++){let i=e[o];if(this.options.extensions?.renderers?.[i.type]){let e=i,t=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==t||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(e.type)){n+=t||"";continue}}let s=i;switch(s.type){case"space":n+=this.renderer.space(s);continue;case"hr":n+=this.renderer.hr(s);continue;case"heading":n+=this.renderer.heading(s);continue;case"code":n+=this.renderer.code(s);continue;case"table":n+=this.renderer.table(s);continue;case"blockquote":n+=this.renderer.blockquote(s);continue;case"list":n+=this.renderer.list(s);continue;case"html":n+=this.renderer.html(s);continue;case"paragraph":n+=this.renderer.paragraph(s);continue;case"text":{let i=s,r=this.renderer.text(i);for(;o+1<e.length&&"text"===e[o+1].type;)i=e[++o],r+="\n"+this.renderer.text(i);n+=t?this.renderer.paragraph({type:"paragraph",raw:r,text:r,tokens:[{type:"text",raw:r,text:r,escaped:!0}]}):r;continue}default:{let e='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}parseInline(e,t=this.renderer){let n="";for(let o=0;o<e.length;o++){let i=e[o];if(this.options.extensions?.renderers?.[i.type]){let e=this.options.extensions.renderers[i.type].call({parser:this},i);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){n+=e||"";continue}}let s=i;switch(s.type){case"escape":case"text":n+=t.text(s);break;case"html":n+=t.html(s);break;case"link":n+=t.link(s);break;case"image":n+=t.image(s);break;case"strong":n+=t.strong(s);break;case"em":n+=t.em(s);break;case"codespan":n+=t.codespan(s);break;case"br":n+=t.br(s);break;case"del":n+=t.del(s);break;default:{let e='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}},Ti=class{options;block;constructor(e){this.options=e||fo}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?mi.lex:mi.lexInline}provideParser(){return this.block?Ci.parse:Ci.parseInline}},Ei=new class{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Ci;Renderer=yi;TextRenderer=vi;Lexer=mi;Tokenizer=gi;Hooks=Ti;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(let o of e)switch(n=n.concat(t.call(this,o)),o.type){case"table":{let e=o;for(let o of e.header)n=n.concat(this.walkTokens(o.tokens,t));for(let o of e.rows)for(let e of o)n=n.concat(this.walkTokens(e.tokens,t));break}case"list":{let e=o;n=n.concat(this.walkTokens(e.items,t));break}default:{let e=o;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach(o=>{let i=e[o].flat(1/0);n=n.concat(this.walkTokens(i,t))}):e.tokens&&(n=n.concat(this.walkTokens(e.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(e=>{let n={...e};if(n.async=this.defaults.async||n.async||!1,e.extensions&&(e.extensions.forEach(e=>{if(!e.name)throw new Error("extension name required");if("renderer"in e){let n=t.renderers[e.name];t.renderers[e.name]=n?function(...t){let o=e.renderer.apply(this,t);return!1===o&&(o=n.apply(this,t)),o}:e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");let n=t[e.level];n?n.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)}),n.extensions=t),e.renderer){let t=this.defaults.renderer||new yi(this.defaults);for(let n in e.renderer){if(!(n in t))throw new Error(`renderer '${n}' does not exist`);if(["options","parser"].includes(n))continue;let o=n,i=e.renderer[o],s=t[o];t[o]=(...e)=>{let n=i.apply(t,e);return!1===n&&(n=s.apply(t,e)),n||""}}n.renderer=t}if(e.tokenizer){let t=this.defaults.tokenizer||new gi(this.defaults);for(let n in e.tokenizer){if(!(n in t))throw new Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;let o=n,i=e.tokenizer[o],s=t[o];t[o]=(...e)=>{let n=i.apply(t,e);return!1===n&&(n=s.apply(t,e)),n}}n.tokenizer=t}if(e.hooks){let t=this.defaults.hooks||new Ti;for(let n in e.hooks){if(!(n in t))throw new Error(`hook '${n}' does not exist`);if(["options","block"].includes(n))continue;let o=n,i=e.hooks[o],s=t[o];Ti.passThroughHooks.has(n)?t[o]=e=>{if(this.defaults.async)return Promise.resolve(i.call(t,e)).then(e=>s.call(t,e));let n=i.call(t,e);return s.call(t,n)}:t[o]=(...e)=>{let n=i.apply(t,e);return!1===n&&(n=s.apply(t,e)),n}}n.hooks=t}if(e.walkTokens){let t=this.defaults.walkTokens,o=e.walkTokens;n.walkTokens=function(e){let n=[];return n.push(o.call(this,e)),t&&(n=n.concat(t.call(this,e))),n}}this.defaults={...this.defaults,...n}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return mi.lex(e,t??this.defaults)}parser(e,t){return Ci.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{let o={...n},i={...this.defaults,...o},s=this.onError(!!i.silent,!!i.async);if(!0===this.defaults.async&&!1===o.async)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||null===t)return s(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);let r=i.hooks?i.hooks.provideLexer():e?mi.lex:mi.lexInline,l=i.hooks?i.hooks.provideParser():e?Ci.parse:Ci.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(t):t).then(e=>r(e,i)).then(e=>i.hooks?i.hooks.processAllTokens(e):e).then(e=>i.walkTokens?Promise.all(this.walkTokens(e,i.walkTokens)).then(()=>e):e).then(e=>l(e,i)).then(e=>i.hooks?i.hooks.postprocess(e):e).catch(s);try{i.hooks&&(t=i.hooks.preprocess(t));let e=r(t,i);i.hooks&&(e=i.hooks.processAllTokens(e)),i.walkTokens&&this.walkTokens(e,i.walkTokens);let n=l(e,i);return i.hooks&&(n=i.hooks.postprocess(n)),n}catch(e){return s(e)}}}onError(e,t){return n=>{if(n.message+="\nPlease report this to https://github.com/markedjs/marked.",e){let e="<p>An error occurred:</p><pre>"+ci(n.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(n);throw n}}};function Ai(e,t){return Ei.parse(e,t)}Ai.options=Ai.setOptions=function(e){return Ei.setOptions(e),Ai.defaults=Ei.defaults,ho(Ai.defaults),Ai},Ai.getDefaults=function(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}},Ai.defaults=fo,Ai.use=function(...e){return Ei.use(...e),Ai.defaults=Ei.defaults,ho(Ai.defaults),Ai},Ai.walkTokens=function(e,t){return Ei.walkTokens(e,t)},Ai.parseInline=Ei.parseInline,Ai.Parser=Ci,Ai.parser=Ci.parse,Ai.Renderer=yi,Ai.TextRenderer=vi,Ai.Lexer=mi,Ai.lexer=mi.lex,Ai.Tokenizer=gi,Ai.Hooks=Ti,Ai.parse=Ai,Ai.options,Ai.setOptions,Ai.use,Ai.walkTokens,Ai.parseInline;var _i=Ai;function bi(){return(0,s.jsx)("div",{className:"askaiwp-bubble-message",children:(0,t.__)("Need help? Ask me anything!","askaiwp")})}function Si(){const[e,i]=(0,o.useState)(!1),[u,c]=(0,o.useState)(""),[p,d]=(0,o.useState)([]),[f,h]=(0,o.useState)(!1),[g,m]=(0,o.useState)(""),[y,v]=(0,o.useState)(!0),C=(0,t.__)("How can I help you today?","askaiwp"),T=AskaiWP.settings.ai_name||(0,t.__)("AI","askaiwp"),E=AskaiWP.settings.gemini_model.replace("models/","")||"gemini-1.5-flash",A=(0,o.useRef)(null),_=(0,o.useRef)(null),b=new co({apiKey:AskaiWP.settings.gemini_api_key||""}),S=AskaiWP.settings.gemini_prompt||"You are an AI assistant helping users understand the content of a webpage.\n\nInstructions:\n1. Answer the user's question based on the page content above\n2. If the question is directly related to the page content, provide a detailed and helpful response\n3. If the question is only partially related, acknowledge what you can answer from the page and suggest what might need additional context\n4. If the question is completely unrelated to the page content, politely redirect them to ask questions about the current page\n5. Use a friendly, conversational tone\n6. If referencing specific parts of the page, mention them clearly\n7. Anser from the above content only user ask question\n8. If user greets, don't provide answer from the content, just greet them back\n\nPlease provide a clear, concise, and helpful response.";(0,o.useEffect)(()=>{const e=e=>{"Escape"===e.key&&i(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,o.useEffect)(()=>{if(e){let e=0;m("");const t=setInterval(()=>{m(C.slice(0,e+1)),e++,e===C.length&&clearInterval(t)},50);return()=>clearInterval(t)}},[e,C]);const I=async()=>{if(!u.trim())return;const e={sender:"user",text:u},n=document.querySelector("article.entry, .wp-block-post-title").textContent||"",o=document.querySelector("h1.entry-title, .wp-block-post-title").textContent||"",i=n;d(t=>[...t,e]),c(""),h(!0);const s=S+` Following is the page information:\nPage Title: ${o}\n\nPage Content:\n${i}\n\nUser Question: ${u}`;try{const e=(await b.models.generateContent({model:E,contents:s})).text||"Sorry, I could not generate a response.";d(t=>[...t,{sender:"ai",text:_i(e)}])}catch(e){let n=(0,t.__)("AI is not available at the moment. Please try again later!","askaiwp");429===e?.code&&(n=(0,t.__)("You are sending too many requests. Please wait a moment and try again.","askaiwp")),d(e=>[...e,{sender:"ai",text:n}])}h(!1)};return(0,o.useEffect)(()=>{A.current&&A.current.scrollIntoView({behavior:"smooth"})},[p,f]),(0,o.useEffect)(()=>{const t=e=>{_.current&&!_.current.contains(e.target)&&i(!1)};return e?document.addEventListener("mousedown",t):document.removeEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[e]),(0,o.useEffect)(()=>{const e=setTimeout(()=>{v(!1)},5e3);return()=>clearTimeout(e)},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{ref:_,className:"askaiwp-chat-box "+(e?"open":""),children:[(0,s.jsxs)("div",{className:"askaiwp-header",children:[T,(0,s.jsx)(n.Button,{onClick:()=>i(!1),variant:"tertiary",icon:r,className:"askaiwp-close-btn"})]}),(0,s.jsxs)("div",{className:"askaiwp-body",children:[0===p.length&&(0,s.jsx)("div",{className:"askaiwp-greeting",children:g}),(0,s.jsxs)("div",{className:"askaiwp-messages",children:[p.map((e,t)=>(0,s.jsx)("div",{className:"askaiwp-message askaiwp-message-"+("user"===e.sender?"user":"ai"),children:(0,s.jsxs)("div",{className:"askaiwp-bubble",children:[(0,s.jsxs)("strong",{children:["user"===e.sender?"You":T,":"," "]}),(0,s.jsx)("div",{className:"askaiwp-text",dangerouslySetInnerHTML:{__html:e.text}})]})},t)),(0,s.jsx)("div",{ref:A})]}),f&&(0,s.jsx)(po,{}),(0,s.jsxs)("div",{className:"askaiwp-ask-que-wrapper",children:[(0,s.jsx)(n.TextareaControl,{__nextHasNoMarginBottom:!0,value:u,onChange:e=>c(e),placeholder:(0,t.__)("Type your question here","askaiwp"),help:(0,t.__)("Press ENTER to Send","askaiwp"),className:"askaiwp-input",onKeyDown:async e=>{"Enter"===e.key&&(e.preventDefault(),I())}}),(0,s.jsx)(n.Button,{onClick:I,variant:"tertiary",className:"askaiwp-send-btn",label:(0,t.__)("Send","askaiwp"),icon:l})]})]})]}),!e&&(0,s.jsxs)(n.Button,{className:"askaiwp-floating-icon",onClick:()=>i(!0),children:[y&&(0,s.jsx)(bi,{}),(0,s.jsx)(n.Icon,{icon:({size:e})=>(0,s.jsx)("img",{width:e,height:e,src:a,alt:"AskaiWP"})})]})]})}Ci.parse,mi.lex;const Ii=(0,o.createRoot)(document.getElementById("askaiwp-root"));window.addEventListener("load",function(){Ii.render((0,s.jsx)(Si,{}))},!1)})();